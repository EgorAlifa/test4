/**
 * @param {import('webpack-chain')} config
 */
module.exports = function enableShadowMode(config) {
    // css related rules
    const rules = ['css', 'postcss', 'less'];
    const types = ['vue', 'vue-modules']; //, 'normal-modules', 'normal'
    rules.forEach(rule =>
        types.forEach(type => {
            config.module
                .rule(rule)
                .oneOf(type)
                .use('vue-style-loader')
                .tap(options => {
                    options.shadowMode = true;
                    return options;
                });
        })
    );
    // vue loader rule
    config.module
        .rule('vue')
        .use('vue-loader')
        .loader('vue-loader')
        .tap(options => {
            options.shadowMode = true;
            return options;
        });
};
