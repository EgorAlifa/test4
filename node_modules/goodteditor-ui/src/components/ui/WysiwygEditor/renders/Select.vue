<template>
    <div :title="title" class="select-tool">
        <ui-select
            v-bind="{
                value,
                options,
                valueObjects,
                disabled: !isEnabled,
                size: 'small',
                appendToBody: false
            }"
            class="w-100"
            @change="onChange" />
    </div>
</template>

<script>
import UiSelect from '../../Select.vue';
import { useRender, RenderMixinTypes } from './mixins';

export default {
    components: { UiSelect },
    mixins: [useRender()],
    computed: {
        value() {
            return this.tool.getValue(this.options);
        },
        options() {
            const { options = [] } = this.tool;

            return options.map((option) => typeof option === 'string'
                ? { value: option, label: option }
                : { value: option, label: option.title }
            );
        },
        valueObjects() {
            const [option] = this.options;
            return typeof option.value === 'object';
        }
    },
    methods: {
        ...RenderMixinTypes,
        onChange(option) {
            this.tool.exec(this.valueObjects ? option.value : option);
            this.emitExecuted();
        }
    }
};
</script>

<style scoped>
.select-tool {
    width: 7.5rem;
}
</style>
