<template>
    <div :data-popover="popoverTargetId" :title="title">
        <button
            :class="{ 'btn-outline': !popoverShow }"
            class="btn btn-small btn-icon btn-primary"
            @click="togglePopover">
            <div class="icon">
                <i class="mdi" :class="icon"></i>
            </div>
        </button>
        <popover :show.sync="popoverShow" v-bind="popoverOptions" position="bottom-end">
            <ui-datalist
                class="w-100 pull-left"
                v-bind="{ size: 'small', options: tool.options }"
                @click.native.stop>
                <template #option="{ option, index }">
                    <li :key="index" class="list-item" >
                        <component :is="option.render" :tool="option" @command-executed="onCommandExecuted" />
                    </li>
                </template>
            </ui-datalist>
        </popover>
    </div>
</template>

<script>
import Popover from '../../Popover.vue';
import UiDatalist from '../../Datalist.vue';
import WithPopover from '../../utils/WithPopover';
import { useRender, RenderMixinTypes } from './mixins';

export default {
    components: { Popover, UiDatalist },
    mixins: [useRender(), WithPopover],
    props: {
        appendToBody: {
            type: Boolean,
            default: false
        }
    },
    methods: {
        ...RenderMixinTypes,
        onCommandExecuted() {
            this.popoverShow = false;
            this.emitExecuted();
        }
    }
};
</script>

<style>
.list-item {
    display: inline-block !important;
    padding: 0.25rem !important;
    min-height: calc(var(--line-height)*1rem);
}
</style>
