<template>
    <div class="ui-file-selector">
        <!--
        @slot default slot
        @binding {File[]} files  selected files 
        -->
        <slot v-bind="{ files }">select files</slot>
        <input
            class="ui-file-selector-input pos-abs pos-top-left w-100 h-100"
            type="file"
            v-bind="{ accept, multiple }"
            @change="onFilesChanged"
        />
    </div>
</template>
<style lang="less" scoped>
.ui-file-selector {
    position: relative;
    display: inline-flex;
    align-items: center;
    &-input {
        cursor: pointer;
        overflow: hidden;
        opacity: 0;
        &::file-selector-button {
            width: 100%;
            height: 100%;
            visibility: hidden;
        }
        &::file-selector-label {
            display: none;
        }
    }
}
</style>
<script>
export default {
    props: {
        /**
         * html5 accept attr (a comma-separated list of one or more file types, or unique file type specifiers, describing which file types to allow.)
         */
        accept: {
            type: String,
            default: '',
        },
        /**
         * html5 miltiple attr (single/multiple file selection)
         */
        multiple: {
            type: Boolean,
            default: false,
        },
    },
    data() {
        return {
            files: [],
        };
    },
    methods: {
        /**
         * @public
         * Resets selected files (emits 'change' event)
         */
        reset() {
            this.files = [];
            this.emitChange();
        },
        emitChange() {
            /**
             * Files change event (dispatched whenever files change)
             * @property {File[]} files
             */
            this.$emit('change', this.files);
        },
        onFilesChanged(e) {
            const files = [...e.target.files];
            this.files = files;
            this.emitChange();
        },
    },
};
</script>
