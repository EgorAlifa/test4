<template>
    <div class="ui-collapse">
        <!-- 
        @slot Heading slot contains <mark>header</mark>, <mark>icon-open</mark>, <mark>icon-close</mark> slots
        @binding {boolean} isOpen   open flag
        @binding {function} toggle  function which toggles the visibility of the content 
        -->
        <slot name="heading" v-bind="{ isOpen: show, toggle }">
            <div class="row row-collapse u-select-none">
                <div class="col col-vmid">
                    <!-- 
                    @slot Header content
                    @binding {function} toggle  function which toggles the visibility of the content 
                    -->
                    <slot name="header" :toggle="toggle">
                        <span class="cursor-pointer u-select-none text-bold" @click="toggle">
                            Header
                        </span>
                    </slot>
                </div>
                <div class="col col-auto col-vmid" v-if="icon">
                    <div class="cursor-pointer" @click="toggle">
                        <!-- 
                        @slot Custom slot for the 'open' state
                        -->
                        <slot name="icon-open" v-if="show">
                            <div class="icon">
                                <i class="color-primary mdil mdil-24px mdil-minus"></i>
                            </div>
                        </slot>
                        <!-- 
                        @slot Custom slot for the 'close' state
                        -->
                        <slot name="icon-close" v-else>
                            <div class="icon">
                                <i class="color-primary mdil mdil-24px mdil-plus"></i>
                            </div>
                        </slot>
                    </div>
                </div>
            </div>
        </slot>
        <!-- 
        @slot Content 
        -->
        <slot v-if="show">Content</slot>
    </div>
</template>
<script>
export default {
    props: {
        /**
         * Whether the content is visible
         */
        visible: {
            type: Boolean,
            default: false,
        },
        /**
         * Whether the icons are visible
         */
        icon: {
            type: Boolean,
            default: true,
        },
    },
    data() {
        return {
            show: false,
        };
    },
    watch: {
        visible: {
            handler(val) {
                this.show = val;
            },
            immediate: true,
        },
    },
    methods: {
        toggle() {
            this.show = !this.show;
        },
    },
};
</script>
