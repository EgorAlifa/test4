<template>
    <div class="filter-item">
        <div class="filter-item__def text-small cursor-move">
            <ui-entity-badge-error v-if="error" v-bind="{ message: error.message }">
                {{ sort.name }}
            </ui-entity-badge-error>
            <ui-entity-badge v-else :type="type" :multiline="false" :title="sort.name">
                <span>{{ sort.name }}</span>
            </ui-entity-badge>
            <div v-else class="badge bg-red color-white text-xsmall text-truncate">{{ sort.name }}</div>
            <div class="badge bg-disabled text-small text-truncate" :title="sort.direction">
                {{ sort.direction }}
            </div>
        </div>
        <slot name="actions"></slot>
        <div class="icon cursor-pointer" @click="onEdit">
            <i class="mdi mdi-pencil mdi-18px" />
        </div>
        <div class="icon cursor-pointer" @click="onDelete">
            <i class="mdi mdi-delete mdi-18px" />
        </div>
    </div>
</template>
<script>
import UiEntityBadge from '../../shared/EntityBadge.vue';
import UiEntityBadgeError from '../../shared/EntityBadgeError.vue';
import { EntityType } from "../../../const";

/**
 * @typedef {import('@goodt-common/data').IDatasetQuerySort} IDatasetQuerySort
 * @typedef {object} IOption
 * @property {string} label
 * @property {string} value
 */
export default {
    components: {
        UiEntityBadge,
        UiEntityBadgeError
    },
    inject: ['$getQueryEntityType', '$getQueryEntityError'],
    props: {
        sort: {
            /** @type {import('vue').PropType<IDatasetQuerySort>} */
            type: Object,
            default: null
        }
    },
    computed: {
        type() {
            return this.$getQueryEntityType(this.sort.name);
        },
        error() {
            return this.$getQueryEntityError([EntityType.SORT], this.sort.name);
        }
    },
    methods: {
        onEdit() {
            this.$emit('edit');
        },
        onDelete() {
            this.$emit('delete');
        }
    }
};
</script>
<style lang="pcss" scoped>
.filter-item {
    display: grid;
    grid-template-columns: 1fr auto auto;
    align-items: start;

    &__def {
        display: flex;
        flex-wrap: wrap;
        align-items: center;
        gap: 0.25rem;
    }
}
</style>
