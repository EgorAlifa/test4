<template>
    <div class="dataset tile" :class="{ selected: isSelected }">
        <div>
            <i class="mdi mdi-table-large mdi-18px color-green mar-right-3 v-mid"></i>
            {{ dataset.name }}
        </div>
        <div>
            <div>
                <ui-entity v-for="{ id, name, templateId } in metrics" :key="id" class="mar-right-3" type="metric">
                    <i v-if="templateId != null" class="mdi mdi-library-shelves mar-right-2 color-grey"></i>
                    <span>{{ name }}</span>
                </ui-entity>
            </div>
            <div>
                <ui-entity v-for="{ id, name, templateId } in dimensions" :key="id" class="mar-right-3" type="dimension">
                    <i v-if="templateId != null" class="mdi mdi-library-shelves mar-right-2 color-grey"></i>
                    <span>{{ name }}</span>
                </ui-entity>
            </div>
        </div>
        <div>
            <div class="text-truncate" :title="dataset.authorKeycloakPreferredUsername">
                <template v-if="dataset.authorKeycloakPreferredUsername">
                    {{ dataset.authorKeycloakPreferredUsername }}
                </template>
                <template v-else>unnamed</template>
            </div>
            <div class="text-muted text-small">{{ formatDate(dataset.dateFrom) }}</div>
        </div>
    </div>
</template>
<script>
import { dayjs } from '@goodt-common/utils';
import UiEntity from '../../shared/EntityBadge.vue';

export default {
    components: { UiEntity },
    props: {
        selectedId: {
            type: [Number, String],
            default: ''
        },
        /** @type {import('vue').PropOptions<import('../../../../types').IDataset>} */
        dataset: {
            type: Object,
            default: null
        },
        /** @type {import('vue').PropOptions<import('../../../../types').IDatasetEntity[]>} */
        metrics: {
            type: Array,
            default: () => []
        },
        /** @type {import('vue').PropOptions<import('../../../../types').IDatasetEntity[]>} */
        dimensions: {
            type: Array,
            default: () => []
        }
    },
    computed: {
        isSelected() {
            return this.dataset.id === this.selectedId;
        }
    },
    methods: {
        formatDate(dateStr) {
            return dayjs(dateStr).format('DD.MM.YYYY, HH:mm');
        }
    }
};
</script>
<style lang="less" scoped>
.dataset {
    display: grid;
    grid-template-columns: 1fr 1fr 12rem;
    gap: 1rem;
    padding: 1rem;
    transition: outline 0.1s ease;
    cursor: pointer;
    outline: 0.1rem solid transparent;
    &:hover,
    &.selected {
        outline-color: var(--color-primary-focus);
    }
}
</style>
