// eslint-disable-next-line no-shadow
import { IDatasetQueryFilter, IDatasetQuerySort, IDatasetQueryVariable, IDatasetQueryMetricCustom } from './utils';
import { IDatasetQueryDrilldown } from './models';

export { IDatasetQueryFilter, IDatasetQuerySort };
export { IProjectDataProvider, IProjectDataProviderConnector } from '@goodt-common/dremio';

export interface IDatasetQuery {
    $from: string;
    $fields: string[];
    $metrics: string[];
    $dimensions: string[];
    $filters: IDatasetQueryFilter[];
    $variables: IDatasetQueryVariable[];
    $metricsCustom: IDatasetQueryMetricCustom[];
    $order?: string[];
    $sort: IDatasetQuerySort[];
    $drilldowns?: IDatasetQueryDrilldown[];
}

export interface IDatasetRequest {
    query: IDatasetQuery;
    url: string;
    limit?: number;
}

export interface IDatasetRequestProps {
    name: string;
    query: IDatasetQuery;
    dataProviderId: string;
    limit?: number;
}

export interface IAdapter {
    id: number | string;
    name: string;
    code: string;
    description: string;
}

export interface IAdapterManager {
    id: number | string;
    name: string;
    code: string;
    description: string;
    configuration: string;
}

export interface IConnection {
    id: number | string;
    byDefault: boolean;
    name: string;
    code: string;
    description: string;
    server: string;
    username: string;
    password: string;
    database: string;
    schema: string;
    connectionApi: string;
    userUid: string;
    config: string;
    adapterId: number | string;
    adapterManagerId: number | string;
    isLegacy: boolean;
}

export interface IDatasetMeta {
    dataset: IDataset;
    metrics: IDatasetEntity[];
    dimensions: IDatasetEntity[];
    variables: IDatasetVariable[];
}

export interface IDataset {
    id: number;
    code: string;
    name: string;
    description: string;
    folderId: string | number;
    typeId: string | number;
    definition: string;
    schema: IDatasetSchema;
    dateFrom: string;
    updateDate: string;
    authorKeycloakUuid: string;
    authorKeycloakPreferredUsername: string;
    updateKeycloakUuid: string;
    updateKeycloakPreferredUsername: string;
}

export interface IDatasetFieldSchema {
    name: string;
    type: string;
}

export interface IDatasetOrder {
    name: string;
    direction: string;
}

export interface IDatasetEntity {
    id: string | number;
    code: string;
    name: string;
    description: string;
    typeId: string | number;
    templateId: string | number;
    datasetId: IDataset['id'];
    definition: string;
    dateFrom?: string;
    ownerKeycloakUuid?: string;
    updateDate?: string;
    updateKeycloakUuid: string;
    authorKeycloakPreferredUsername?: string;
    updateKeycloakPreferredUsername?: string;
}

export interface IDatasetVariable {
    id: number;
    code: string;
    datasetId: IDataset['id'];
    name: string;
    description: string;
    defaultValue: string;
    typeId: number;
    isNullable: boolean;
    dateFrom?: string;
    authorKeycloakUuid?: string;
    authorKeycloakPreferredUsername?: string;
    updateDate?: string;
    updateKeycloakUuid?: string;
    updateKeycloakPreferredUsername?: string;
}

export interface IDatasetEntityTemplate {
    id: string | number;
    name: string;
    code: string;
    description: string;
    formula: string;
    typeId: string | number;
    folderId: string | number;
    dateFrom: string;
    updateDate: string;
    authorKeycloakUuid: string;
    authorKeycloakPreferredUsername: string;
    updateKeycloakUuid: string;
    updateKeycloakPreferredUsername: string;
}

export interface IDatasetEntityTemplateProject {
    id: string | number;
    name: string;
}

export interface IDatasetEntityTemplateFolder {
    id: string | number;
    name: string;
    code: string;
    parentId: string | number;
    projectId: string | number;
    isRoot: boolean;
}

export interface IDatasetFolder {
    id: string | number;
    name: string;
    code: string;
    parentId: string | number;
}

export interface IDatasetResult {
    limit: number;
    offset: number;
    rowCount: number;
    rows: Record<string, any>[];
    schema?: IDatasetFieldSchema[];
    sql?: string;
}

export interface IDatasetResultExtended extends IDatasetResult {
    schema: IDatasetFieldSchema[];
}

export interface IExternalSourceTable {
    name: string;
}

export interface IExternalSourceSchema {
    name: string;
}

export interface IExternalSourceFieldSchema {
    name: string;
    type: string;
}

export interface IExternalSourceTableSchemaResult {
    tables: IExternalSourceTable[];
}

export interface IExternalSourceSchemaSchemaResult {
    schemas: IExternalSourceSchema[];
}

export interface IExternalSourceTableFieldSchemaResult {
    fields: IExternalSourceFieldSchema[];
}

export interface IDatasetMaterialization {
    id: string | number;
    code: string;
    name: string;
    schema: { fields: IDatasetMaterializationFieldSchema[] };
    datasetId: string | number;
    typeId: number;
    dateFrom: string;
    isEnabled: boolean;
    status: string;
}

export interface IDatasetMaterializationFieldSchema {
    name: string;
    type: string;
    partition: boolean;
}

export interface IDatasetMaterializationPlannerSchedule {
    id: string | number;
    code: string;
    typeId: number;
    isEnabled: boolean;
    cronString: string;
    dateFrom: string;
}

export interface IFolderChildCount {
    folderId: string | number;
    countChildObjects: number;
}

export interface IDeviations {
    refDatasetIndex: number;
    refDatasetKey: string;
    datasets: IDeviationDatasetProps[];
    rules: IDeviationRule[];
}

export interface IDeviationDatasetProps {
    index: number;
    key: string;
}

export interface IDeviationRule {
    name: string;
    formula: string;
}
