export const __webpack_id__=3489;export const __webpack_ids__=[3489];export const __webpack_modules__={61416:(t,e,i)=>{i.d(e,{NH:()=>l});var s=i(90277),o=i(42845),n=i(64504);class r{getTextContent(t){return(0,s.q4)(t,{textSerializers:(0,s.iR)(this.editor.schema)})}constructor({editor:t,element:e,view:i,tippyOptions:s={},shouldShow:o}){this.preventHide=!1,this.shouldShow=({view:t,state:e})=>{const{selection:i}=e,{$anchor:s,empty:o}=i,n=1===s.depth,r=s.parent.isTextblock&&!s.parent.type.spec.code&&!s.parent.textContent&&0===s.parent.childCount&&!this.getTextContent(s.parent);return!!(t.hasFocus()&&o&&n&&r&&this.editor.isEditable)},this.mousedownHandler=()=>{this.preventHide=!0},this.focusHandler=()=>{setTimeout(()=>this.update(this.editor.view))},this.blurHandler=({event:t})=>{var e;this.preventHide?this.preventHide=!1:(null===t||void 0===t?void 0:t.relatedTarget)&&(null===(e=this.element.parentNode)||void 0===e?void 0:e.contains(t.relatedTarget))||(null===t||void 0===t?void 0:t.relatedTarget)!==this.editor.view.dom&&this.hide()},this.tippyBlurHandler=t=>{this.blurHandler({event:t})},this.editor=t,this.element=e,this.view=i,o&&(this.shouldShow=o),this.element.addEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.editor.on("focus",this.focusHandler),this.editor.on("blur",this.blurHandler),this.tippyOptions=s,this.element.remove(),this.element.style.visibility="visible"}createTooltip(){const{element:t}=this.editor.options,e=!!t.parentElement;this.element.tabIndex=0,!this.tippy&&e&&(this.tippy=(0,n.Ay)(t,{duration:0,getReferenceClientRect:null,content:this.element,interactive:!0,trigger:"manual",placement:"right",hideOnClick:"toggle",...this.tippyOptions}),this.tippy.popper.firstChild&&this.tippy.popper.firstChild.addEventListener("blur",this.tippyBlurHandler))}update(t,e){var i,o,n;const{state:r}=t,{doc:l,selection:p}=r,{from:d,to:h}=p,a=e&&e.doc.eq(l)&&e.selection.eq(p);if(a)return;this.createTooltip();const u=null===(i=this.shouldShow)||void 0===i?void 0:i.call(this,{editor:this.editor,view:t,state:r,oldState:e});u?(null===(o=this.tippy)||void 0===o||o.setProps({getReferenceClientRect:(null===(n=this.tippyOptions)||void 0===n?void 0:n.getReferenceClientRect)||(()=>(0,s.MG)(t,d,h))}),this.show()):this.hide()}show(){var t;null===(t=this.tippy)||void 0===t||t.show()}hide(){var t;null===(t=this.tippy)||void 0===t||t.hide()}destroy(){var t,e;(null===(t=this.tippy)||void 0===t?void 0:t.popper.firstChild)&&this.tippy.popper.firstChild.removeEventListener("blur",this.tippyBlurHandler),null===(e=this.tippy)||void 0===e||e.destroy(),this.element.removeEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.editor.off("focus",this.focusHandler),this.editor.off("blur",this.blurHandler)}}const l=t=>new o.k_({key:"string"===typeof t.pluginKey?new o.hs(t.pluginKey):t.pluginKey,view:e=>new r({view:e,...t})});s.YY.create({name:"floatingMenu",addOptions(){return{element:null,tippyOptions:{},pluginKey:"floatingMenu",shouldShow:null}},addProseMirrorPlugins(){return this.options.element?[l({pluginKey:this.options.pluginKey,editor:this.editor,element:this.options.element,tippyOptions:this.options.tippyOptions,shouldShow:this.options.shouldShow})]:[]}})}};