export const __webpack_id__=1838;export const __webpack_ids__=[1838];export const __webpack_modules__={32799:(t,e,i)=>{i.r(e),i.d(e,{default:()=>x});var s=function(){var t=this,e=t._self._c;return e("w-elem",{attrs:{placeholder:!t.shouldShowCustomEmptyState&&t.$placeholder}},[e("div",{ref:"tableContainer",staticClass:"table-container relative w-full h-full flex flex-col",class:[t.themeClass,t.radiusClass],style:t.containerStyleWithCustom,attrs:{"data-density":t.props.density}},[e("div",{staticClass:"table-top-bar",style:t.topBarStyleWithCustom},[t.showBreadcrumbs?e("div",{staticClass:"table-breadcrumb",style:t.breadcrumbStyleWithCustom},[t.hasMultipleActiveHierarchies?[e("div",{staticClass:"breadcrumb-multi-container"},t._l(t.activeDrilldownStates,function(i){return e("div",{key:i.name,staticClass:"breadcrumb-dimension-group"},[e("label",{staticClass:"breadcrumb-dimension-label"},[t._v(t._s(i.name)+":")]),e("select",{staticClass:"breadcrumb-dimension-select",domProps:{value:t.getCurrentLevelIndex(i)},on:{change:e=>t.handleDimensionLevelChange(i.name,e.target.value),mousedown:function(t){t.stopPropagation()},click:function(t){t.stopPropagation()}}},[e("option",{attrs:{value:"-1"}},[t._v(t._s(i.name)+" (Все)")]),t._l(i.filters,function(i,s){return e("option",{key:s,domProps:{value:s}},[t._v(" "+t._s(i.value)+" ")])})],2)])}),0)]:[e("span",{staticClass:"breadcrumb-item breadcrumb-clickable",on:{click:function(e){return t.drilldownPopToTopForDimension(t.singleActiveDimensionState.name)}}},[t._v(" "+t._s(t.singleActiveDimensionState.name)+" ")]),t._l(t.singleActiveDimensionState.filters,function(i,s){return e("span",{key:s,staticClass:"breadcrumb-segment"},[e("span",{staticClass:"breadcrumb-separator"},[t._v("›")]),e("span",{staticClass:"breadcrumb-item",class:{"breadcrumb-clickable":s<t.singleActiveDimensionState.filters.length-1},on:{click:function(e){s<t.singleActiveDimensionState.filters.length-1&&t.drilldownPopToLevelForDimension(t.singleActiveDimensionState.name,s)}}},[t._v(" "+t._s(i.value)+" ")])])})]],2):t._e(),e("div",{staticClass:"table-toolbar"},[e("button",{staticClass:"toolbar-btn toolbar-search-btn",attrs:{type:"button",title:t.isLocalShowColumnFilters?"Скрыть поиск":"Показать поиск"},on:{click:function(e){return e.stopPropagation(),t.toggleFilters.apply(null,arguments)}}},[e("svg",{attrs:{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[e("circle",{attrs:{cx:"7",cy:"7",r:"5",stroke:"currentColor","stroke-width":"1.5"}}),e("path",{attrs:{d:"M11 11l3.5 3.5",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round"}})])]),e("button",{staticClass:"toolbar-btn toolbar-filter-btn",class:{"has-active-filters":t.activeFilterCount>0},attrs:{type:"button",title:t.isLocalShowColumnFilters?"Скрыть фильтры":"Показать фильтры"},on:{click:function(e){return e.stopPropagation(),t.toggleFilters.apply(null,arguments)}}},[e("svg",{attrs:{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor"}},[e("path",{attrs:{d:"M2 3h12l-5 6v4l-2 1V9L2 3z",stroke:"currentColor","stroke-width":"1.5",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"}})]),t.activeFilterCount>0?e("span",{staticClass:"toolbar-badge"},[t._v(" "+t._s(t.activeFilterCount)+" ")]):t._e()]),e("button",{staticClass:"toolbar-btn toolbar-density-btn",attrs:{type:"button",title:"Плотность строк"},on:{click:function(e){return e.stopPropagation(),t.toggleDensityMenu.apply(null,arguments)}}},[e("span",{staticClass:"toolbar-density-icon"},[t._v(t._s(t.getDensityIcon(t.props.density)))])]),e("button",{staticClass:"toolbar-btn toolbar-theme-btn",attrs:{type:"button",title:t.getThemeTitle(t.props.theme)},on:{click:function(e){return e.stopPropagation(),t.toggleThemeMenu.apply(null,arguments)}}},[e("svg",{attrs:{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"}},["light"===t.props.theme?e("path",{attrs:{d:"M8 11a3 3 0 100-6 3 3 0 000 6zM8 1v2M8 13v2M13 8h2M1 8h2M11.5 11.5l1.4 1.4M3.1 3.1l1.4 1.4M11.5 4.5l1.4-1.4M3.1 12.9l1.4-1.4",stroke:"currentColor","stroke-width":"1.5",fill:"none","stroke-linecap":"round"}}):"dark"===t.props.theme?e("path",{attrs:{d:"M14 8.5c-1.3 2.2-3.7 3.7-6.5 3.7-4.1 0-7.5-3.4-7.5-7.5 0-1.5.5-2.9 1.2-4 .1-.1.3-.2.4-.1.2.1.3.2.3.4-.3 1.4-.2 2.9.5 4.3.8 1.5 2.2 2.6 3.8 3.1 1.6.5 3.3.4 4.8-.3.2-.1.4 0 .5.2.1.2 0 .4-.2.5-1.3.7-2.7 1-4.2 1z",fill:"currentColor"}}):e("path",{attrs:{d:"M8 12c2.2 0 4-1.8 4-4s-1.8-4-4-4V12z M8 1v2M8 13v2M13 8h2M1 8h2M11.5 11.5l1.4 1.4M3.1 3.1l1.4 1.4M11.5 4.5l1.4-1.4M3.1 12.9l1.4-1.4",stroke:"currentColor","stroke-width":"1.5",fill:"none","stroke-linecap":"round"}})])]),e("button",{staticClass:"toolbar-btn toolbar-excel-btn",attrs:{type:"button",title:"Экспортировать в Excel"},on:{click:function(e){return e.stopPropagation(),t.handleExportToExcel.apply(null,arguments)}}},[e("svg",{attrs:{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor"}},[e("path",{attrs:{d:"M2 2h8l4 4v8H2V2z",stroke:"currentColor","stroke-width":"1.5",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"}}),e("path",{attrs:{d:"M10 2v4h4M5 8h6M5 10h6M5 12h4",stroke:"currentColor","stroke-width":"1.5",fill:"none","stroke-linecap":"round"}})])]),e("button",{staticClass:"toolbar-btn toolbar-settings-btn",attrs:{type:"button",title:"Настройки таблицы"},on:{click:function(e){return e.stopPropagation(),t.toggleTableSettingsMenu.apply(null,arguments)}}},[e("svg",{attrs:{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor"}},[e("path",{attrs:{d:"M8 10.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z",fill:"currentColor"}}),e("path",{attrs:{d:"M6.5 1h3l.5 1.5c.5.2 1 .5 1.4.8l1.6-.5 1.5 2.6-1.2 1.1c.1.4.2.8.2 1.3s-.1.9-.2 1.3l1.2 1.1-1.5 2.6-1.6-.5c-.4.3-.9.6-1.4.8L9.5 15h-3l-.5-1.5c-.5-.2-1-.5-1.4-.8l-1.6.5-1.5-2.6 1.2-1.1c-.1-.4-.2-.8-.2-1.3s.1-.9.2-1.3L1.5 5.4 3 2.8l1.6.5c.4-.3.9-.6 1.4-.8L6.5 1z",stroke:"currentColor","stroke-width":"0.5",fill:"none","stroke-linejoin":"round"}})])]),e("button",{staticClass:"toolbar-btn toolbar-add-btn",attrs:{type:"button",title:"Добавить колонку"},on:{click:function(e){return e.stopPropagation(),t.toggleAddColumnMenu.apply(null,arguments)}}},[e("span",{staticClass:"toolbar-add-icon"},[t._v("+")])]),t.isDensityMenuVisible?e("div",{staticClass:"toolbar-dropdown-menu toolbar-density-menu",on:{click:function(t){t.stopPropagation()}}},t._l(t.densityOptions,function(i){return e("div",{key:i.value,staticClass:"toolbar-menu-item",class:{active:t.props.density===i.value},on:{click:function(e){return t.handleDensityChange(i.value)}}},[e("span",{staticClass:"density-indicator"},[t._v(t._s(t.getDensityIcon(i.value)))]),e("span",[t._v(t._s(i.label))]),t.props.density===i.value?e("svg",{staticClass:"check-icon",attrs:{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor"}},[e("path",{attrs:{d:"M13 4L6 11l-3-3",stroke:"currentColor","stroke-width":"2",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"}})]):t._e()])}),0):t._e(),t.isThemeMenuVisible?e("div",{staticClass:"toolbar-dropdown-menu toolbar-theme-menu",on:{click:function(t){t.stopPropagation()}}},t._l(t.themeOptions,function(i){return e("div",{key:i.value,staticClass:"toolbar-menu-item",class:{active:t.props.theme===i.value},on:{click:function(e){return t.handleThemeChange(i.value)}}},[e("span",{staticClass:"theme-indicator"},[e("svg",{attrs:{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"}},["light"===i.value?e("path",{attrs:{d:"M8 11a3 3 0 100-6 3 3 0 000 6zM8 1v2M8 13v2M13 8h2M1 8h2M11.5 11.5l1.4 1.4M3.1 3.1l1.4 1.4M11.5 4.5l1.4-1.4M3.1 12.9l1.4-1.4",stroke:"currentColor","stroke-width":"1.5",fill:"none","stroke-linecap":"round"}}):"dark"===i.value?e("path",{attrs:{d:"M14 8.5c-1.3 2.2-3.7 3.7-6.5 3.7-4.1 0-7.5-3.4-7.5-7.5 0-1.5.5-2.9 1.2-4 .1-.1.3-.2.4-.1.2.1.3.2.3.4-.3 1.4-.2 2.9.5 4.3.8 1.5 2.2 2.6 3.8 3.1 1.6.5 3.3.4 4.8-.3.2-.1.4 0 .5.2.1.2 0 .4-.2.5-1.3.7-2.7 1-4.2 1z",fill:"currentColor"}}):e("path",{attrs:{d:"M8 12c2.2 0 4-1.8 4-4s-1.8-4-4-4V12z M8 1v2M8 13v2M13 8h2M1 8h2M11.5 11.5l1.4 1.4M3.1 3.1l1.4 1.4M11.5 4.5l1.4-1.4M3.1 12.9l1.4-1.4",stroke:"currentColor","stroke-width":"1.5",fill:"none","stroke-linecap":"round"}})])]),e("span",[t._v(t._s(i.label))]),t.props.theme===i.value?e("svg",{staticClass:"check-icon",attrs:{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor"}},[e("path",{attrs:{d:"M13 4L6 11l-3-3",stroke:"currentColor","stroke-width":"2",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"}})]):t._e()])}),0):t._e(),t.isTableSettingsMenuVisible?e("div",{staticClass:"toolbar-dropdown-menu",on:{click:function(t){t.stopPropagation()}}},[e("div",{staticClass:"toolbar-menu-header"},[t._v("Отображение")]),e("div",{staticClass:"toolbar-menu-item",class:{active:t.props.showRowNumbers},on:{click:t.handleToggleRowNumbers}},[e("svg",{staticClass:"menu-icon",attrs:{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor"}},[e("path",{attrs:{d:"M4 4h8M4 8h8M4 12h8",stroke:"currentColor","stroke-width":"1.5",fill:"none","stroke-linecap":"round"}}),e("path",{attrs:{d:"M2 4h1M2 8h1M2 12h1",stroke:"currentColor","stroke-width":"2",fill:"none","stroke-linecap":"round"}})]),e("span",[t._v("Номера строк")]),t.props.showRowNumbers?e("svg",{staticClass:"check-icon",attrs:{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor"}},[e("path",{attrs:{d:"M13 4L6 11l-3-3",stroke:"currentColor","stroke-width":"2",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"}})]):t._e()]),e("div",{staticClass:"toolbar-menu-divider"}),e("div",{staticClass:"toolbar-menu-header"},[t._v("Типы колонок")]),e("div",{staticClass:"toolbar-menu-item",on:{click:t.runAutoDetectForAllColumns}},[e("svg",{staticClass:"menu-icon",attrs:{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor"}},[e("path",{attrs:{d:"M8 2a6 6 0 100 12A6 6 0 008 2zm0 10.8A4.8 4.8 0 1112.8 8 4.8 4.8 0 018 12.8z",fill:"currentColor"}}),e("path",{attrs:{d:"M10.5 5.5L8 8v4",stroke:"currentColor","stroke-width":"1.5",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"}})]),e("span",[t._v("Автоопределить типы")])]),e("div",{staticClass:"toolbar-menu-divider"}),e("div",{staticClass:"toolbar-menu-header"},[t._v("Ширина колонок")]),e("div",{staticClass:"toolbar-menu-item",class:{active:t.props.autoFitColumns},on:{click:t.handleAutoFitToggle}},[e("svg",{staticClass:"menu-icon",attrs:{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor"}},[e("path",{attrs:{d:"M2 3h12v10H2V3zm1 1v8h10V4H3z",fill:"currentColor"}}),e("path",{attrs:{d:"M5 6v4M8 6v4M11 6v4",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"}})]),e("span",[t._v("Автоподбор ширины")]),t.props.autoFitColumns?e("svg",{staticClass:"check-icon",attrs:{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor"}},[e("path",{attrs:{d:"M13 4L6 11l-3-3",stroke:"currentColor","stroke-width":"2",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"}})]):t._e()]),e("div",{staticClass:"toolbar-menu-item",on:{click:t.handleAutoFitNow}},[e("svg",{staticClass:"menu-icon",attrs:{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor"}},[e("path",{attrs:{d:"M8 2v12M3 7l5-5 5 5",stroke:"currentColor","stroke-width":"1.5",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"}})]),e("span",[t._v("Подогнать сейчас")])])]):t._e(),t.isAddColumnMenuVisible?e("div",{staticClass:"toolbar-dropdown-menu",on:{click:function(t){t.stopPropagation()}}},[t.hiddenColumnsToShow.length>0?e("div",{staticClass:"toolbar-menu-section"},[e("div",{staticClass:"toolbar-menu-header"},[t._v("Скрытые колонки")]),t._l(t.hiddenColumnsToShow,function(i){return e("div",{key:"hidden-"+i.id,staticClass:"toolbar-menu-item",on:{click:function(e){return t.handleHideColumn(i.id)}}},[e("svg",{staticClass:"menu-icon",attrs:{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor"}},[e("path",{attrs:{d:"M8 3C4.5 3 1.7 5.6 1 8c.7 2.4 3.5 5 7 5s6.3-2.6 7-5c-.7-2.4-3.5-5-7-5zm0 8c-1.7 0-3-1.3-3-3s1.3-3 3-3 3 1.3 3 3-1.3 3-3 3z",fill:"currentColor"}}),e("circle",{attrs:{cx:"8",cy:"8",r:"1.5",fill:"currentColor"}})]),e("span",[t._v(t._s(i.label))])])})],2):t._e(),t.hiddenColumnsToShow.length>0&&(t.availableDimensions.length>0||t.availableMetrics.length>0)?e("div",{staticClass:"toolbar-menu-divider"}):t._e(),t.availableDimensions.length>0?e("div",{staticClass:"toolbar-menu-section"},[e("div",{staticClass:"toolbar-menu-header"},[t._v("Измерения")]),t._l(t.availableDimensions,function(i){return e("div",{key:"dim-"+i,staticClass:"toolbar-menu-item",on:{click:function(e){return t.handleAddDimension(i)}}},[e("svg",{staticClass:"menu-icon",attrs:{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor"}},[e("path",{attrs:{d:"M2 4h12M2 8h12M2 12h12",stroke:"currentColor","stroke-width":"1.5",fill:"none","stroke-linecap":"round"}})]),e("span",[t._v(t._s(i))])])})],2):t._e(),t.availableDimensions.length>0&&t.availableMetrics.length>0?e("div",{staticClass:"toolbar-menu-divider"}):t._e(),t.availableMetrics.length>0?e("div",{staticClass:"toolbar-menu-section"},[e("div",{staticClass:"toolbar-menu-header"},[t._v("Показатели")]),t._l(t.availableMetrics,function(i){return e("div",{key:"metric-"+i,staticClass:"toolbar-menu-item",on:{click:function(e){return t.handleAddMetric(i)}}},[e("svg",{staticClass:"menu-icon",attrs:{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor"}},[e("path",{attrs:{d:"M3 13L8 3l5 10",stroke:"currentColor","stroke-width":"1.5",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"}})]),e("span",[t._v(t._s(i))])])})],2):t._e(),0===t.hiddenColumnsToShow.length&&0===t.availableDimensions.length&&0===t.availableMetrics.length?e("div",{staticClass:"toolbar-menu-empty"},[t._v(" Все колонки добавлены ")]):t._e()]):t._e()])]),e("div",{ref:"tableBody",staticClass:"table-scroll-wrapper flex-1 overflow-auto relative",style:t.scrollWrapperStyleWithCustom},[t.props.showHeader&&!t.shouldShowCustomEmptyState?e("w-table-header",{attrs:{columns:t.visibleColumns,"column-widths":t.columnWidths,"column-settings":t.props.columnSettings,"hierarchical-settings":t.props.hierarchicalSettings,"all-drilldown-dimensions":t.allDrilldownDimensions,"drilldown-state":t.$drilldown?t.$drilldown.state:{},"sort-column":t.sortColumn,"sort-direction":t.sortDirection,"enable-resize":t.props.enableColumnResize,"enable-move":t.props.enableColumnMove,"enable-sort":t.props.enableSorting,"header-style":t.headerStyle,"header-cell-style":t.headerCellStyle,"custom-styles":t.props.customStyles,"editing-column-id":t.inlineEditingColumn?t.inlineEditingColumn.id:null,"frozen-columns":t.frozenColumns,"frozen-column-positions":t.frozenColumnPositions},on:{resize:t.handleColumnResize,move:t.handleColumnMove,sort:t.handleSort,"inline-edit":t.handleInlineEdit,"hide-column":t.handleHideColumn,"update-custom-styles":t.handleUpdateCustomStyles,"update-column-setting":t.handleUpdateColumnSetting,"toggle-freeze":t.handleToggleFreezeColumn}}):t._e(),t.shouldShowFilterRow?e("w-table-filter-row",{key:"filter-row-"+t.columnSettingsVersion,attrs:{columns:t.visibleColumns,"column-widths":t.columnWidths,"filter-values":t.columnFilters,"table-data":t.tableData,"enable-column-filter-modes":t.props.enableColumnFilterModes,"enable-faceted-values":t.props.enableFacetedValues,"max-faceted-values":t.props.maxFacetedValues,"filter-variant-overrides":t.props.filterVariantOverrides,"debounce-ms":t.props.filterDebounceMs,"custom-styles":t.props.customStyles,"header-height-px":t.headerHeightInPx,"column-settings":t.props.columnSettings,"frozen-columns":t.frozenColumns,"frozen-column-positions":t.frozenColumnPositions,"enable-backend-filtering":t.props.enableBackendFiltering,"filter-application-mode":t.props.filterApplicationMode,"filter-min-chars":t.props.filterMinChars,"facets-data":t.facetsData,"is-facets-loading":t.isFacetsLoading,"is-filter-data-loading":t.isFilterDataLoading,"applied-filters":t.appliedColumnFilters,"pending-filters":t.pendingColumnFilters},on:{"filter-change":t.handleFilterChange,"filter-mode-change":t.handleFilterModeChange,"apply-filters":t.applyFilters,"clear-filters":t.clearAllFilters}}):t._e(),!t.isLoading&&t.tableData.length>0?e("div",{staticClass:"table-body",style:t.tableBodyStyleWithCustom},t._l(t.filteredTableData,function(i,s){return e("w-table-row",{key:s,attrs:{row:i,columns:t.visibleColumns,"column-widths":t.columnWidths,"column-settings":t.props.columnSettings,"hierarchical-settings":t.props.hierarchicalSettings,"row-index":s,"is-selected":t.selectedRows.includes(s),"is-alternate":t.props.striped&&s%2===1,"row-style":t.rowStyle,"cell-style":t.cellStyle,"alternate-row-style":t.alternateRowStyle,"selected-row-style":t.selectedRowStyle,"hover-row-style":t.hoverRowStyle,"custom-styles":t.props.customStyles,"number-format":t.props.numberFormat,separator:t.props.separator,prefix:t.props.prefix,postfix:t.props.postfix,"tag-separator":t.props.tagSeparator,"row-height-px":t.rowHeightPx,dimensions:t.props.dimensions,"main-dimension-name":t.mainDimensionName,"drilldown-can-push":t.drilldownCanPush,"all-drilldown-dimensions":t.allDrilldownDimensions,"drilldown-state":t.$drilldown&&t.$drilldown.state,"frozen-columns":t.frozenColumns,"frozen-column-positions":t.frozenColumnPositions},on:{click:t.handleRowClick,select:t.handleRowSelect,"cell-click":t.handleDimensionCellClick}})}),1):t._e()],1),t.isLoading?e("div",{staticClass:"flex items-center justify-center flex-1"},[e("div",{staticClass:"text-sm",class:t.scheme.textMuted},[t._v("Загрузка…")])]):t._e(),t.shouldShowCustomEmptyState?e("div",{staticClass:"empty-state-container"},[e("div",{staticClass:"empty-state-content"},[e("svg",{staticClass:"empty-state-icon",attrs:{width:"240",height:"240",viewBox:"0 0 240 240",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[e("circle",{attrs:{cx:"120",cy:"120",r:"100",fill:"currentColor",opacity:"0.04"}}),e("rect",{attrs:{x:"50",y:"60",width:"140",height:"120",rx:"6",stroke:"currentColor","stroke-width":"3",fill:"none",opacity:"0.3"}}),e("line",{attrs:{x1:"100",y1:"60",x2:"100",y2:"180",stroke:"currentColor","stroke-width":"2.5",opacity:"0.2"}}),e("line",{attrs:{x1:"145",y1:"60",x2:"145",y2:"180",stroke:"currentColor","stroke-width":"2.5",opacity:"0.2"}}),e("line",{attrs:{x1:"50",y1:"100",x2:"190",y2:"100",stroke:"currentColor","stroke-width":"2",opacity:"0.15"}}),e("line",{attrs:{x1:"50",y1:"130",x2:"190",y2:"130",stroke:"currentColor","stroke-width":"2",opacity:"0.15"}}),e("line",{attrs:{x1:"50",y1:"160",x2:"190",y2:"160",stroke:"currentColor","stroke-width":"2",opacity:"0.15"}}),e("g",{attrs:{opacity:"0.25"}},[e("line",{attrs:{x1:"62",y1:"80",x2:"85",y2:"80",stroke:"currentColor","stroke-width":"2.5","stroke-linecap":"round"}}),e("line",{attrs:{x1:"110",y1:"80",x2:"133",y2:"80",stroke:"currentColor","stroke-width":"2.5","stroke-linecap":"round"}}),e("line",{attrs:{x1:"157",y1:"80",x2:"178",y2:"80",stroke:"currentColor","stroke-width":"2.5","stroke-linecap":"round"}}),e("line",{attrs:{x1:"62",y1:"115",x2:"85",y2:"115",stroke:"currentColor","stroke-width":"2.5","stroke-linecap":"round"}}),e("line",{attrs:{x1:"110",y1:"115",x2:"133",y2:"115",stroke:"currentColor","stroke-width":"2.5","stroke-linecap":"round"}}),e("line",{attrs:{x1:"157",y1:"115",x2:"178",y2:"115",stroke:"currentColor","stroke-width":"2.5","stroke-linecap":"round"}}),e("line",{attrs:{x1:"62",y1:"145",x2:"85",y2:"145",stroke:"currentColor","stroke-width":"2.5","stroke-linecap":"round"}}),e("line",{attrs:{x1:"110",y1:"145",x2:"133",y2:"145",stroke:"currentColor","stroke-width":"2.5","stroke-linecap":"round"}}),e("line",{attrs:{x1:"157",y1:"145",x2:"178",y2:"145",stroke:"currentColor","stroke-width":"2.5","stroke-linecap":"round"}}),e("line",{attrs:{x1:"62",y1:"170",x2:"85",y2:"170",stroke:"currentColor","stroke-width":"2.5","stroke-linecap":"round"}}),e("line",{attrs:{x1:"110",y1:"170",x2:"133",y2:"170",stroke:"currentColor","stroke-width":"2.5","stroke-linecap":"round"}}),e("line",{attrs:{x1:"157",y1:"170",x2:"178",y2:"170",stroke:"currentColor","stroke-width":"2.5","stroke-linecap":"round"}})])]),e("div",{staticClass:"empty-state-title"},[t._v("Нет данных")]),e("div",{staticClass:"empty-state-description"},[t._v(t._s(t.emptyStateMessage))]),t.hasDatasetConfigured?t._e():e("button",{staticClass:"empty-state-button",attrs:{type:"button"}},[e("svg",{attrs:{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[e("path",{attrs:{d:"M3 8h10M8 3v10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round"}})]),t._v(" Перейдите на вкладку «Источник» ")])])]):t._e(),t.error?e("div",{staticClass:"absolute bottom-2 left-2 right-2 text-center text-xs text-red-600"},[t._v(" "+t._s(t.error)+" ")]):t._e(),t.inlineEditingColumn?e("w-inline-column-editor",{attrs:{column:t.inlineEditingColumn,"column-settings":t.props.columnSettings,"hierarchical-settings":t.getHierarchicalSettingsWithChildrenLevels(t.inlineEditingColumn?.id),"all-columns":t.allColumns,"is-visible":!!t.inlineEditingColumn,position:t.inlineEditorPosition,"is-hierarchical":t.isHierarchicalDimension(t.inlineEditingColumn?.id),"current-drilldown-level":t.getDrilldownLevelForColumn(t.inlineEditingColumn?.id),"drilldown-filters":t.getDrilldownFiltersForColumn(t.inlineEditingColumn?.id)},on:{"update-column":t.handleInlineColumnUpdate,"update-hierarchical-column":t.handleInlineHierarchicalColumnUpdate,"apply-to-similar":t.handleApplyToSimilar,"reset-column":t.handleResetColumn,close:t.closeInlineEditor}}):t._e()],1)])},n=[],l=i(93423),o=i(5021),r=i(37022),a=i(17357),h=i(94925),c=i(7038),u=i(63983),d=i(31704),p=i(19894),m=i(41223),g=i(94521),C=i(36822),f=i(86396),b=i(29456),w=i(48759);const v=(0,o.useElemDatasetMixin)({drilldown:!0,panel:!1}),y={extends:l.Elem,components:{WTableHeader:C.A,WTableRow:f.A,WTableFilterRow:b.A,WInlineColumnEditor:w.A},mixins:[v,u.M],meta:r.mI,hooks:{before(t){},then(t){this.isLoading=!1},catch(t){this.error=t.message||"Ошибка загрузки данных",this.isLoading=!1},finally(){this.isLoading=!1}},data(){return{isLoading:!1,error:null,columnWidths:{},sortColumn:null,sortDirection:"asc",selectedRows:[],inlineEditingColumn:null,inlineEditorPosition:{x:0,y:0},internalColumnOrders:[],columnSettingsVersion:0,localRowHeight:null,localHeaderHeight:null,localCellFontSize:null,localHeaderFontSize:null,isSystemPrefersDark:!1,localTheme:null,columnFilters:{},isLocalShowColumnFilters:!1,appliedColumnFilters:{},facetsData:{},isFacetsLoading:!1,isAddColumnMenuVisible:!1,isTableSettingsMenuVisible:!1,isDensityMenuVisible:!1,isThemeMenuVisible:!1,densityOptions:[{value:"compact",label:"Компактная"},{value:"normal",label:"Обычная"},{value:"comfortable",label:"Широкая"}],themeOptions:h.Rq,frozenColumns:[]}},computed:{scheme(){return(0,h.p)("zinc")},themeClass(){const t=null!=this.localTheme?this.localTheme:this.props.theme;return"auto"===t?this.isSystemPrefersDark?"dark":"":"dark"===t?"dark":""},hasDatasetConfigured(){const{dimensions:t,metrics:e}=this.props,i=t&&t.length>0,s=e&&e.length>0;return i||s},shouldShowCustomEmptyState(){return!this.isLoading&&(!this.hasDatasetConfigured||0===this.tableData.length)},emptyStateMessage(){return this.hasDatasetConfigured?"Добавьте измерения и метрики для отображения таблицы":"Настройте источник данных и добавьте измерения или метрики"},radiusClass(){return h.MJ.radiusToClass[this.props.borderRadius]||h.MJ.radiusToClass.md},allDrilldownDimensions(){const t=this.props.dimensions||[];return null==this.$drilldown||null==this.$drilldown.state?[]:t.filter(t=>{const e=this.$drilldown.state[t];return e&&(void 0!==e.canPush||e.childrenLevels)})},mainDimensionName(){return this.allDrilldownDimensions[0]||null},activeDrilldownStates(){return null==this.$drilldown||null==this.$drilldown.state?[]:this.allDrilldownDimensions.map(t=>({name:t,canPop:this.$drilldown.state[t]?.canPop??!1,canPush:this.$drilldown.state[t]?.canPush??!1,filters:this.$drilldown.state[t]?.filters||[],childrenLevels:this.$drilldown.state[t]?.childrenLevels})).filter(t=>t.filters.length>0)},drilldownState(){return null==this.mainDimensionName?{canPop:!1,canPush:!1,filters:[],name:null}:{canPop:!1,canPush:!1,filters:[],...this.$drilldown.state[this.mainDimensionName],name:this.mainDimensionName}},hasMultipleActiveHierarchies(){return this.activeDrilldownStates.length>1},singleActiveDimensionState(){return 1===this.activeDrilldownStates.length?this.activeDrilldownStates[0]:this.drilldownState},drilldownCanPush(){return this.drilldownState?.canPush??!1},showBreadcrumbs(){return this.activeDrilldownStates.length>0},currentDrilldownLevel(){const{filters:t}=this.drilldownState||{};return null==this.drilldownState||null==t?0:t.length},tableData(){const{rows:t}=this.result||{};if(null==t||0===t.length)return[];let e=t;const{showRowNumbers:i}=this.props;return null!=i&&(e=e.map((t,e)=>({...t,__rowNo:e+1}))),this.sortColumn&&this.props.enableSorting?(0,c.sortTableData)(e,this.sortColumn,this.sortDirection):e},filteredTableData(){return this.props.enableBackendFiltering||null==this.props.enableColumnFilters||0===Object.keys(this.columnFilters).length?this.tableData:(0,p.W5)(this.tableData,this.columnFilters,this.allColumns)},activeFilterCount(){return Object.values(this.columnFilters).filter(t=>{if(null==t.value||""===t.value)return!1;if(Array.isArray(t.value)){if(0===t.value.length)return!1;if(t.value.every(t=>null==t))return!1}return!0}).length},shouldShowFilterRow(){const t=this.isLocalShowColumnFilters,e=this.props.enableColumnFilters,i=this.shouldShowCustomEmptyState;return e&&t&&!i},allColumns(){this.columnSettingsVersion;const t=this.props.dimensions||[],e=this.props.metrics||[],i=[...t,...e],s=this.internalColumnOrders.length>0?this.internalColumnOrders:this.props.columnOrder,{columnSettings:n,showRowNumbers:l}=this.props;if(0===i.length&&this.tableData.length>0){let t=Object.keys(this.tableData[0]||{});const e=t.indexOf("__rowNo");if(e>-1&&(t.splice(e,1),this.props.showRowNumbers&&t.unshift("__rowNo")),s&&s.length>0){const e=s.filter(e=>t.includes(e)),i=t.filter(t=>!s.includes(t)),n=i.includes("__rowNo")?["__rowNo"]:[],l=i.filter(t=>"__rowNo"!==t);t=[...n,...e,...l]}else{const e=t.includes("__rowNo")?["__rowNo"]:[],i=t.filter(t=>"__rowNo"!==t),s=i.filter(t=>this.allDrilldownDimensions.includes(t)),n=i.filter(t=>!this.allDrilldownDimensions.includes(t));t=[...e,...s,...n]}return t.map(t=>{if("__rowNo"===t)return{id:t,field:t,label:"#",width:60,alignment:"right",format:"0",type:"integer",decimals:0,visible:!0,sortable:!1,resizable:!0,fontColor:"#9ca3af"};const e=this.getEffectiveColumnSettings(t),i=!1!==e.visible,s=this.getColumnType(t),{alignment:n}=e,l=this.getDefaultAlignment(s),o=null==n||"left"===n&&"right"===l?l:n;let r=t;if(this.isHierarchicalDimension(t)){const e=this.props.hierarchicalSettings||{},i=this.getDrilldownLevelForColumn(t),s=e[t]?.childrenLevels||[];s.length>i&&(r=s[i])}return{id:t,field:r,label:e.label||t,width:this.getColumnWidth(t),alignment:o,format:e.format||this.getColumnFormat(t),type:s,decimals:e.decimals??this.getDefaultDecimals(s),visible:i,sortable:!0,resizable:!0}})}let o=[];if(s&&s.length>0){o=s.filter(t=>i.includes(t));const t=i.filter(t=>!o.includes(t));o=[...o,...t]}else{const s=this.allDrilldownDimensions.filter(t=>i.includes(t)),n=t.filter(t=>!this.allDrilldownDimensions.includes(t));o=[...s,...n,...e]}return this.props.showRowNumbers&&this.tableData.length>0&&null!=this.tableData[0].__rowNo&&(o=["__rowNo",...o]),o.map(t=>{if("__rowNo"===t)return{id:t,field:t,label:"#",width:60,alignment:"right",format:"0",type:"integer",decimals:0,visible:!0,sortable:!1,resizable:!0,fontColor:"#9ca3af"};const e=this.getEffectiveColumnSettings(t),i=!1!==e.visible,s=this.getColumnType(t),{alignment:n}=e,l=this.getDefaultAlignment(s),o=null==n||"left"===n&&"right"===l?l:n;let r=t;if(this.isHierarchicalDimension(t)){const e=this.props.hierarchicalSettings||{},i=this.getDrilldownLevelForColumn(t),s=e[t]?.childrenLevels||[];s.length>i&&(r=s[i])}return{id:t,field:r,label:e.label||t,width:this.getColumnWidth(t),alignment:o,format:e.format||this.getColumnFormat(t),type:s,decimals:e.decimals??this.getDefaultDecimals(s),visible:i,sortable:!0,resizable:!0}})},visibleColumns(){return this.allColumns.filter(t=>t.visible)},frozenColumnPositions(){const t={};let e=0;return this.visibleColumns.forEach(i=>{const s=i.id,n=this.frozenColumns.includes(s);if(n){t[s]=e;const n=this.columnWidths[s]||i.width||d.SJ;e+=n}}),t},rowHeightPx(){const t=this.localRowHeight||this.props.rowHeight||{size:40,unit:"px"};return this.takeUnit2Px({value:t.size,unit:t.unit||"px"})},containerStyle(){const t=this.props.containerPadding||{size:16,unit:"px"},e=this.takeUnit2Px({value:t.size,unit:t.unit||"px"});return{padding:`${e}px`}},headerHeightInPx(){const t=this.localHeaderHeight||this.props.headerHeight||{size:48,unit:"px"};return this.takeUnit2Px({value:t.size,unit:t.unit||"px"})},headerStyle(){const t=this.headerHeightInPx,e={height:`${t}px`};return this.props.headerBackgroundColor&&(e.backgroundColor=this.props.headerBackgroundColor),this.props.bordered&&(e.borderBottom=`1px solid ${this.props.borderColor||"#e5e7eb"}`),e},headerCellStyle(){const t=this.localHeaderFontSize||this.props.headerFontSize||h.MJ.densityToHeaderFontSize[this.props.density]||{size:13,unit:"px"},e=this.takeUnit2Px({value:t.size,unit:t.unit||"px"}),i=h.MJ.densityToCellPadding[this.props.density]||{size:5,unit:"px"},s=this.takeUnit2Px({value:i.size,unit:i.unit||"px"}),n={fontSize:`${e}px`,padding:`${s}px`,fontWeight:"600"};return this.props.headerFontFamily&&(n.fontFamily=this.props.headerFontFamily),this.props.headerFontColor&&(n.color=this.props.headerFontColor),n},rowStyle(){const t={height:`${this.rowHeightPx}px`};return this.props.rowBackgroundColor&&(t.backgroundColor=this.props.rowBackgroundColor),this.props.bordered&&(t.borderBottom=`1px solid ${this.props.borderColor||"#e5e7eb"}`),t},cellStyle(){const t=this.localCellFontSize||this.props.cellFontSize||h.MJ.densityToCellFontSize[this.props.density]||{size:13,unit:"px"},e=this.takeUnit2Px({value:t.size,unit:t.unit||"px"}),i=h.MJ.densityToCellPadding[this.props.density]||{size:5,unit:"px"},s=this.takeUnit2Px({value:i.size,unit:i.unit||"px"}),n={fontSize:`${e}px`,padding:`${s}px`};return this.props.cellFontFamily&&(n.fontFamily=this.props.cellFontFamily),this.props.cellFontColor&&(n.color=this.props.cellFontColor),n},alternateRowStyle(){const t={};return this.props.alternateRowColor&&(t.backgroundColor=this.props.alternateRowColor),t},selectedRowStyle(){const t={};return this.props.selectedColor&&(t.backgroundColor=this.props.selectedColor),t},hoverRowStyle(){const{hoverable:t}=this.props;if(null==t||!1===t)return{};const e={};return this.props.hoverColor&&(e.backgroundColor=this.props.hoverColor),e},containerStyleWithCustom(){return this.mergeWithCustomStyles(this.containerStyle,"container")},scrollWrapperStyleWithCustom(){const t={flex:"1",overflow:"auto",position:"relative"};return this.mergeWithCustomStyles(t,"scrollWrapper")},tableBodyStyleWithCustom(){const t={position:"relative",minWidth:"fit-content"};return this.mergeWithCustomStyles(t,"tableBody")},breadcrumbStyleWithCustom(){const t={};return this.mergeWithCustomStyles(t,"breadcrumb")},topBarStyleWithCustom(){const t={};return this.mergeWithCustomStyles(t,"topBar")},hiddenColumnsToShow(){const t=[...this.props.dimensions||[],...this.props.metrics||[]],e=t.filter(t=>{const e=this.props.columnSettings[t],i=e&&!1===e.visible;return i}).map(t=>{const e=this.props.columnSettings[t]||{};return{id:t,label:e.label||t,visible:!1}});return e},availableDimensions(){return this.dimensions.filter(t=>!this.props.dimensions.includes(t.id||t))},availableMetrics(){return this.metrics.filter(t=>!this.props.metrics.includes(t.id||t))}},watch:{"props.theme":{handler(){this.$forceUpdate()},immediate:!1},"props.rowHeight":{handler(){this.$forceUpdate()},deep:!0},"props.headerHeight":{handler(){},deep:!0},"props.cellFontSize":{handler(){},deep:!0},"props.headerFontSize":{handler(){},deep:!0},tableData:{handler(t,e){const i=(null==e||0===e.length)&&t&&t.length>0;this.initializeColumnWidths(),i&&this.$nextTick(()=>{this.autoDetectAllColumnTypes()})},immediate:!0},"$drilldown.state":{handler(t){if(null==t)return;const e={...this.props.hierarchicalSettings||{}};let i=!1;Object.keys(t).forEach(s=>{const n=t[s];if(n?.childrenLevels?.length>0)return null==e[s]&&(e[s]={}),void(JSON.stringify(e[s].childrenLevels)!==JSON.stringify(n.childrenLevels)&&(e[s].childrenLevels=n.childrenLevels,i=!0));if(null!=this.dimensions){const t=this.dimensions.find(t=>t.id===s);if(null!=t?.drilldown){const n=[];let l=t.drilldown;while(null!=l)n.push(l.field),l=l.child;n.length>0&&(null==e[s]&&(e[s]={}),JSON.stringify(e[s].childrenLevels)!==JSON.stringify(n)&&(e[s].childrenLevels=n,i=!0))}}}),i&&(this.$set(this.props,"hierarchicalSettings",e),this.propChanged("hierarchicalSettings"))},deep:!0,immediate:!0},allColumns:{handler(t){if(this.initializeColumnWidths(),t&&t.length>0&&0===this.internalColumnOrders.length){const e=t.map(t=>t.id);this.internalColumnOrders=e,this.$set(this.props,"columnOrder",e),this.propChanged("columnOrder")}},immediate:!0},"props.dimensions":{handler(){this.ensureColumnOrder()},immediate:!0},"props.metrics":{handler(){this.ensureColumnOrder()},immediate:!0},"props.columnOrder":{handler(t,e){if(t&&t.length>0){const e=JSON.stringify(t)!==JSON.stringify(this.internalColumnOrders);e&&(this.internalColumnOrders=[...t])}},deep:!0,immediate:!0},"props.columnFilters":{handler(t){t&&"object"===typeof t&&(this.columnFilters={...t})},deep:!0,immediate:!0},"props.showColumnFilters":{handler(t){this.isLocalShowColumnFilters=!!t},immediate:!0},"props.showRowNumbers":{handler(){this.columnSettingsVersion++,this.$nextTick(()=>{this.initializeColumnWidths(),this.$forceUpdate()})}}},mounted(){null==this.props.density&&this.$set(this.props,"density","normal");const{cellFontSize:t,headerFontSize:e}=this.props;null!=t&&14===t.size&&"px"===t.unit&&(this.$set(this.props,"cellFontSize",null),this.propChanged("cellFontSize")),null!=e&&14===e.size&&"px"===e.unit&&(this.$set(this.props,"headerFontSize",null),this.propChanged("headerFontSize"));const i=this.props.density||"normal";if(null==this.props.cellFontSize){const t=h.MJ.densityToCellFontSize[i];null!=t&&(this.localCellFontSize=t)}if(null==this.props.headerFontSize){const t=h.MJ.densityToHeaderFontSize[i];null!=t&&(this.localHeaderFontSize=t)}this.props.defaultSortColumn&&(this.sortColumn=this.props.defaultSortColumn),this.props.defaultSortDirection&&(this.sortDirection=this.props.defaultSortDirection),this.props.columnFilters&&Object.keys(this.props.columnFilters).length>0&&(this.columnFilters={...this.props.columnFilters}),null!=this.props.showColumnFilters&&(this.isLocalShowColumnFilters=this.props.showColumnFilters),null!=this.props.theme&&(this.localTheme=this.props.theme);const s=this.props.frozenColumns;if(null!=s&&s.length>0)this.frozenColumns=[...s];else{const t=this.visibleColumns[0];null!=t&&(this.frozenColumns=[t.id],this.handleFrozenColumnsChange([t.id]))}this.$watch("props.showRowNumbers",()=>{this.columnSettingsVersion++,this.$nextTick(()=>{this.initializeColumnWidths(),this.$forceUpdate()})},{deep:!0}),this.$watch("props",(t,e)=>{t.showRowNumbers!==e.showRowNumbers&&(this.columnSettingsVersion++,this.$nextTick(()=>{this.initializeColumnWidths(),this.$forceUpdate()})),t.theme!==e.theme&&(this.localTheme=t.theme)},{deep:!0}),this.detectSystemTheme(),this.addSystemThemeListener(),this.ensureColumnOrder(),this.initializeColumnWidths(),document.addEventListener("click",this.handleClickOutsideToolbar)},beforeDestroy(){this.removeSystemThemeListener(),document.removeEventListener("click",this.handleClickOutsideToolbar)},methods:{...a.c,...o.ElemDatasetMixinTypes,drilldownPopToTopForDimension(t){if(null==t||null==this.$drilldown||null==this.$drilldown.state)return;const e=this.$drilldown.state[t],i=e?.filters||[];if(0===i.length)return;const s=i.length;for(let o=0;o<s;o++)this.$drilldown.pop(t);const n=this.props.varAliases&&this.props.varAliases[t];if(n)try{this.$storeCommit({[t]:null})}catch(l){}},drilldownPopToLevelForDimension(t,e){if(null==t||null==this.$drilldown||null==this.$drilldown.state)return;const i=this.$drilldown.state[t],s=i?.filters||[];if(e<0||e>=s.length)return;const n=s[e].value,l=s.length-e-1;for(let a=0;a<l;a++)this.$drilldown.pop(t);const o=this.props.varAliases&&this.props.varAliases[t];if(o)try{this.$storeCommit({[t]:n})}catch(r){}},handleDimensionCellClick(t,e){const i=this.props.dimensions||[],s=i.includes(t);if(!s)return;const n=this.allDrilldownDimensions.includes(t);if(!n)return;const l=this.$drilldown.state[t],o=l?.canPush??!1;if(o&&null!=e){const i=this.props.varAliases&&this.props.varAliases[t];if(i)try{this.$storeCommit({[t]:e})}catch(r){}this.$drilldown.push(t,e)}},getCurrentLevelIndex(t){return null==t.filters||0===t.filters.length?-1:t.filters.length-1},handleDimensionLevelChange(t,e){const i=parseInt(e,10),s=this.$drilldown.state[t];if(null==s)return;const n=s.filters||[];if(-1===i){const e=n.length;for(let s=0;s<e;s++)this.$drilldown.pop(t);const i=this.props.varAliases&&this.props.varAliases[t];if(i)try{this.$storeCommit({[t]:null})}catch(l){}return}if(i<n.length-1){const e=n[i].value,s=n.length-i-1;for(let i=0;i<s;i++)this.$drilldown.pop(t);const o=this.props.varAliases&&this.props.varAliases[t];if(o)try{this.$storeCommit({[t]:e})}catch(l){}}},ensureColumnOrder(){const t=this.props.dimensions||[],e=this.props.metrics||[],i=[...t,...e],{columnOrder:s}=this.props;if(null==s||0===s.length){if(i.length>0){const s=this.allDrilldownDimensions.filter(t=>i.includes(t)),n=t.filter(t=>!this.allDrilldownDimensions.includes(t)),l=[...s,...n,...e];this.$set(this.props,"columnOrder",l),this.propChanged("columnOrder"),this.syncColumnOrderToDimensionsAndMetrics(l)}}else{const t=i.filter(t=>!s.includes(t));if(t.length>0){const e=t.filter(t=>this.allDrilldownDimensions.includes(t)),i=t.filter(t=>!this.allDrilldownDimensions.includes(t)),n=s.filter(t=>this.allDrilldownDimensions.includes(t)),l=n.length>0?s.lastIndexOf(n[n.length-1]):-1;let o=[...s];if(e.length>0){const t=l+1;o.splice(t,0,...e)}i.length>0&&(o=[...o,...i]),this.$set(this.props,"columnOrder",o),this.propChanged("columnOrder"),this.syncColumnOrderToDimensionsAndMetrics(o)}}},handleHideColumn(t){const e=this.props.columnSettings[t]||{},i=!1!==e.visible;this.updateColumnSetting(t,"visible",!i)},handleAddDimension(t){if(!this.props.dimensions.includes(t)){if(this.props.dimensions=[...this.props.dimensions,t],this.propChanged("dimensions"),!this.props.columnOrder.includes(t)){const e=this.allDrilldownDimensions.includes(t);if(e){const e=this.props.columnOrder.filter(t=>this.allDrilldownDimensions.includes(t)),i=e.length>0?this.props.columnOrder.lastIndexOf(e[e.length-1]):-1,s=[...this.props.columnOrder];s.splice(i+1,0,t),this.$set(this.props,"columnOrder",s)}else{const e=[...this.props.columnOrder,t];this.$set(this.props,"columnOrder",e)}this.propChanged("columnOrder")}this.updateColumnSetting(t,"visible",!0)}},handleAddMetric(t){if(!this.props.metrics.includes(t)){if(this.props.metrics=[...this.props.metrics,t],this.propChanged("metrics"),!this.props.columnOrder.includes(t)){const e=[...this.props.columnOrder,t];this.$set(this.props,"columnOrder",e),this.propChanged("columnOrder")}this.updateColumnSetting(t,"visible",!0)}},handleUpdateCustomStyles(t){this.props.customStyles=t,this.propChanged("customStyles")},handleUpdateColumnSetting(t,e){const i={...this.props.columnSettings};i[t]={...i[t],...e},this.$set(this.props,"columnSettings",i),this.propChanged("columnSettings"),this.columnSettingsVersion++},parseCustomCSS(t){if(null==t||"string"!==typeof t)return{};const e={},i=t.split(";").filter(t=>t.trim());return i.forEach(t=>{const[i,s]=t.split(":").map(t=>t.trim());if(i&&s){const t=i.replace(/-([a-z])/g,(t,e)=>e.toUpperCase());e[t]=s}}),e},mergeWithCustomStyles(t,e){const i=this.props.customStyles||{},s=i[e];if(null==s||""===s)return t;const n=this.parseCustomCSS(s);return{...t,...n}},distributeRemainingSpace(t){const{tableContainer:e}=this.$refs;if(null==e)return;const i=e.clientWidth;let s=0;this.allColumns.forEach(e=>{s+=t[e.id]||0});const n=15,l=24,o=i-n-l,r=o-s;if(r<=10)return;const a=["integer","number","bigint","percent","currency"],h=this.allColumns.filter(t=>{const e=this.props.columnSettings[t.id],i=e&&e.width;if(i)return!1;const s=this.getColumnType(t.id);return a.includes(s)});let c=h;if(0===h.length&&(c=this.allColumns.filter(t=>{const e=this.props.columnSettings[t.id];return!(e&&e.width)})),0===c.length)return;const u=Math.floor(r/c.length);c.forEach(e=>{t[e.id]=(t[e.id]||0)+u})},initializeColumnWidths(){const t={};this.allColumns.forEach(e=>{if("__rowNo"===e.id)return void(t[e.id]=60);const i=this.props.columnSettings[e.id];if(i&&i.width){const s=i.width;t[e.id]=this.takeUnit2Px({value:s.size,unit:s.unit||"px"})}else if(null!=this.columnWidths[e.id]&&null==this.props.autoFitColumns)t[e.id]=this.columnWidths[e.id];else if(this.props.autoFitColumns){const i=this.tableData.slice(0,100).map(t=>t[e.field]),s=h.MJ.densityToCellFontSize[this.props.density]||{size:13,unit:"px"},n=this.takeUnit2Px({value:this.props.cellFontSize?.size||s.size,unit:this.props.cellFontSize?.unit||"px"}),l=this.getColumnType(e.id);t[e.id]=(0,c.calculateOptimalColumnWidth)(i,n,l,this.rowHeightPx)}else t[e.id]=d.SJ}),this.props.autoFitColumns&&this.distributeRemainingSpace(t),this.columnWidths=t},handleColumnResize(t,e){this.columnWidths={...this.columnWidths,[t]:e},this.updateColumnSetting(t,"width",{size:e,unit:"px"})},handleColumnMove(t,e){if(t===e)return;const i=[...this.props.columnOrder||[]],s=[...this.visibleColumns];if(null==s[t]||null==s[e])return;const n=s[t].id,l=s[e].id,o=i.indexOf(n),r=i.indexOf(l);if(-1===o||-1===r)return;const[a]=i.splice(o,1);i.splice(r,0,a),this.internalColumnOrders=[...i],this.$set(this.props,"columnOrder",i),this.propChanged("columnOrder"),this.syncColumnOrderToDimensionsAndMetrics(i)},handleSort(t){this.sortColumn===t?this.sortDirection="asc"===this.sortDirection?"desc":"asc":(this.sortColumn=t,this.sortDirection="asc"),this.$set(this.props,"defaultSortColumn",this.sortColumn),this.$set(this.props,"defaultSortDirection",this.sortDirection),this.propChanged("defaultSortColumn"),this.propChanged("defaultSortDirection")},handleRowClick(t,e){this.$emit("row-click",t,e)},handleRowSelect(t,e){const{enableRowSelection:i}=this.props;if(null==i||!1===i)return;const s=this.selectedRows.indexOf(e);s>-1?this.selectedRows.splice(s,1):this.selectedRows.push(e)},handleInlineEdit(t,e){if(null!=e){const t=e.closest(".table-header-cell"),{tableContainer:i}=this.$refs;if(null!=t&&null!=i){const e=t.getBoundingClientRect(),s=i.getBoundingClientRect();this.inlineEditorPosition={x:e.right-s.left,y:e.top-s.top}}}this.inlineEditingColumn=t},closeInlineEditor(){this.inlineEditingColumn=null},handleInlineColumnUpdate(t,e){const i={...this.props.columnSettings};i[t]={...i[t],...e},this.$set(this.props,"columnSettings",i),this.propChanged("columnSettings"),this.columnSettingsVersion++,e.width&&(this.columnWidths={...this.columnWidths,[t]:e.width.size})},handleInlineHierarchicalColumnUpdate(t,e,i){const s={...this.props.hierarchicalSettings};null==s[t]&&(s[t]={}),s[t][e]={...s[t][e],...i},this.$set(this.props,"hierarchicalSettings",s),this.propChanged("hierarchicalSettings"),this.columnSettingsVersion++;const{width:n}=i;n&&e===this.currentDrilldownLevel&&(this.columnWidths={...this.columnWidths,[t]:n.size}),this.$nextTick(()=>{this.$forceUpdate()})},handleApplyToSimilar(t,e){const i={...this.props.columnSettings},s={...this.columnWidths};t.forEach(t=>{i[t.id]={...i[t.id],...e},e.width&&(s[t.id]=e.width.size)}),this.$set(this.props,"columnSettings",i),this.propChanged("columnSettings"),this.columnSettingsVersion++,e.width&&(this.columnWidths=s)},handleResetColumn(t){const e={...this.props.columnSettings};delete e[t],this.$set(this.props,"columnSettings",e),this.propChanged("columnSettings"),this.columnSettingsVersion++},handleDensityChange(t){this.isDensityMenuVisible=!1,this.$set(this.props,"density",t),this.propChanged("density");const e=h.MJ.densityToRowHeight[t]||{size:32,unit:"px"},i=h.MJ.densityToHeaderHeight[t]||{size:36,unit:"px"},s=h.MJ.densityToCellFontSize[t]||{size:13,unit:"px"},n=h.MJ.densityToHeaderFontSize[t]||{size:13,unit:"px"};this.localRowHeight=e,this.localHeaderHeight=i,this.localCellFontSize=s,this.localHeaderFontSize=n,this.$set(this.props,"rowHeight",e),this.$set(this.props,"headerHeight",i),this.$set(this.props,"cellFontSize",s),this.$set(this.props,"headerFontSize",n),this.propChanged("rowHeight"),this.propChanged("headerHeight"),this.propChanged("cellFontSize"),this.propChanged("headerFontSize");const l={...this.props.columnSettings};Object.keys(l).forEach(t=>{l[t]&&delete l[t].width}),this.$set(this.props,"columnSettings",l),this.propChanged("columnSettings"),this.$nextTick(()=>{this.initializeColumnWidths()})},handleToggleRowNumbers(){const t=!this.props.showRowNumbers;this.$set(this.props,"showRowNumbers",t),this.propChanged("showRowNumbers"),this.isTableSettingsMenuVisible=!1,this.columnSettingsVersion++,this.$nextTick(()=>{this.initializeColumnWidths(),this.$forceUpdate()})},handleAutoFitToggle(t){this.$set(this.props,"autoFitColumns",t),this.propChanged("autoFitColumns"),null!=t&&this.initializeColumnWidths()},handleAutoFitNow(){const t={};this.allColumns.forEach(e=>{if("__rowNo"===e.id)return void(t[e.id]=60);const i=this.tableData.slice(0,100).map(t=>t[e.field]),s=h.MJ.densityToCellFontSize[this.props.density]||{size:13,unit:"px"},n=this.takeUnit2Px({value:this.props.cellFontSize?.size||s.size,unit:this.props.cellFontSize?.unit||"px"}),l=this.getColumnType(e.id);t[e.id]=(0,c.calculateOptimalColumnWidth)(i,n,l,this.rowHeightPx)}),this.distributeRemainingSpace(t),this.columnWidths=t},async handleExportToExcel(){try{const{cellFontSize:t,headerFontSize:e}=this.props,i="dark"===this.themeClass,s={headerBackgroundColor:i?"#27272a":"#f4f4f5",rowBackgroundColor:i?"#111827":"#ffffff",alternateRowColor:i?"#18181b":"#f9fafb",borderColor:i?"#374151":"#e5e7eb",headerFontColor:i?"#fafafa":"#27272a",cellFontColor:i?"#e5e7eb":"#000000"},n={filename:"table-export.xlsx",sheetName:"Data",headerBackgroundColor:this.props.headerBackgroundColor||s.headerBackgroundColor,headerFontColor:this.props.headerFontColor||s.headerFontColor,headerFontSize:e?.size,headerFontWeight:this.props.headerFontWeight,headerFontFamily:this.props.headerFontFamily,cellFontColor:this.props.cellFontColor||s.cellFontColor,cellFontSize:t?.size,cellFontWeight:this.props.cellFontWeight,cellFontFamily:this.props.cellFontFamily,rowBackgroundColor:this.props.rowBackgroundColor||s.rowBackgroundColor,striped:this.props.striped,alternateRowColor:this.props.alternateRowColor||s.alternateRowColor,borderColor:this.props.borderColor||s.borderColor,bordered:!1!==this.props.bordered,tagSeparator:this.props.tagSeparator,isDark:i},l=this.filteredTableData,o=this.visibleColumns.map(t=>{const e=this.getEffectiveColumnSettings(t.id);return{...t,fontColor:e.fontColor,fontSize:e.fontSize,fontWeight:e.fontWeight,fontFamily:e.fontFamily,fontStyle:e.fontStyle,textDecoration:e.textDecoration,backgroundColor:e.backgroundColor}});await(0,c.exportToExcel)(l,o,n)}catch(t){}},handleFilterChange(t,e){if(this.props.enableBackendFiltering){const i=this.columnFilters[t]||{};let s=i.filterFn;if(null==s)if(Array.isArray(e)){const t=2===e.length&&("number"===typeof e[0]||"number"===typeof e[1]||null==e[0]||null==e[1]);s=t?null!=e[0]&&null==e[1]?"greaterThanOrEqualTo":null==e[0]&&null!=e[1]?"lessThanOrEqualTo":"between":"arrIncludesSome"}else s="contains";return void this.handleBackendFilterChange(t,e,s)}if(null==e||""===e||Array.isArray(e)&&0===e.length||Array.isArray(e)&&e.every(t=>null==t))this.$delete(this.columnFilters,t);else{const i=this.columnFilters[t];let s=i?.filterFn;if(null==s&&Array.isArray(e)){const t=2===e.length&&("number"===typeof e[0]||"number"===typeof e[1]||null==e[0]||null==e[1]);s=t?null!=e[0]&&null==e[1]?"greaterThanOrEqualTo":null==e[0]&&null!=e[1]?"lessThanOrEqualTo":"between":"arrIncludesSome"}this.$set(this.columnFilters,t,{...i,value:e,...s?{filterFn:s}:{}})}this.$set(this.props,"columnFilters",{...this.columnFilters}),this.propChanged("columnFilters")},handleFilterModeChange(t,e){this.$set(this.columnFilters,t,{...this.columnFilters[t],filterFn:e}),this.$set(this.props,"columnFilters",{...this.columnFilters}),this.propChanged("columnFilters")},toggleFilters(){const t=!this.isLocalShowColumnFilters;this.isLocalShowColumnFilters=t,this.$set(this.props,"showColumnFilters",t),this.propChanged("showColumnFilters"),t&&this.props.enableBackendFiltering&&this.props.enableCrossFiltering&&this.$nextTick(()=>{this.loadFacetsForVisibleColumns()})},async loadFacetsForVisibleColumns(){if(!0!==this.props.enableBackendFiltering||!0!==this.props.enableCrossFiltering)return;const t=(0,g.UQ)(this.allColumns,this.props.columnSettings);if(0!==t.length){this.isFacetsLoading=!0;try{const e=this.allColumns.filter(t=>{const e=this.props.columnSettings[t.id]||{};return!1!==e.visible}).map(t=>t.id),i=await(0,g.KZ)(t,this.appliedColumnFilters,this.buildBackendQuery(),this.loadData.bind(this),{visibleColumnIds:e,batchSize:5,maxValues:this.props.maxFacetedValues||1e3,progressive:!0});this.facetsData={...this.facetsData,...i}}catch(e){}finally{this.isFacetsLoading=!1}}},buildBackendQuery(){const t=this.$query||{};if(!0!==this.props.enableBackendFiltering)return t;const e=(0,m.fX)(this.appliedColumnFilters,this.allColumns);return{...t,query:{...t.query||{},$filters:[...t.query?.$filters||[],...e]}}},toggleTableSettingsMenu(){this.isTableSettingsMenuVisible=!this.isTableSettingsMenuVisible,this.isAddColumnMenuVisible=!1,this.isDensityMenuVisible=!1,this.isThemeMenuVisible=!1},toggleAddColumnMenu(){this.isAddColumnMenuVisible=!this.isAddColumnMenuVisible,this.isTableSettingsMenuVisible=!1,this.isDensityMenuVisible=!1,this.isThemeMenuVisible=!1},toggleDensityMenu(){this.isDensityMenuVisible=!this.isDensityMenuVisible,this.isTableSettingsMenuVisible=!1,this.isAddColumnMenuVisible=!1,this.isThemeMenuVisible=!1},getDensityIcon(t){const e={compact:"─",normal:"═",comfortable:"▤"};return e[t]||"═"},toggleThemeMenu(){this.isThemeMenuVisible=!this.isThemeMenuVisible,this.isTableSettingsMenuVisible=!1,this.isAddColumnMenuVisible=!1,this.isDensityMenuVisible=!1},handleThemeChange(t){this.isThemeMenuVisible=!1,this.localTheme=t,this.$set(this.props,"theme",t),this.propChanged("theme")},handleFrozenColumnsChange(t){this.frozenColumns=t,this.$set(this.props,"frozenColumns",t),this.propChanged("frozenColumns")},handleToggleFreezeColumn(t){const e=this.visibleColumns.findIndex(e=>e.id===t);if(-1===e)return;const i=this.frozenColumns.includes(t);if(i){const t=this.frozenColumns.filter(t=>{const i=this.visibleColumns.findIndex(e=>e.id===t);return i<e});this.handleFrozenColumnsChange(t)}else{const t=this.visibleColumns.slice(0,e+1).map(t=>t.id);this.handleFrozenColumnsChange(t)}},getThemeTitle(t){const e={auto:"Тема: Авто (системная)",light:"Тема: Светлая",dark:"Тема: Темная"};return e[t]||"Тема"},handleClickOutsideToolbar(t){const e=this.$el.querySelector(".table-toolbar"),i=null!=e&&e.contains(t.target);null!=i&&!1!==i||(this.isAddColumnMenuVisible=!1,this.isTableSettingsMenuVisible=!1,this.isDensityMenuVisible=!1,this.isThemeMenuVisible=!1)},updateColumnSetting(t,e,i){const s=JSON.parse(JSON.stringify(this.props.columnSettings||{}));null==s[t]&&(s[t]={}),s[t][e]=i,this.$set(this.props,"columnSettings",s),this.propChanged("columnSettings"),this.columnSettingsVersion++},getColumnWidth(t){const e=this.getEffectiveColumnSettings(t);return e?.width?this.takeUnit2Px({value:e.width.size,unit:e.width.unit||"px"}):d.SJ},getColumnFormat(t){const e=this.getEffectiveColumnSettings(t);if(e?.format)return e.format;const i=this.getColumnType(t),s={string:"text",multilineString:"text",integer:"number",number:"number",bigint:"number",percent:"percent",currency:"currency",date:"date",datetime:"datetime",time:"text"};return s[i]||"text"},getDefaultAlignment(t){const e=["integer","number","bigint","percent","currency","date","datetime","time"];return e.includes(t)?"right":"left"},getDefaultDecimals(t){return"integer"===t?0:"number"===t?2:"percent"===t?1:"currency"===t?2:0},getColumnType(t){if(this.isHierarchicalDimension(t)){const e=this.getDrilldownLevelForColumn(t),i=this.getHierarchicalLevelSettings(t,e);if(i?.type)return i.type}const e=this.props.columnSettings[t];if(e?.type)return e.type;const i=this.tableData.slice(0,10).map(e=>e[t]),s=(0,c.autoDetectColumnType)(i);return s},isHierarchicalDimension(t){return this.allDrilldownDimensions.includes(t)},getDrilldownLevelForColumn(t){if(!this.isHierarchicalDimension(t))return 0;if(null==this.$drilldown||null==this.$drilldown.state)return 0;const e=this.$drilldown.state[t],i=e?.filters||[];return i.length},getDrilldownFiltersForColumn(t){if(!this.isHierarchicalDimension(t))return[];if(null==this.$drilldown||null==this.$drilldown.state)return[];const e=this.$drilldown.state[t];return e?.filters||[]},getHierarchicalSettingsWithChildrenLevels(t){return this.props.hierarchicalSettings||{}},getHierarchicalLevelSettings(t,e){const i=this.props.hierarchicalSettings||{};return null==i[t]?null:i[t][e]||null},getEffectiveColumnSettings(t){if(this.isHierarchicalDimension(t)){const e=this.getDrilldownLevelForColumn(t),i=this.getHierarchicalLevelSettings(t,e);if(null!=i){const e=this.props.columnSettings[t]||{};return{...e,...i}}}return this.props.columnSettings[t]||{}},autoDetectAllColumnTypes(){if(0===this.tableData.length)return;const t={...this.props.columnSettings},e=[...this.props.dimensions||[],...this.props.metrics||[]];e.forEach(e=>{const i=t[e];if(null==i?.type){const i=this.tableData.slice(0,10).map(t=>t[e]),s=(0,c.autoDetectColumnType)(i);null==t[e]&&(t[e]={}),t[e].type=s}}),this.$set(this.props,"columnSettings",t),this.propChanged("columnSettings"),this.columnSettingsVersion++},runAutoDetectForAllColumns(){if(0===this.tableData.length)return;const t={...this.props.columnSettings},e=[...this.props.dimensions||[],...this.props.metrics||[]];e.forEach(e=>{const i=this.tableData.slice(0,10).map(t=>t[e]),s=(0,c.autoDetectColumnType)(i);null==t[e]&&(t[e]={}),t[e].type=s}),this.$set(this.props,"columnSettings",t),this.propChanged("columnSettings"),this.columnSettingsVersion++},syncColumnOrderToDimensionsAndMetrics(t){const e=this.props.dimensions||[],i=this.props.metrics||[],s=[],n=[];t.forEach(t=>{e.includes(t)?s.push(t):i.includes(t)&&n.push(t)}),this.$set(this.props,"dimensions",s),this.$set(this.props,"metrics",n),this.propChanged("dimensions"),this.propChanged("metrics")},detectSystemTheme(){if(window.matchMedia){const t=window.matchMedia("(prefers-color-scheme: dark)");this.isSystemPrefersDark=t.matches}},addSystemThemeListener(){if(window.matchMedia){const t=window.matchMedia("(prefers-color-scheme: dark)");this.systemThemeListener=t=>{this.isSystemPrefersDark=t.matches},t.addEventListener?t.addEventListener("change",this.systemThemeListener):t.addListener&&t.addListener(this.systemThemeListener)}},removeSystemThemeListener(){if(window.matchMedia&&this.systemThemeListener){const t=window.matchMedia("(prefers-color-scheme: dark)");t.removeEventListener?t.removeEventListener("change",this.systemThemeListener):t.removeListener&&t.removeListener(this.systemThemeListener)}}}},S=y;i(25971);var k=i(81656),F=(0,k.A)(S,s,n,!1,null,null,null);const x=F.exports}};