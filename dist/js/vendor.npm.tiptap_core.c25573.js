export const __webpack_id__=9232;export const __webpack_ids__=[9232];export const __webpack_modules__={90277:(t,e,n)=>{n.d(e,{AB:()=>hn,BQ:()=>Me,CU:()=>z,FF:()=>ge,JJ:()=>dn,KE:()=>sn,KV:()=>v,MG:()=>Oe,Nx:()=>ce,OX:()=>an,T7:()=>ie,YY:()=>q,Zc:()=>un,bP:()=>pn,eE:()=>vt,eL:()=>de,gk:()=>k,gu:()=>he,hO:()=>ve,iI:()=>h,iR:()=>Y,jT:()=>cn,q4:()=>pe,tG:()=>ln});var o=n(42845),r=n(1575),s=n(14413),i=n(42225),a=n(38262),c=n(46762),d=n(3772);function l(t){const{state:e,transaction:n}=t;let{selection:o}=n,{doc:r}=n,{storedMarks:s}=n;return{...e,apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),plugins:e.plugins,schema:e.schema,reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return s},get selection(){return o},get doc(){return r},get tr(){return o=n.selection,r=n.doc,s=n.storedMarks,n}}}class p{constructor(t){this.editor=t.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=t.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:t,editor:e,state:n}=this,{view:o}=e,{tr:r}=n,s=this.buildProps(r);return Object.fromEntries(Object.entries(t).map(([t,e])=>{const n=(...t)=>{const n=e(...t)(s);return r.getMeta("preventDispatch")||this.hasCustomState||o.dispatch(r),n};return[t,n]}))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(t,e=!0){const{rawCommands:n,editor:o,state:r}=this,{view:s}=o,i=[],a=!!t,c=t||r.tr,d=()=>(a||!e||c.getMeta("preventDispatch")||this.hasCustomState||s.dispatch(c),i.every(t=>!0===t)),l={...Object.fromEntries(Object.entries(n).map(([t,n])=>{const o=(...t)=>{const o=this.buildProps(c,e),r=n(...t)(o);return i.push(r),l};return[t,o]})),run:d};return l}createCan(t){const{rawCommands:e,state:n}=this,o=!1,r=t||n.tr,s=this.buildProps(r,o),i=Object.fromEntries(Object.entries(e).map(([t,e])=>[t,(...t)=>e(...t)({...s,dispatch:void 0})]));return{...i,chain:()=>this.createChain(r,o)}}buildProps(t,e=!0){const{rawCommands:n,editor:o,state:r}=this,{view:s}=o,i={tr:t,editor:o,view:s,state:l({state:r,transaction:t}),dispatch:e?()=>{}:void 0,chain:()=>this.createChain(t,e),can:()=>this.createCan(t),get commands(){return Object.fromEntries(Object.entries(n).map(([t,e])=>[t,(...t)=>e(...t)(i)]))}};return i}}class u{constructor(){this.callbacks={}}on(t,e){return this.callbacks[t]||(this.callbacks[t]=[]),this.callbacks[t].push(e),this}emit(t,...e){const n=this.callbacks[t];return n&&n.forEach(t=>t.apply(this,e)),this}off(t,e){const n=this.callbacks[t];return n&&(e?this.callbacks[t]=n.filter(t=>t!==e):delete this.callbacks[t]),this}once(t,e){const n=(...o)=>{this.off(t,n),e.apply(this,o)};return this.on(t,n)}removeAllListeners(){this.callbacks={}}}function h(t,e,n){if(void 0===t.config[e]&&t.parent)return h(t.parent,e,n);if("function"===typeof t.config[e]){const o=t.config[e].bind({...n,parent:t.parent?h(t.parent,e,n):null});return o}return t.config[e]}function m(t){const e=t.filter(t=>"extension"===t.type),n=t.filter(t=>"node"===t.type),o=t.filter(t=>"mark"===t.type);return{baseExtensions:e,nodeExtensions:n,markExtensions:o}}function f(t){const e=[],{nodeExtensions:n,markExtensions:o}=m(t),r=[...n,...o],s={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return t.forEach(t=>{const n={name:t.name,options:t.options,storage:t.storage,extensions:r},o=h(t,"addGlobalAttributes",n);if(!o)return;const i=o();i.forEach(t=>{t.types.forEach(n=>{Object.entries(t.attributes).forEach(([t,o])=>{e.push({type:n,name:t,attribute:{...s,...o}})})})})}),r.forEach(t=>{const n={name:t.name,options:t.options,storage:t.storage},o=h(t,"addAttributes",n);if(!o)return;const r=o();Object.entries(r).forEach(([n,o])=>{const r={...s,...o};"function"===typeof(null===r||void 0===r?void 0:r.default)&&(r.default=r.default()),(null===r||void 0===r?void 0:r.isRequired)&&void 0===(null===r||void 0===r?void 0:r.default)&&delete r.default,e.push({type:t.name,name:n,attribute:r})})}),e}function g(t,e){if("string"===typeof t){if(!e.nodes[t])throw Error(`There is no node type named '${t}'. Maybe you forgot to add the extension?`);return e.nodes[t]}return t}function v(...t){return t.filter(t=>!!t).reduce((t,e)=>{const n={...t};return Object.entries(e).forEach(([t,e])=>{const o=n[t];if(o)if("class"===t){const o=e?String(e).split(" "):[],r=n[t]?n[t].split(" "):[],s=o.filter(t=>!r.includes(t));n[t]=[...r,...s].join(" ")}else if("style"===t){const o=e?e.split(";").map(t=>t.trim()).filter(Boolean):[],r=n[t]?n[t].split(";").map(t=>t.trim()).filter(Boolean):[],s=new Map;r.forEach(t=>{const[e,n]=t.split(":").map(t=>t.trim());s.set(e,n)}),o.forEach(t=>{const[e,n]=t.split(":").map(t=>t.trim());s.set(e,n)}),n[t]=Array.from(s.entries()).map(([t,e])=>`${t}: ${e}`).join("; ")}else n[t]=e;else n[t]=e}),n},{})}function y(t,e){return e.filter(e=>e.type===t.type.name).filter(t=>t.attribute.rendered).map(e=>e.attribute.renderHTML?e.attribute.renderHTML(t.attrs)||{}:{[e.name]:t.attrs[e.name]}).reduce((t,e)=>v(t,e),{})}function b(t){return"function"===typeof t}function k(t,e=void 0,...n){return b(t)?e?t.bind(e)(...n):t(...n):t}function w(t={}){return 0===Object.keys(t).length&&t.constructor===Object}function x(t){return"string"!==typeof t?t:t.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(t):"true"===t||"false"!==t&&t}function M(t,e){return"style"in t?t:{...t,getAttrs:n=>{const o=t.getAttrs?t.getAttrs(n):t.attrs;if(!1===o)return!1;const r=e.reduce((t,e)=>{const o=e.attribute.parseHTML?e.attribute.parseHTML(n):x(n.getAttribute(e.name));return null===o||void 0===o?t:{...t,[e.name]:o}},{});return{...o,...r}}}}function O(t){return Object.fromEntries(Object.entries(t).filter(([t,e])=>("attrs"!==t||!w(e))&&(null!==e&&void 0!==e)))}function E(t,e){var n;const o=f(t),{nodeExtensions:r,markExtensions:s}=m(t),a=null===(n=r.find(t=>h(t,"topNode")))||void 0===n?void 0:n.name,c=Object.fromEntries(r.map(n=>{const r=o.filter(t=>t.type===n.name),s={name:n.name,options:n.options,storage:n.storage,editor:e},i=t.reduce((t,e)=>{const o=h(e,"extendNodeSchema",s);return{...t,...o?o(n):{}}},{}),a=O({...i,content:k(h(n,"content",s)),marks:k(h(n,"marks",s)),group:k(h(n,"group",s)),inline:k(h(n,"inline",s)),atom:k(h(n,"atom",s)),selectable:k(h(n,"selectable",s)),draggable:k(h(n,"draggable",s)),code:k(h(n,"code",s)),whitespace:k(h(n,"whitespace",s)),linebreakReplacement:k(h(n,"linebreakReplacement",s)),defining:k(h(n,"defining",s)),isolating:k(h(n,"isolating",s)),attrs:Object.fromEntries(r.map(t=>{var e;return[t.name,{default:null===(e=null===t||void 0===t?void 0:t.attribute)||void 0===e?void 0:e.default}]}))}),c=k(h(n,"parseHTML",s));c&&(a.parseDOM=c.map(t=>M(t,r)));const d=h(n,"renderHTML",s);d&&(a.toDOM=t=>d({node:t,HTMLAttributes:y(t,r)}));const l=h(n,"renderText",s);return l&&(a.toText=l),[n.name,a]})),d=Object.fromEntries(s.map(n=>{const r=o.filter(t=>t.type===n.name),s={name:n.name,options:n.options,storage:n.storage,editor:e},i=t.reduce((t,e)=>{const o=h(e,"extendMarkSchema",s);return{...t,...o?o(n):{}}},{}),a=O({...i,inclusive:k(h(n,"inclusive",s)),excludes:k(h(n,"excludes",s)),group:k(h(n,"group",s)),spanning:k(h(n,"spanning",s)),code:k(h(n,"code",s)),attrs:Object.fromEntries(r.map(t=>{var e;return[t.name,{default:null===(e=null===t||void 0===t?void 0:t.attribute)||void 0===e?void 0:e.default}]}))}),c=k(h(n,"parseHTML",s));c&&(a.parseDOM=c.map(t=>M(t,r)));const d=h(n,"renderHTML",s);return d&&(a.toDOM=t=>d({mark:t,HTMLAttributes:y(t,r)})),[n.name,a]}));return new i.Sj({topNode:a,nodes:c,marks:d})}function S(t,e){return e.nodes[t]||e.marks[t]||null}function C(t,e){return Array.isArray(e)?e.some(e=>{const n="string"===typeof e?e:e.name;return n===t.name}):e}function T(t,e){const n=i.ZF.fromSchema(e).serializeFragment(t),o=document.implementation.createHTMLDocument(),r=o.createElement("div");return r.appendChild(n),r.innerHTML}const P=(t,e=500)=>{let n="";const o=t.parentOffset;return t.parent.nodesBetween(Math.max(0,o-e),o,(t,e,r,s)=>{var i,a;const c=(null===(a=(i=t.type.spec).toText)||void 0===a?void 0:a.call(i,{node:t,pos:e,parent:r,index:s}))||t.textContent||"%leaf%";n+=t.isAtom&&!t.isText?c:c.slice(0,Math.max(0,o-e))}),n};function $(t){return"[object RegExp]"===Object.prototype.toString.call(t)}class A{constructor(t){this.find=t.find,this.handler=t.handler}}const j=(t,e)=>{if($(e))return e.exec(t);const n=e(t);if(!n)return null;const o=[n.text];return o.index=n.index,o.input=t,o.data=n.data,n.replaceWith&&(n.text.includes(n.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),o.push(n.replaceWith)),o};function N(t){var e;const{editor:n,from:o,to:r,text:s,rules:i,plugin:a}=t,{view:c}=n;if(c.composing)return!1;const d=c.state.doc.resolve(o);if(d.parent.type.spec.code||(null===(e=d.nodeBefore||d.nodeAfter)||void 0===e?void 0:e.marks.find(t=>t.type.spec.code)))return!1;let u=!1;const h=P(d)+s;return i.forEach(t=>{if(u)return;const e=j(h,t.find);if(!e)return;const i=c.state.tr,d=l({state:c.state,transaction:i}),m={from:o-(e[0].length-s.length),to:r},{commands:f,chain:g,can:v}=new p({editor:n,state:d}),y=t.handler({state:d,range:m,match:e,commands:f,chain:g,can:v});null!==y&&i.steps.length&&(i.setMeta(a,{transform:i,from:o,to:r,text:s}),c.dispatch(i),u=!0)}),u}function I(t){const{editor:e,rules:n}=t,r=new o.k_({state:{init(){return null},apply(t,o,s){const a=t.getMeta(r);if(a)return a;const c=t.getMeta("applyInputRules"),d=!!c;return d&&setTimeout(()=>{let{text:t}=c;"string"===typeof t||(t=T(i.FK.from(t),s.schema));const{from:o}=c,a=o+t.length;N({editor:e,from:o,to:a,text:t,rules:n,plugin:r})}),t.selectionSet||t.docChanged?null:o}},props:{handleTextInput(t,o,s,i){return N({editor:e,from:o,to:s,text:i,rules:n,plugin:r})},handleDOMEvents:{compositionend:t=>(setTimeout(()=>{const{$cursor:o}=t.state.selection;o&&N({editor:e,from:o.pos,to:o.pos,text:"",rules:n,plugin:r})}),!1)},handleKeyDown(t,o){if("Enter"!==o.key)return!1;const{$cursor:s}=t.state.selection;return!!s&&N({editor:e,from:s.pos,to:s.pos,text:"\n",rules:n,plugin:r})}},isInputRules:!0});return r}function B(t){return Object.prototype.toString.call(t).slice(8,-1)}function R(t){return"Object"===B(t)&&(t.constructor===Object&&Object.getPrototypeOf(t)===Object.prototype)}function D(t,e){const n={...t};return R(t)&&R(e)&&Object.keys(e).forEach(o=>{R(e[o])&&R(t[o])?n[o]=D(t[o],e[o]):n[o]=e[o]}),n}class z{constructor(t={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...t},this.name=this.config.name,t.defaultOptions&&Object.keys(t.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=k(h(this,"addOptions",{name:this.name}))),this.storage=k(h(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new z(t)}configure(t={}){const e=this.extend({...this.config,addOptions:()=>D(this.options,t)});return e.name=this.name,e.parent=this.parent,e}extend(t={}){const e=new z(t);return e.parent=this,this.child=e,e.name=t.name?t.name:e.parent.name,t.defaultOptions&&Object.keys(t.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${e.name}".`),e.options=k(h(e,"addOptions",{name:e.name})),e.storage=k(h(e,"addStorage",{name:e.name,options:e.options})),e}static handleExit({editor:t,mark:e}){const{tr:n}=t.state,o=t.state.selection.$from,r=o.pos===o.end();if(r){const r=o.marks(),s=!!r.find(t=>(null===t||void 0===t?void 0:t.type.name)===e.name);if(!s)return!1;const i=r.find(t=>(null===t||void 0===t?void 0:t.type.name)===e.name);return i&&n.removeStoredMark(i),n.insertText(" ",o.pos),t.view.dispatch(n),!0}return!1}}function L(t){return"number"===typeof t}class _{constructor(t){this.find=t.find,this.handler=t.handler}}const F=(t,e,n)=>{if($(e))return[...t.matchAll(e)];const o=e(t,n);return o?o.map(e=>{const n=[e.text];return n.index=e.index,n.input=t,n.data=e.data,e.replaceWith&&(e.text.includes(e.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),n.push(e.replaceWith)),n}):[]};function H(t){const{editor:e,state:n,from:o,to:r,rule:s,pasteEvent:i,dropEvent:a}=t,{commands:c,chain:d,can:l}=new p({editor:e,state:n}),u=[];n.doc.nodesBetween(o,r,(t,e)=>{if(!t.isTextblock||t.type.spec.code)return;const p=Math.max(o,e),h=Math.min(r,e+t.content.size),m=t.textBetween(p-e,h-e,void 0,"￼"),f=F(m,s.find,i);f.forEach(t=>{if(void 0===t.index)return;const e=p+t.index+1,o=e+t[0].length,r={from:n.tr.mapping.map(e),to:n.tr.mapping.map(o)},h=s.handler({state:n,range:r,match:t,commands:c,chain:d,can:l,pasteEvent:i,dropEvent:a});u.push(h)})});const h=u.every(t=>null!==t);return h}let K=null;const U=t=>{var e;const n=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return null===(e=n.clipboardData)||void 0===e||e.setData("text/html",t),n};function V(t){const{editor:e,rules:n}=t;let r,s=null,a=!1,c=!1,d="undefined"!==typeof ClipboardEvent?new ClipboardEvent("paste"):null;try{r="undefined"!==typeof DragEvent?new DragEvent("drop"):null}catch{r=null}const p=({state:t,from:n,to:o,rule:s,pasteEvt:i})=>{const a=t.tr,c=l({state:t,transaction:a}),p=H({editor:e,state:c,from:Math.max(n-1,0),to:o.b-1,rule:s,pasteEvent:i,dropEvent:r});if(p&&a.steps.length){try{r="undefined"!==typeof DragEvent?new DragEvent("drop"):null}catch{r=null}return d="undefined"!==typeof ClipboardEvent?new ClipboardEvent("paste"):null,a}},u=n.map(t=>new o.k_({view(t){const n=n=>{var o;s=(null===(o=t.dom.parentElement)||void 0===o?void 0:o.contains(n.target))?t.dom.parentElement:null,s&&(K=e)},o=()=>{K&&(K=null)};return window.addEventListener("dragstart",n),window.addEventListener("dragend",o),{destroy(){window.removeEventListener("dragstart",n),window.removeEventListener("dragend",o)}}},props:{handleDOMEvents:{drop:(t,e)=>{if(c=s===t.dom.parentElement,r=e,!c){const t=K;(null===t||void 0===t?void 0:t.isEditable)&&setTimeout(()=>{const e=t.state.selection;e&&t.commands.deleteRange({from:e.from,to:e.to})},10)}return!1},paste:(t,e)=>{var n;const o=null===(n=e.clipboardData)||void 0===n?void 0:n.getData("text/html");return d=e,a=!!(null===o||void 0===o?void 0:o.includes("data-pm-slice")),!1}}},appendTransaction:(e,n,o)=>{const r=e[0],s="paste"===r.getMeta("uiEvent")&&!a,l="drop"===r.getMeta("uiEvent")&&!c,u=r.getMeta("applyPasteRules"),h=!!u;if(!s&&!l&&!h)return;if(h){let{text:e}=u;"string"===typeof e||(e=T(i.FK.from(e),o.schema));const{from:n}=u,r=n+e.length,s=U(e);return p({rule:t,state:o,from:n,to:{b:r},pasteEvt:s})}const m=n.doc.content.findDiffStart(o.doc.content),f=n.doc.content.findDiffEnd(o.doc.content);return L(m)&&f&&m!==f.b?p({rule:t,state:o,from:m,to:f,pasteEvt:d}):void 0}}));return u}function W(t){const e=t.filter((e,n)=>t.indexOf(e)!==n);return Array.from(new Set(e))}class G{constructor(t,e){this.splittableMarks=[],this.editor=e,this.extensions=G.resolve(t),this.schema=E(this.extensions,e),this.setupExtensions()}static resolve(t){const e=G.sort(G.flatten(t)),n=W(e.map(t=>t.name));return n.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${n.map(t=>`'${t}'`).join(", ")}]. This can lead to issues.`),e}static flatten(t){return t.map(t=>{const e={name:t.name,options:t.options,storage:t.storage},n=h(t,"addExtensions",e);return n?[t,...this.flatten(n())]:t}).flat(10)}static sort(t){const e=100;return t.sort((t,n)=>{const o=h(t,"priority")||e,r=h(n,"priority")||e;return o>r?-1:o<r?1:0})}get commands(){return this.extensions.reduce((t,e)=>{const n={name:e.name,options:e.options,storage:e.storage,editor:this.editor,type:S(e.name,this.schema)},o=h(e,"addCommands",n);return o?{...t,...o()}:t},{})}get plugins(){const{editor:t}=this,e=G.sort([...this.extensions].reverse()),n=[],o=[],r=e.map(e=>{const r={name:e.name,options:e.options,storage:e.storage,editor:t,type:S(e.name,this.schema)},i=[],a=h(e,"addKeyboardShortcuts",r);let c={};if("mark"===e.type&&h(e,"exitable",r)&&(c.ArrowRight=()=>z.handleExit({editor:t,mark:e})),a){const e=Object.fromEntries(Object.entries(a()).map(([e,n])=>[e,()=>n({editor:t})]));c={...c,...e}}const d=(0,s.w)(c);i.push(d);const l=h(e,"addInputRules",r);C(e,t.options.enableInputRules)&&l&&n.push(...l());const p=h(e,"addPasteRules",r);C(e,t.options.enablePasteRules)&&p&&o.push(...p());const u=h(e,"addProseMirrorPlugins",r);if(u){const t=u();i.push(...t)}return i}).flat();return[I({editor:t,rules:n}),...V({editor:t,rules:o}),...r]}get attributes(){return f(this.extensions)}get nodeViews(){const{editor:t}=this,{nodeExtensions:e}=m(this.extensions);return Object.fromEntries(e.filter(t=>!!h(t,"addNodeView")).map(e=>{const n=this.attributes.filter(t=>t.type===e.name),o={name:e.name,options:e.options,storage:e.storage,editor:t,type:g(e.name,this.schema)},r=h(e,"addNodeView",o);if(!r)return[];const s=(o,s,i,a,c)=>{const d=y(o,n);return r()({node:o,view:s,getPos:i,decorations:a,innerDecorations:c,editor:t,extension:e,HTMLAttributes:d})};return[e.name,s]}))}setupExtensions(){this.extensions.forEach(t=>{var e;this.editor.extensionStorage[t.name]=t.storage;const n={name:t.name,options:t.options,storage:t.storage,editor:this.editor,type:S(t.name,this.schema)};if("mark"===t.type){const o=null===(e=k(h(t,"keepOnSplit",n)))||void 0===e||e;o&&this.splittableMarks.push(t.name)}const o=h(t,"onBeforeCreate",n),r=h(t,"onCreate",n),s=h(t,"onUpdate",n),i=h(t,"onSelectionUpdate",n),a=h(t,"onTransaction",n),c=h(t,"onFocus",n),d=h(t,"onBlur",n),l=h(t,"onDestroy",n);o&&this.editor.on("beforeCreate",o),r&&this.editor.on("create",r),s&&this.editor.on("update",s),i&&this.editor.on("selectionUpdate",i),a&&this.editor.on("transaction",a),c&&this.editor.on("focus",c),d&&this.editor.on("blur",d),l&&this.editor.on("destroy",l)})}}class q{constructor(t={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...t},this.name=this.config.name,t.defaultOptions&&Object.keys(t.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=k(h(this,"addOptions",{name:this.name}))),this.storage=k(h(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new q(t)}configure(t={}){const e=this.extend({...this.config,addOptions:()=>D(this.options,t)});return e.name=this.name,e.parent=this.parent,e}extend(t={}){const e=new q({...this.config,...t});return e.parent=this,this.child=e,e.name=t.name?t.name:e.parent.name,t.defaultOptions&&Object.keys(t.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${e.name}".`),e.options=k(h(e,"addOptions",{name:e.name})),e.storage=k(h(e,"addStorage",{name:e.name,options:e.options})),e}}function J(t,e,n){const{from:o,to:r}=e,{blockSeparator:s="\n\n",textSerializers:i={}}=n||{};let a="";return t.nodesBetween(o,r,(t,n,c,d)=>{var l;t.isBlock&&n>o&&(a+=s);const p=null===i||void 0===i?void 0:i[t.type.name];if(p)return c&&(a+=p({node:t,pos:n,parent:c,index:d,range:e})),!1;t.isText&&(a+=null===(l=null===t||void 0===t?void 0:t.text)||void 0===l?void 0:l.slice(Math.max(o,n)-n,r-n))}),a}function Y(t){return Object.fromEntries(Object.entries(t.nodes).filter(([,t])=>t.spec.toText).map(([t,e])=>[t,e.spec.toText]))}const Z=q.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new o.k_({key:new o.hs("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:t}=this,{state:e,schema:n}=t,{doc:o,selection:r}=e,{ranges:s}=r,i=Math.min(...s.map(t=>t.$from.pos)),a=Math.max(...s.map(t=>t.$to.pos)),c=Y(n),d={from:i,to:a};return J(o,d,{...void 0!==this.options.blockSeparator?{blockSeparator:this.options.blockSeparator}:{},textSerializers:c})}}})]}}),Q=()=>({editor:t,view:e})=>(requestAnimationFrame(()=>{var n;t.isDestroyed||(e.dom.blur(),null===(n=null===window||void 0===window?void 0:window.getSelection())||void 0===n||n.removeAllRanges())}),!0),X=(t=!1)=>({commands:e})=>e.setContent("",t),tt=()=>({state:t,tr:e,dispatch:n})=>{const{selection:o}=e,{ranges:r}=o;return!n||(r.forEach(({$from:n,$to:o})=>{t.doc.nodesBetween(n.pos,o.pos,(t,n)=>{if(t.type.isText)return;const{doc:o,mapping:r}=e,s=o.resolve(r.map(n)),i=o.resolve(r.map(n+t.nodeSize)),c=s.blockRange(i);if(!c)return;const d=(0,a.jP)(c);if(t.type.isTextblock){const{defaultType:t}=s.parent.contentMatchAt(s.index());e.setNodeMarkup(c.start,t)}(d||0===d)&&e.lift(c,d)})}),!0)},et=t=>e=>t(e),nt=()=>({state:t,dispatch:e})=>(0,c.Z1)(t,e),ot=(t,e)=>({editor:n,tr:r})=>{const{state:s}=n,i=s.doc.slice(t.from,t.to);r.deleteRange(t.from,t.to);const a=r.mapping.map(e);return r.insert(a,i.content),r.setSelection(new o.U3(r.doc.resolve(Math.max(a-1,0)))),!0},rt=()=>({tr:t,dispatch:e})=>{const{selection:n}=t,o=n.$anchor.node();if(o.content.size>0)return!1;const r=t.selection.$anchor;for(let s=r.depth;s>0;s-=1){const n=r.node(s);if(n.type===o.type){if(e){const e=r.before(s),n=r.after(s);t.delete(e,n).scrollIntoView()}return!0}}return!1},st=t=>({tr:e,state:n,dispatch:o})=>{const r=g(t,n.schema),s=e.selection.$anchor;for(let t=s.depth;t>0;t-=1){const n=s.node(t);if(n.type===r){if(o){const n=s.before(t),o=s.after(t);e.delete(n,o).scrollIntoView()}return!0}}return!1},it=t=>({tr:e,dispatch:n})=>{const{from:o,to:r}=t;return n&&e.delete(o,r),!0},at=()=>({state:t,dispatch:e})=>(0,c.ic)(t,e),ct=()=>({commands:t})=>t.keyboardShortcut("Enter"),dt=()=>({state:t,dispatch:e})=>(0,c.I$)(t,e);function lt(t,e,n={strict:!0}){const o=Object.keys(e);return!o.length||o.every(o=>n.strict?e[o]===t[o]:$(e[o])?e[o].test(t[o]):e[o]===t[o])}function pt(t,e,n={}){return t.find(t=>t.type===e&&lt(Object.fromEntries(Object.keys(n).map(e=>[e,t.attrs[e]])),n))}function ut(t,e,n={}){return!!pt(t,e,n)}function ht(t,e,n){var o;if(!t||!e)return;let r=t.parent.childAfter(t.parentOffset);if(r.node&&r.node.marks.some(t=>t.type===e)||(r=t.parent.childBefore(t.parentOffset)),!r.node||!r.node.marks.some(t=>t.type===e))return;n=n||(null===(o=r.node.marks[0])||void 0===o?void 0:o.attrs);const s=pt([...r.node.marks],e,n);if(!s)return;let i=r.index,a=t.start()+r.offset,c=i+1,d=a+r.node.nodeSize;while(i>0&&ut([...t.parent.child(i-1).marks],e,n))i-=1,a-=t.parent.child(i).nodeSize;while(c<t.parent.childCount&&ut([...t.parent.child(c).marks],e,n))d+=t.parent.child(c).nodeSize,c+=1;return{from:a,to:d}}function mt(t,e){if("string"===typeof t){if(!e.marks[t])throw Error(`There is no mark type named '${t}'. Maybe you forgot to add the extension?`);return e.marks[t]}return t}const ft=(t,e={})=>({tr:n,state:r,dispatch:s})=>{const i=mt(t,r.schema),{doc:a,selection:c}=n,{$from:d,from:l,to:p}=c;if(s){const t=ht(d,i,e);if(t&&t.from<=l&&t.to>=p){const e=o.U3.create(a,t.from,t.to);n.setSelection(e)}}return!0},gt=t=>e=>{const n="function"===typeof t?t(e):t;for(let t=0;t<n.length;t+=1)if(n[t](e))return!0;return!1};function vt(t){return t instanceof o.U3}function yt(t=0,e=0,n=0){return Math.min(Math.max(t,e),n)}function bt(t,e=null){if(!e)return null;const n=o.LN.atStart(t),r=o.LN.atEnd(t);if("start"===e||!0===e)return n;if("end"===e)return r;const s=n.from,i=r.to;return"all"===e?o.U3.create(t,yt(0,s,i),yt(t.content.size,s,i)):o.U3.create(t,yt(e,s,i),yt(e,s,i))}function kt(){return"Android"===navigator.platform||/android/i.test(navigator.userAgent)}function wt(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}const xt=(t=null,e={})=>({editor:n,view:o,tr:r,dispatch:s})=>{e={scrollIntoView:!0,...e};const i=()=>{(wt()||kt())&&o.dom.focus(),requestAnimationFrame(()=>{n.isDestroyed||(o.focus(),(null===e||void 0===e?void 0:e.scrollIntoView)&&n.commands.scrollIntoView())})};if(o.hasFocus()&&null===t||!1===t)return!0;if(s&&null===t&&!vt(n.state.selection))return i(),!0;const a=bt(r.doc,t)||n.state.selection,c=n.state.selection.eq(a);return s&&(c||r.setSelection(a),c&&r.storedMarks&&r.setStoredMarks(r.storedMarks),i()),!0},Mt=(t,e)=>n=>t.every((t,o)=>e(t,{...n,index:o})),Ot=(t,e)=>({tr:n,commands:o})=>o.insertContentAt({from:n.selection.from,to:n.selection.to},t,e),Et=t=>{const e=t.childNodes;for(let n=e.length-1;n>=0;n-=1){const o=e[n];3===o.nodeType&&o.nodeValue&&/^(\n\s\s|\n)$/.test(o.nodeValue)?t.removeChild(o):1===o.nodeType&&Et(o)}return t};function St(t){const e=`<body>${t}</body>`,n=(new window.DOMParser).parseFromString(e,"text/html").body;return Et(n)}function Ct(t,e,n){if(t instanceof i.bP||t instanceof i.FK)return t;n={slice:!0,parseOptions:{},...n};const o="object"===typeof t&&null!==t,r="string"===typeof t;if(o)try{const o=Array.isArray(t)&&t.length>0;if(o)return i.FK.fromArray(t.map(t=>e.nodeFromJSON(t)));const r=e.nodeFromJSON(t);return n.errorOnInvalidContent&&r.check(),r}catch(s){if(n.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:s});return console.warn("[tiptap warn]: Invalid content.","Passed value:",t,"Error:",s),Ct("",e,n)}if(r){if(n.errorOnInvalidContent){let o=!1,r="";const s=new i.Sj({topNode:e.spec.topNode,marks:e.spec.marks,nodes:e.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:t=>(o=!0,r="string"===typeof t?t:t.outerHTML,null)}]}})});if(n.slice?i.S4.fromSchema(s).parseSlice(St(t),n.parseOptions):i.S4.fromSchema(s).parse(St(t),n.parseOptions),n.errorOnInvalidContent&&o)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${r}`)})}const o=i.S4.fromSchema(e);return n.slice?o.parseSlice(St(t),n.parseOptions).content:o.parse(St(t),n.parseOptions)}return Ct("",e,n)}function Tt(t,e,n){const r=t.steps.length-1;if(r<e)return;const s=t.steps[r];if(!(s instanceof a.Ln||s instanceof a.Wg))return;const i=t.mapping.maps[r];let c=0;i.forEach((t,e,n,o)=>{0===c&&(c=o)}),t.setSelection(o.LN.near(t.doc.resolve(c),n))}const Pt=t=>!("type"in t),$t=(t,e,n)=>({tr:o,dispatch:r,editor:s})=>{var a;if(r){let r;n={parseOptions:s.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...n};const d=t=>{s.emit("contentError",{editor:s,error:t,disableCollaboration:()=>{s.storage.collaboration&&(s.storage.collaboration.isDisabled=!0)}})},l={preserveWhitespace:"full",...n.parseOptions};if(!n.errorOnInvalidContent&&!s.options.enableContentCheck&&s.options.emitContentError)try{Ct(e,s.schema,{parseOptions:l,errorOnInvalidContent:!0})}catch(c){d(c)}try{r=Ct(e,s.schema,{parseOptions:l,errorOnInvalidContent:null!==(a=n.errorOnInvalidContent)&&void 0!==a?a:s.options.enableContentCheck})}catch(c){return d(c),!1}let{from:p,to:u}="number"===typeof t?{from:t,to:t}:{from:t.from,to:t.to},h=!0,m=!0;const f=Pt(r)?r:[r];if(f.forEach(t=>{t.check(),h=!!h&&(t.isText&&0===t.marks.length),m=!!m&&t.isBlock}),p===u&&m){const{parent:t}=o.doc.resolve(p),e=t.isTextblock&&!t.type.spec.code&&!t.childCount;e&&(p-=1,u+=1)}let g;if(h){if(Array.isArray(e))g=e.map(t=>t.text||"").join("");else if(e instanceof i.FK){let t="";e.forEach(e=>{e.text&&(t+=e.text)}),g=t}else g="object"===typeof e&&e&&e.text?e.text:e;o.insertText(g,p,u)}else g=r,o.replaceWith(p,u,g);n.updateSelection&&Tt(o,o.steps.length-1,-1),n.applyInputRules&&o.setMeta("applyInputRules",{from:p,text:g}),n.applyPasteRules&&o.setMeta("applyPasteRules",{from:p,text:g})}return!0},At=()=>({state:t,dispatch:e})=>(0,c.G2)(t,e),jt=()=>({state:t,dispatch:e})=>(0,c.bh)(t,e),Nt=()=>({state:t,dispatch:e})=>(0,c.Qv)(t,e),It=()=>({state:t,dispatch:e})=>(0,c.eT)(t,e),Bt=()=>({state:t,dispatch:e,tr:n})=>{try{const o=(0,a.N0)(t.doc,t.selection.$from.pos,-1);return null!==o&&void 0!==o&&(n.join(o,2),e&&e(n),!0)}catch{return!1}},Rt=()=>({state:t,dispatch:e,tr:n})=>{try{const o=(0,a.N0)(t.doc,t.selection.$from.pos,1);return null!==o&&void 0!==o&&(n.join(o,2),e&&e(n),!0)}catch{return!1}},Dt=()=>({state:t,dispatch:e})=>(0,c.eB)(t,e),zt=()=>({state:t,dispatch:e})=>(0,c._G)(t,e);function Lt(){return"undefined"!==typeof navigator&&/Mac/.test(navigator.platform)}function _t(t){const e=t.split(/-(?!$)/);let n,o,r,s,i=e[e.length-1];"Space"===i&&(i=" ");for(let a=0;a<e.length-1;a+=1){const t=e[a];if(/^(cmd|meta|m)$/i.test(t))s=!0;else if(/^a(lt)?$/i.test(t))n=!0;else if(/^(c|ctrl|control)$/i.test(t))o=!0;else if(/^s(hift)?$/i.test(t))r=!0;else{if(!/^mod$/i.test(t))throw new Error(`Unrecognized modifier name: ${t}`);wt()||Lt()?s=!0:o=!0}}return n&&(i=`Alt-${i}`),o&&(i=`Ctrl-${i}`),s&&(i=`Meta-${i}`),r&&(i=`Shift-${i}`),i}const Ft=t=>({editor:e,view:n,tr:o,dispatch:r})=>{const s=_t(t).split(/-(?!$)/),i=s.find(t=>!["Alt","Ctrl","Meta","Shift"].includes(t)),a=new KeyboardEvent("keydown",{key:"Space"===i?" ":i,altKey:s.includes("Alt"),ctrlKey:s.includes("Ctrl"),metaKey:s.includes("Meta"),shiftKey:s.includes("Shift"),bubbles:!0,cancelable:!0}),c=e.captureTransaction(()=>{n.someProp("handleKeyDown",t=>t(n,a))});return null===c||void 0===c||c.steps.forEach(t=>{const e=t.map(o.mapping);e&&r&&o.maybeStep(e)}),!0};function Ht(t,e,n={}){const{from:o,to:r,empty:s}=t.selection,i=e?g(e,t.schema):null,a=[];t.doc.nodesBetween(o,r,(t,e)=>{if(t.isText)return;const n=Math.max(o,e),s=Math.min(r,e+t.nodeSize);a.push({node:t,from:n,to:s})});const c=r-o,d=a.filter(t=>!i||i.name===t.node.type.name).filter(t=>lt(t.node.attrs,n,{strict:!1}));if(s)return!!d.length;const l=d.reduce((t,e)=>t+e.to-e.from,0);return l>=c}const Kt=(t,e={})=>({state:n,dispatch:o})=>{const r=g(t,n.schema),s=Ht(n,r,e);return!!s&&(0,c.yY)(n,o)},Ut=()=>({state:t,dispatch:e})=>(0,c.iz)(t,e),Vt=t=>({state:e,dispatch:n})=>{const o=g(t,e.schema);return(0,d.T2)(o)(e,n)},Wt=()=>({state:t,dispatch:e})=>(0,c.pC)(t,e);function Gt(t,e){return e.nodes[t]?"node":e.marks[t]?"mark":null}function qt(t,e){const n="string"===typeof e?[e]:e;return Object.keys(t).reduce((e,o)=>(n.includes(o)||(e[o]=t[o]),e),{})}const Jt=(t,e)=>({tr:n,state:o,dispatch:r})=>{let s=null,i=null;const a=Gt("string"===typeof t?t:t.name,o.schema);return!!a&&("node"===a&&(s=g(t,o.schema)),"mark"===a&&(i=mt(t,o.schema)),r&&n.selection.ranges.forEach(t=>{o.doc.nodesBetween(t.$from.pos,t.$to.pos,(t,o)=>{s&&s===t.type&&n.setNodeMarkup(o,void 0,qt(t.attrs,e)),i&&t.marks.length&&t.marks.forEach(r=>{i===r.type&&n.addMark(o,o+t.nodeSize,i.create(qt(r.attrs,e)))})})}),!0)},Yt=()=>({tr:t,dispatch:e})=>(e&&t.scrollIntoView(),!0),Zt=()=>({tr:t,dispatch:e})=>{if(e){const e=new o.i5(t.doc);t.setSelection(e)}return!0},Qt=()=>({state:t,dispatch:e})=>(0,c._e)(t,e),Xt=()=>({state:t,dispatch:e})=>(0,c.Sd)(t,e),te=()=>({state:t,dispatch:e})=>(0,c.hy)(t,e),ee=()=>({state:t,dispatch:e})=>(0,c.ec)(t,e),ne=()=>({state:t,dispatch:e})=>(0,c.$f)(t,e);function oe(t,e,n={},o={}){return Ct(t,e,{slice:!1,parseOptions:n,errorOnInvalidContent:o.errorOnInvalidContent})}const re=(t,e=!1,n={},o={})=>({editor:r,tr:s,dispatch:i,commands:a})=>{var c,d;const{doc:l}=s;if("full"!==n.preserveWhitespace){const a=oe(t,r.schema,n,{errorOnInvalidContent:null!==(c=o.errorOnInvalidContent)&&void 0!==c?c:r.options.enableContentCheck});return i&&s.replaceWith(0,l.content.size,a).setMeta("preventUpdate",!e),!0}return i&&s.setMeta("preventUpdate",!e),a.insertContentAt({from:0,to:l.content.size},t,{parseOptions:n,errorOnInvalidContent:null!==(d=o.errorOnInvalidContent)&&void 0!==d?d:r.options.enableContentCheck})};function se(t,e){const n=mt(e,t.schema),{from:o,to:r,empty:s}=t.selection,i=[];s?(t.storedMarks&&i.push(...t.storedMarks),i.push(...t.selection.$head.marks())):t.doc.nodesBetween(o,r,t=>{i.push(...t.marks)});const a=i.find(t=>t.type.name===n.name);return a?{...a.attrs}:{}}function ie(t,e){const n=new a.dL(t);return e.forEach(t=>{t.steps.forEach(t=>{n.step(t)})}),n}function ae(t){for(let e=0;e<t.edgeCount;e+=1){const{type:n}=t.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}function ce(t,e,n){const o=[];return t.nodesBetween(e.from,e.to,(t,e)=>{n(t)&&o.push({node:t,pos:e})}),o}function de(t,e){for(let n=t.depth;n>0;n-=1){const o=t.node(n);if(e(o))return{pos:n>0?t.before(n):0,start:t.start(n),depth:n,node:o}}}function le(t){return e=>de(e.$from,t)}function pe(t,e){const n={from:0,to:t.content.size};return J(t,n,e)}function ue(t,e){const n=g(e,t.schema),{from:o,to:r}=t.selection,s=[];t.doc.nodesBetween(o,r,t=>{s.push(t)});const i=s.reverse().find(t=>t.type.name===n.name);return i?{...i.attrs}:{}}function he(t,e){const n=Gt("string"===typeof e?e:e.name,t.schema);return"node"===n?ue(t,e):"mark"===n?se(t,e):{}}function me(t,e=JSON.stringify){const n={};return t.filter(t=>{const o=e(t);return!Object.prototype.hasOwnProperty.call(n,o)&&(n[o]=!0)})}function fe(t){const e=me(t);return 1===e.length?e:e.filter((t,n)=>{const o=e.filter((t,e)=>e!==n);return!o.some(e=>t.oldRange.from>=e.oldRange.from&&t.oldRange.to<=e.oldRange.to&&t.newRange.from>=e.newRange.from&&t.newRange.to<=e.newRange.to)})}function ge(t){const{mapping:e,steps:n}=t,o=[];return e.maps.forEach((t,r)=>{const s=[];if(t.ranges.length)t.forEach((t,e)=>{s.push({from:t,to:e})});else{const{from:t,to:e}=n[r];if(void 0===t||void 0===e)return;s.push({from:t,to:e})}s.forEach(({from:t,to:n})=>{const s=e.slice(r).map(t,-1),i=e.slice(r).map(n),a=e.invert().map(s,-1),c=e.invert().map(i);o.push({oldRange:{from:a,to:c},newRange:{from:s,to:i}})})}),fe(o)}function ve(t,e,n){const o=[];return t===e?n.resolve(t).marks().forEach(e=>{const r=n.resolve(t),s=ht(r,e.type);s&&o.push({mark:e,...s})}):n.nodesBetween(t,e,(t,e)=>{t&&void 0!==(null===t||void 0===t?void 0:t.nodeSize)&&o.push(...t.marks.map(n=>({from:e,to:e+t.nodeSize,mark:n})))}),o}function ye(t,e,n){return Object.fromEntries(Object.entries(n).filter(([n])=>{const o=t.find(t=>t.type===e&&t.name===n);return!!o&&o.attribute.keepOnSplit}))}function be(t,e,n={}){const{empty:o,ranges:r}=t.selection,s=e?mt(e,t.schema):null;if(o)return!!(t.storedMarks||t.selection.$from.marks()).filter(t=>!s||s.name===t.type.name).find(t=>lt(t.attrs,n,{strict:!1}));let i=0;const a=[];if(r.forEach(({$from:e,$to:n})=>{const o=e.pos,r=n.pos;t.doc.nodesBetween(o,r,(t,e)=>{if(!t.isText&&!t.marks.length)return;const n=Math.max(o,e),s=Math.min(r,e+t.nodeSize),c=s-n;i+=c,a.push(...t.marks.map(t=>({mark:t,from:n,to:s})))})}),0===i)return!1;const c=a.filter(t=>!s||s.name===t.mark.type.name).filter(t=>lt(t.mark.attrs,n,{strict:!1})).reduce((t,e)=>t+e.to-e.from,0),d=a.filter(t=>!s||t.mark.type!==s&&t.mark.type.excludes(s)).reduce((t,e)=>t+e.to-e.from,0),l=c>0?c+d:c;return l>=i}function ke(t,e,n={}){if(!e)return Ht(t,null,n)||be(t,null,n);const o=Gt(e,t.schema);return"node"===o?Ht(t,e,n):"mark"===o&&be(t,e,n)}function we(t,e){const{nodeExtensions:n}=m(e),o=n.find(e=>e.name===t);if(!o)return!1;const r={name:o.name,options:o.options,storage:o.storage},s=k(h(o,"group",r));return"string"===typeof s&&s.split(" ").includes("list")}function xe(t,{checkChildren:e=!0,ignoreWhitespace:n=!1}={}){var o;if(n){if("hardBreak"===t.type.name)return!0;if(t.isText)return/^\s*$/m.test(null!==(o=t.text)&&void 0!==o?o:"")}if(t.isText)return!t.text;if(t.isAtom||t.isLeaf)return!1;if(0===t.content.childCount)return!0;if(e){let o=!0;return t.content.forEach(t=>{!1!==o&&(xe(t,{ignoreWhitespace:n,checkChildren:e})||(o=!1))}),o}return!1}function Me(t){return t instanceof o.nh}function Oe(t,e,n){const o=0,r=t.state.doc.content.size,s=yt(e,o,r),i=yt(n,o,r),a=t.coordsAtPos(s),c=t.coordsAtPos(i,-1),d=Math.min(a.top,c.top),l=Math.max(a.bottom,c.bottom),p=Math.min(a.left,c.left),u=Math.max(a.right,c.right),h=u-p,m=l-d,f=p,g=d,v={top:d,bottom:l,left:p,right:u,width:h,height:m,x:f,y:g};return{...v,toJSON:()=>v}}function Ee(t,e,n){var o;const{selection:r}=e;let s=null;if(vt(r)&&(s=r.$cursor),s){const e=null!==(o=t.storedMarks)&&void 0!==o?o:s.marks();return!!n.isInSet(e)||!e.some(t=>t.type.excludes(n))}const{ranges:i}=r;return i.some(({$from:e,$to:o})=>{let r=0===e.depth&&(t.doc.inlineContent&&t.doc.type.allowsMarkType(n));return t.doc.nodesBetween(e.pos,o.pos,(t,e,o)=>{if(r)return!1;if(t.isInline){const e=!o||o.type.allowsMarkType(n),s=!!n.isInSet(t.marks)||!t.marks.some(t=>t.type.excludes(n));r=e&&s}return!r}),r})}const Se=(t,e={})=>({tr:n,state:o,dispatch:r})=>{const{selection:s}=n,{empty:i,ranges:a}=s,c=mt(t,o.schema);if(r)if(i){const t=se(o,c);n.addStoredMark(c.create({...t,...e}))}else a.forEach(t=>{const r=t.$from.pos,s=t.$to.pos;o.doc.nodesBetween(r,s,(t,o)=>{const i=Math.max(o,r),a=Math.min(o+t.nodeSize,s),d=t.marks.find(t=>t.type===c);d?t.marks.forEach(t=>{c===t.type&&n.addMark(i,a,c.create({...t.attrs,...e}))}):n.addMark(i,a,c.create(e))})});return Ee(o,n,c)},Ce=(t,e)=>({tr:n})=>(n.setMeta(t,e),!0),Te=(t,e={})=>({state:n,dispatch:o,chain:r})=>{const s=g(t,n.schema);let i;return n.selection.$anchor.sameParent(n.selection.$head)&&(i=n.selection.$anchor.parent.attrs),s.isTextblock?r().command(({commands:t})=>{const o=(0,c.y_)(s,{...i,...e})(n);return!!o||t.clearNodes()}).command(({state:t})=>(0,c.y_)(s,{...i,...e})(t,o)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},Pe=t=>({tr:e,dispatch:n})=>{if(n){const{doc:n}=e,r=yt(t,0,n.content.size),s=o.nh.create(n,r);e.setSelection(s)}return!0},$e=t=>({tr:e,dispatch:n})=>{if(n){const{doc:n}=e,{from:r,to:s}="number"===typeof t?{from:t,to:t}:t,i=o.U3.atStart(n).from,a=o.U3.atEnd(n).to,c=yt(r,i,a),d=yt(s,i,a),l=o.U3.create(n,c,d);e.setSelection(l)}return!0},Ae=t=>({state:e,dispatch:n})=>{const o=g(t,e.schema);return(0,d.$B)(o)(e,n)};function je(t,e){const n=t.storedMarks||t.selection.$to.parentOffset&&t.selection.$from.marks();if(n){const o=n.filter(t=>null===e||void 0===e?void 0:e.includes(t.type.name));t.tr.ensureMarks(o)}}const Ne=({keepMarks:t=!0}={})=>({tr:e,state:n,dispatch:r,editor:s})=>{const{selection:i,doc:c}=e,{$from:d,$to:l}=i,p=s.extensionManager.attributes,u=ye(p,d.node().type.name,d.node().attrs);if(i instanceof o.nh&&i.node.isBlock)return!(!d.parentOffset||!(0,a.zy)(c,d.pos))&&(r&&(t&&je(n,s.extensionManager.splittableMarks),e.split(d.pos).scrollIntoView()),!0);if(!d.parent.isBlock)return!1;const h=l.parentOffset===l.parent.content.size,m=0===d.depth?void 0:ae(d.node(-1).contentMatchAt(d.indexAfter(-1)));let f=h&&m?[{type:m,attrs:u}]:void 0,g=(0,a.zy)(e.doc,e.mapping.map(d.pos),1,f);if(f||g||!(0,a.zy)(e.doc,e.mapping.map(d.pos),1,m?[{type:m}]:void 0)||(g=!0,f=m?[{type:m,attrs:u}]:void 0),r){if(g&&(i instanceof o.U3&&e.deleteSelection(),e.split(e.mapping.map(d.pos),1,f),m&&!h&&!d.parentOffset&&d.parent.type!==m)){const t=e.mapping.map(d.before()),n=e.doc.resolve(t);d.node(-1).canReplaceWith(n.index(),n.index()+1,m)&&e.setNodeMarkup(e.mapping.map(d.before()),m)}t&&je(n,s.extensionManager.splittableMarks),e.scrollIntoView()}return g},Ie=(t,e={})=>({tr:n,state:r,dispatch:s,editor:c})=>{var d;const l=g(t,r.schema),{$from:p,$to:u}=r.selection,h=r.selection.node;if(h&&h.isBlock||p.depth<2||!p.sameParent(u))return!1;const m=p.node(-1);if(m.type!==l)return!1;const f=c.extensionManager.attributes;if(0===p.parent.content.size&&p.node(-1).childCount===p.indexAfter(-1)){if(2===p.depth||p.node(-3).type!==l||p.index(-2)!==p.node(-2).childCount-1)return!1;if(s){let t=i.FK.empty;const r=p.index(-1)?1:p.index(-2)?2:3;for(let e=p.depth-r;e>=p.depth-3;e-=1)t=i.FK.from(p.node(e).copy(t));const s=p.indexAfter(-1)<p.node(-2).childCount?1:p.indexAfter(-2)<p.node(-3).childCount?2:3,a={...ye(f,p.node().type.name,p.node().attrs),...e},c=(null===(d=l.contentMatch.defaultType)||void 0===d?void 0:d.createAndFill(a))||void 0;t=t.append(i.FK.from(l.createAndFill(null,c)||void 0));const u=p.before(p.depth-(r-1));n.replace(u,p.after(-s),new i.Ji(t,4-r,0));let h=-1;n.doc.nodesBetween(u,n.doc.content.size,(t,e)=>{if(h>-1)return!1;t.isTextblock&&0===t.content.size&&(h=e+1)}),h>-1&&n.setSelection(o.U3.near(n.doc.resolve(h))),n.scrollIntoView()}return!0}const v=u.pos===p.end()?m.contentMatchAt(0).defaultType:null,y={...ye(f,m.type.name,m.attrs),...e},b={...ye(f,p.node().type.name,p.node().attrs),...e};n.delete(p.pos,u.pos);const k=v?[{type:l,attrs:y},{type:v,attrs:b}]:[{type:l,attrs:y}];if(!(0,a.zy)(n.doc,p.pos,2))return!1;if(s){const{selection:t,storedMarks:e}=r,{splittableMarks:o}=c.extensionManager,i=e||t.$to.parentOffset&&t.$from.marks();if(n.split(p.pos,2,k).scrollIntoView(),!i||!s)return!0;const a=i.filter(t=>o.includes(t.type.name));n.ensureMarks(a)}return!0},Be=(t,e)=>{const n=le(t=>t.type===e)(t.selection);if(!n)return!0;const o=t.doc.resolve(Math.max(0,n.pos-1)).before(n.depth);if(void 0===o)return!0;const r=t.doc.nodeAt(o),s=n.node.type===(null===r||void 0===r?void 0:r.type)&&(0,a.n9)(t.doc,n.pos);return!s||(t.join(n.pos),!0)},Re=(t,e)=>{const n=le(t=>t.type===e)(t.selection);if(!n)return!0;const o=t.doc.resolve(n.start).after(n.depth);if(void 0===o)return!0;const r=t.doc.nodeAt(o),s=n.node.type===(null===r||void 0===r?void 0:r.type)&&(0,a.n9)(t.doc,o);return!s||(t.join(o),!0)},De=(t,e,n,o={})=>({editor:r,tr:s,state:i,dispatch:a,chain:c,commands:d,can:l})=>{const{extensions:p,splittableMarks:u}=r.extensionManager,h=g(t,i.schema),m=g(e,i.schema),{selection:f,storedMarks:v}=i,{$from:y,$to:b}=f,k=y.blockRange(b),w=v||f.$to.parentOffset&&f.$from.marks();if(!k)return!1;const x=le(t=>we(t.type.name,p))(f);if(k.depth>=1&&x&&k.depth-x.depth<=1){if(x.node.type===h)return d.liftListItem(m);if(we(x.node.type.name,p)&&h.validContent(x.node.content)&&a)return c().command(()=>(s.setNodeMarkup(x.pos,h),!0)).command(()=>Be(s,h)).command(()=>Re(s,h)).run()}return n&&w&&a?c().command(()=>{const t=l().wrapInList(h,o),e=w.filter(t=>u.includes(t.type.name));return s.ensureMarks(e),!!t||d.clearNodes()}).wrapInList(h,o).command(()=>Be(s,h)).command(()=>Re(s,h)).run():c().command(()=>{const t=l().wrapInList(h,o);return!!t||d.clearNodes()}).wrapInList(h,o).command(()=>Be(s,h)).command(()=>Re(s,h)).run()},ze=(t,e={},n={})=>({state:o,commands:r})=>{const{extendEmptyMarkRange:s=!1}=n,i=mt(t,o.schema),a=be(o,i,e);return a?r.unsetMark(i,{extendEmptyMarkRange:s}):r.setMark(i,e)},Le=(t,e,n={})=>({state:o,commands:r})=>{const s=g(t,o.schema),i=g(e,o.schema),a=Ht(o,s,n);let c;return o.selection.$anchor.sameParent(o.selection.$head)&&(c=o.selection.$anchor.parent.attrs),a?r.setNode(i,c):r.setNode(s,{...c,...n})},_e=(t,e={})=>({state:n,commands:o})=>{const r=g(t,n.schema),s=Ht(n,r,e);return s?o.lift(r):o.wrapIn(r,e)},Fe=()=>({state:t,dispatch:e})=>{const n=t.plugins;for(let o=0;o<n.length;o+=1){const r=n[o];let s;if(r.spec.isInputRules&&(s=r.getState(t))){if(e){const e=t.tr,n=s.transform;for(let t=n.steps.length-1;t>=0;t-=1)e.step(n.steps[t].invert(n.docs[t]));if(s.text){const n=e.doc.resolve(s.from).marks();e.replaceWith(s.from,s.to,t.schema.text(s.text,n))}else e.delete(s.from,s.to)}return!0}}return!1},He=()=>({tr:t,dispatch:e})=>{const{selection:n}=t,{empty:o,ranges:r}=n;return o||e&&r.forEach(e=>{t.removeMark(e.$from.pos,e.$to.pos)}),!0},Ke=(t,e={})=>({tr:n,state:o,dispatch:r})=>{var s;const{extendEmptyMarkRange:i=!1}=e,{selection:a}=n,c=mt(t,o.schema),{$from:d,empty:l,ranges:p}=a;if(!r)return!0;if(l&&i){let{from:t,to:e}=a;const o=null===(s=d.marks().find(t=>t.type===c))||void 0===s?void 0:s.attrs,r=ht(d,c,o);r&&(t=r.from,e=r.to),n.removeMark(t,e,c)}else p.forEach(t=>{n.removeMark(t.$from.pos,t.$to.pos,c)});return n.removeStoredMark(c),!0},Ue=(t,e={})=>({tr:n,state:o,dispatch:r})=>{let s=null,i=null;const a=Gt("string"===typeof t?t:t.name,o.schema);return!!a&&("node"===a&&(s=g(t,o.schema)),"mark"===a&&(i=mt(t,o.schema)),r&&n.selection.ranges.forEach(t=>{const r=t.$from.pos,a=t.$to.pos;let c,d,l,p;n.selection.empty?o.doc.nodesBetween(r,a,(t,e)=>{s&&s===t.type&&(l=Math.max(e,r),p=Math.min(e+t.nodeSize,a),c=e,d=t)}):o.doc.nodesBetween(r,a,(t,o)=>{o<r&&s&&s===t.type&&(l=Math.max(o,r),p=Math.min(o+t.nodeSize,a),c=o,d=t),o>=r&&o<=a&&(s&&s===t.type&&n.setNodeMarkup(o,void 0,{...t.attrs,...e}),i&&t.marks.length&&t.marks.forEach(s=>{if(i===s.type){const c=Math.max(o,r),d=Math.min(o+t.nodeSize,a);n.addMark(c,d,i.create({...s.attrs,...e}))}}))}),d&&(void 0!==c&&n.setNodeMarkup(c,void 0,{...d.attrs,...e}),i&&d.marks.length&&d.marks.forEach(t=>{i===t.type&&n.addMark(l,p,i.create({...t.attrs,...e}))}))}),!0)},Ve=(t,e={})=>({state:n,dispatch:o})=>{const r=g(t,n.schema);return(0,c.Im)(r,e)(n,o)},We=(t,e={})=>({state:n,dispatch:o})=>{const r=g(t,n.schema);return(0,d.Sd)(r,e)(n,o)};var Ge=Object.freeze({__proto__:null,blur:Q,clearContent:X,clearNodes:tt,command:et,createParagraphNear:nt,cut:ot,deleteCurrentNode:rt,deleteNode:st,deleteRange:it,deleteSelection:at,enter:ct,exitCode:dt,extendMarkRange:ft,first:gt,focus:xt,forEach:Mt,insertContent:Ot,insertContentAt:$t,joinBackward:Nt,joinDown:jt,joinForward:It,joinItemBackward:Bt,joinItemForward:Rt,joinTextblockBackward:Dt,joinTextblockForward:zt,joinUp:At,keyboardShortcut:Ft,lift:Kt,liftEmptyBlock:Ut,liftListItem:Vt,newlineInCode:Wt,resetAttributes:Jt,scrollIntoView:Yt,selectAll:Zt,selectNodeBackward:Qt,selectNodeForward:Xt,selectParentNode:te,selectTextblockEnd:ee,selectTextblockStart:ne,setContent:re,setMark:Se,setMeta:Ce,setNode:Te,setNodeSelection:Pe,setTextSelection:$e,sinkListItem:Ae,splitBlock:Ne,splitListItem:Ie,toggleList:De,toggleMark:ze,toggleNode:Le,toggleWrap:_e,undoInputRule:Fe,unsetAllMarks:He,unsetMark:Ke,updateAttributes:Ue,wrapIn:Ve,wrapInList:We});const qe=q.create({name:"commands",addCommands(){return{...Ge}}}),Je=q.create({name:"drop",addProseMirrorPlugins(){return[new o.k_({key:new o.hs("tiptapDrop"),props:{handleDrop:(t,e,n,o)=>{this.editor.emit("drop",{editor:this.editor,event:e,slice:n,moved:o})}}})]}}),Ye=q.create({name:"editable",addProseMirrorPlugins(){return[new o.k_({key:new o.hs("editable"),props:{editable:()=>this.editor.options.editable}})]}}),Ze=new o.hs("focusEvents"),Qe=q.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:t}=this;return[new o.k_({key:Ze,props:{handleDOMEvents:{focus:(e,n)=>{t.isFocused=!0;const o=t.state.tr.setMeta("focus",{event:n}).setMeta("addToHistory",!1);return e.dispatch(o),!1},blur:(e,n)=>{t.isFocused=!1;const o=t.state.tr.setMeta("blur",{event:n}).setMeta("addToHistory",!1);return e.dispatch(o),!1}}}})]}}),Xe=q.create({name:"keymap",addKeyboardShortcuts(){const t=()=>this.editor.commands.first(({commands:t})=>[()=>t.undoInputRule(),()=>t.command(({tr:e})=>{const{selection:n,doc:r}=e,{empty:s,$anchor:i}=n,{pos:a,parent:c}=i,d=i.parent.isTextblock&&a>0?e.doc.resolve(a-1):i,l=d.parent.type.spec.isolating,p=i.pos-i.parentOffset,u=l&&1===d.parent.childCount?p===i.pos:o.LN.atStart(r).from===a;return!(!s||!c.type.isTextblock||c.textContent.length||!u||u&&"paragraph"===i.parent.type.name)&&t.clearNodes()}),()=>t.deleteSelection(),()=>t.joinBackward(),()=>t.selectNodeBackward()]),e=()=>this.editor.commands.first(({commands:t})=>[()=>t.deleteSelection(),()=>t.deleteCurrentNode(),()=>t.joinForward(),()=>t.selectNodeForward()]),n=()=>this.editor.commands.first(({commands:t})=>[()=>t.newlineInCode(),()=>t.createParagraphNear(),()=>t.liftEmptyBlock(),()=>t.splitBlock()]),r={Enter:n,"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:t,"Mod-Backspace":t,"Shift-Backspace":t,Delete:e,"Mod-Delete":e,"Mod-a":()=>this.editor.commands.selectAll()},s={...r},i={...r,"Ctrl-h":t,"Alt-Backspace":t,"Ctrl-d":e,"Ctrl-Alt-Backspace":e,"Alt-Delete":e,"Alt-d":e,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return wt()||Lt()?i:s},addProseMirrorPlugins(){return[new o.k_({key:new o.hs("clearDocument"),appendTransaction:(t,e,n)=>{if(t.some(t=>t.getMeta("composition")))return;const r=t.some(t=>t.docChanged)&&!e.doc.eq(n.doc),s=t.some(t=>t.getMeta("preventClearDocument"));if(!r||s)return;const{empty:i,from:a,to:c}=e.selection,d=o.LN.atStart(e.doc).from,u=o.LN.atEnd(e.doc).to,h=a===d&&c===u;if(i||!h)return;const m=xe(n.doc);if(!m)return;const f=n.tr,g=l({state:n,transaction:f}),{commands:v}=new p({editor:this.editor,state:g});return v.clearNodes(),f.steps.length?f:void 0}})]}}),tn=q.create({name:"paste",addProseMirrorPlugins(){return[new o.k_({key:new o.hs("tiptapPaste"),props:{handlePaste:(t,e,n)=>{this.editor.emit("paste",{editor:this.editor,event:e,slice:n})}}})]}}),en=q.create({name:"tabindex",addProseMirrorPlugins(){return[new o.k_({key:new o.hs("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}});class nn{get name(){return this.node.type.name}constructor(t,e,n=!1,o=null){this.currentNode=null,this.actualDepth=null,this.isBlock=n,this.resolvedPos=t,this.editor=e,this.currentNode=o}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var t;return null!==(t=this.actualDepth)&&void 0!==t?t:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(t){let e=this.from,n=this.to;if(this.isBlock){if(0===this.content.size)return void console.error(`You can’t set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);e=this.from+1,n=this.to-1}this.editor.commands.insertContentAt({from:e,to:n},t)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(0===this.depth)return null;const t=this.resolvedPos.start(this.resolvedPos.depth-1),e=this.resolvedPos.doc.resolve(t);return new nn(e,this.editor)}get before(){let t=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return t.depth!==this.depth&&(t=this.resolvedPos.doc.resolve(this.from-3)),new nn(t,this.editor)}get after(){let t=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return t.depth!==this.depth&&(t=this.resolvedPos.doc.resolve(this.to+3)),new nn(t,this.editor)}get children(){const t=[];return this.node.content.forEach((e,n)=>{const o=e.isBlock&&!e.isTextblock,r=e.isAtom&&!e.isText,s=this.pos+n+(r?0:1);if(s<0||s>this.resolvedPos.doc.nodeSize-2)return;const i=this.resolvedPos.doc.resolve(s);if(!o&&i.depth<=this.depth)return;const a=new nn(i,this.editor,o,o?e:null);o&&(a.actualDepth=this.depth+1),t.push(new nn(i,this.editor,o,o?e:null))}),t}get firstChild(){return this.children[0]||null}get lastChild(){const t=this.children;return t[t.length-1]||null}closest(t,e={}){let n=null,o=this.parent;while(o&&!n){if(o.node.type.name===t)if(Object.keys(e).length>0){const t=o.node.attrs,n=Object.keys(e);for(let o=0;o<n.length;o+=1){const r=n[o];if(t[r]!==e[r])break}}else n=o;o=o.parent}return n}querySelector(t,e={}){return this.querySelectorAll(t,e,!0)[0]||null}querySelectorAll(t,e={},n=!1){let o=[];if(!this.children||0===this.children.length)return o;const r=Object.keys(e);return this.children.forEach(s=>{if(!(n&&o.length>0)){if(s.node.type.name===t){const t=r.every(t=>e[t]===s.node.attrs[t]);t&&o.push(s)}n&&o.length>0||(o=o.concat(s.querySelectorAll(t,e,n)))}}),o}setAttribute(t){const{tr:e}=this.editor.state;e.setNodeMarkup(this.from,void 0,{...this.node.attrs,...t}),this.editor.view.dispatch(e)}}const on='.ProseMirror {\n  position: relative;\n}\n\n.ProseMirror {\n  word-wrap: break-word;\n  white-space: pre-wrap;\n  white-space: break-spaces;\n  -webkit-font-variant-ligatures: none;\n  font-variant-ligatures: none;\n  font-feature-settings: "liga" 0; /* the above doesn\'t seem to work in Edge */\n}\n\n.ProseMirror [contenteditable="false"] {\n  white-space: normal;\n}\n\n.ProseMirror [contenteditable="false"] [contenteditable="true"] {\n  white-space: pre-wrap;\n}\n\n.ProseMirror pre {\n  white-space: pre-wrap;\n}\n\nimg.ProseMirror-separator {\n  display: inline !important;\n  border: none !important;\n  margin: 0 !important;\n  width: 0 !important;\n  height: 0 !important;\n}\n\n.ProseMirror-gapcursor {\n  display: none;\n  pointer-events: none;\n  position: absolute;\n  margin: 0;\n}\n\n.ProseMirror-gapcursor:after {\n  content: "";\n  display: block;\n  position: absolute;\n  top: -2px;\n  width: 20px;\n  border-top: 1px solid black;\n  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;\n}\n\n@keyframes ProseMirror-cursor-blink {\n  to {\n    visibility: hidden;\n  }\n}\n\n.ProseMirror-hideselection *::selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection *::-moz-selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection * {\n  caret-color: transparent;\n}\n\n.ProseMirror-focused .ProseMirror-gapcursor {\n  display: block;\n}\n\n.tippy-box[data-animation=fade][data-state=hidden] {\n  opacity: 0\n}';function rn(t,e,n){const o=document.querySelector(`style[data-tiptap-style${n?`-${n}`:""}]`);if(null!==o)return o;const r=document.createElement("style");return e&&r.setAttribute("nonce",e),r.setAttribute("data-tiptap-style"+(n?`-${n}`:""),""),r.innerHTML=t,document.getElementsByTagName("head")[0].appendChild(r),r}class sn extends u{constructor(t={}){super(),this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,emitContentError:!1,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:t})=>{throw t},onPaste:()=>null,onDrop:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(t),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("contentError",this.options.onContentError),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",({event:t,slice:e,moved:n})=>this.options.onDrop(t,e,n)),this.on("paste",({event:t,slice:e})=>this.options.onPaste(t,e)),window.setTimeout(()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=rn(on,this.options.injectNonce))}setOptions(t={}){this.options={...this.options,...t},this.view&&this.state&&!this.isDestroyed&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(t,e=!0){this.setOptions({editable:t}),e&&this.emit("update",{editor:this,transaction:this.state.tr})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(t,e){const n=b(e)?e(t,[...this.state.plugins]):[...this.state.plugins,t],o=this.state.reconfigure({plugins:n});return this.view.updateState(o),o}unregisterPlugin(t){if(this.isDestroyed)return;const e=this.state.plugins;let n=e;if([].concat(t).forEach(t=>{const e="string"===typeof t?`${t}$`:t.key;n=n.filter(t=>!t.key.startsWith(e))}),e.length===n.length)return;const o=this.state.reconfigure({plugins:n});return this.view.updateState(o),o}createExtensionManager(){var t,e;const n=this.options.enableCoreExtensions?[Ye,Z.configure({blockSeparator:null===(e=null===(t=this.options.coreExtensionOptions)||void 0===t?void 0:t.clipboardTextSerializer)||void 0===e?void 0:e.blockSeparator}),qe,Qe,Xe,en,Je,tn].filter(t=>"object"!==typeof this.options.enableCoreExtensions||!1!==this.options.enableCoreExtensions[t.name]):[],o=[...n,...this.options.extensions].filter(t=>["extension","node","mark"].includes(null===t||void 0===t?void 0:t.type));this.extensionManager=new G(o,this)}createCommandManager(){this.commandManager=new p({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){var t;let e;try{e=oe(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(a){if(!(a instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(a.message))throw a;this.emit("contentError",{editor:this,error:a,disableCollaboration:()=>{this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(t=>"collaboration"!==t.name),this.createExtensionManager()}}),e=oe(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}const n=bt(e,this.options.autofocus);this.view=new r.Lz(this.options.element,{...this.options.editorProps,attributes:{role:"textbox",...null===(t=this.options.editorProps)||void 0===t?void 0:t.attributes},dispatchTransaction:this.dispatchTransaction.bind(this),state:o.$t.create({doc:e,selection:n||void 0})});const s=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(s),this.createNodeViews(),this.prependClass();const i=this.view.dom;i.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`tiptap ${this.view.dom.className}`}captureTransaction(t){this.isCapturingTransaction=!0,t(),this.isCapturingTransaction=!1;const e=this.capturedTransaction;return this.capturedTransaction=null,e}dispatchTransaction(t){if(this.view.isDestroyed)return;if(this.isCapturingTransaction)return this.capturedTransaction?void t.steps.forEach(t=>{var e;return null===(e=this.capturedTransaction)||void 0===e?void 0:e.step(t)}):void(this.capturedTransaction=t);const e=this.state.apply(t),n=!this.state.selection.eq(e.selection);this.emit("beforeTransaction",{editor:this,transaction:t,nextState:e}),this.view.updateState(e),this.emit("transaction",{editor:this,transaction:t}),n&&this.emit("selectionUpdate",{editor:this,transaction:t});const o=t.getMeta("focus"),r=t.getMeta("blur");o&&this.emit("focus",{editor:this,event:o.event,transaction:t}),r&&this.emit("blur",{editor:this,event:r.event,transaction:t}),t.docChanged&&!t.getMeta("preventUpdate")&&this.emit("update",{editor:this,transaction:t})}getAttributes(t){return he(this.state,t)}isActive(t,e){const n="string"===typeof t?t:null,o="string"===typeof t?e:t;return ke(this.state,n,o)}getJSON(){return this.state.doc.toJSON()}getHTML(){return T(this.state.doc.content,this.schema)}getText(t){const{blockSeparator:e="\n\n",textSerializers:n={}}=t||{};return pe(this.state.doc,{blockSeparator:e,textSerializers:{...Y(this.schema),...n}})}get isEmpty(){return xe(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){if(this.emit("destroy"),this.view){const t=this.view.dom;t&&t.editor&&delete t.editor,this.view.destroy()}this.removeAllListeners()}get isDestroyed(){var t;return!(null===(t=this.view)||void 0===t?void 0:t.docView)}$node(t,e){var n;return(null===(n=this.$doc)||void 0===n?void 0:n.querySelector(t,e))||null}$nodes(t,e){var n;return(null===(n=this.$doc)||void 0===n?void 0:n.querySelectorAll(t,e))||null}$pos(t){const e=this.state.doc.resolve(t);return new nn(e,this)}get $doc(){return this.$pos(0)}}function an(t){return new A({find:t.find,handler:({state:e,range:n,match:o})=>{const r=k(t.getAttributes,void 0,o);if(!1===r||null===r)return null;const{tr:s}=e,i=o[o.length-1],a=o[0];if(i){const o=a.search(/\S/),c=n.from+a.indexOf(i),d=c+i.length,l=ve(n.from,n.to,e.doc).filter(e=>{const n=e.mark.type.excluded;return n.find(n=>n===t.type&&n!==e.mark.type)}).filter(t=>t.to>c);if(l.length)return null;d<n.to&&s.delete(d,n.to),c>n.from&&s.delete(n.from+o,c);const p=n.from+o+i.length;s.addMark(n.from+o,p,t.type.create(r||{})),s.removeStoredMark(t.type)}}})}function cn(t){return new A({find:t.find,handler:({state:e,range:n,match:o})=>{const r=k(t.getAttributes,void 0,o)||{},{tr:s}=e,i=n.from;let a=n.to;const c=t.type.create(r);if(o[1]){const t=o[0].lastIndexOf(o[1]);let e=i+t;e>a?e=a:a=e+o[1].length;const n=o[0][o[0].length-1];s.insertText(n,i+o[0].length-1),s.replaceWith(e,a,c)}else if(o[0]){const e=t.type.isInline?i:i-1;s.insert(e,t.type.create(r)).delete(s.mapping.map(i),s.mapping.map(a))}s.scrollIntoView()}})}function dn(t){return new A({find:t.find,handler:({state:e,range:n,match:o})=>{const r=e.doc.resolve(n.from),s=k(t.getAttributes,void 0,o)||{};if(!r.node(-1).canReplaceWith(r.index(-1),r.indexAfter(-1),t.type))return null;e.tr.delete(n.from,n.to).setBlockType(n.from,n.from,t.type,s)}})}function ln(t){return new A({find:t.find,handler:({state:e,range:n,match:o,chain:r})=>{const s=k(t.getAttributes,void 0,o)||{},i=e.tr.delete(n.from,n.to),c=i.doc.resolve(n.from),d=c.blockRange(),l=d&&(0,a.oM)(d,t.type,s);if(!l)return null;if(i.wrap(d,l),t.keepMarks&&t.editor){const{selection:n,storedMarks:o}=e,{splittableMarks:r}=t.editor.extensionManager,s=o||n.$to.parentOffset&&n.$from.marks();if(s){const t=s.filter(t=>r.includes(t.type.name));i.ensureMarks(t)}}if(t.keepAttributes){const e="bulletList"===t.type.name||"orderedList"===t.type.name?"listItem":"taskList";r().updateAttributes(e,s).run()}const p=i.doc.resolve(n.from-1).nodeBefore;p&&p.type===t.type&&(0,a.n9)(i.doc,n.from-1)&&(!t.joinPredicate||t.joinPredicate(o,p))&&i.join(n.from-1)}})}class pn{constructor(t={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...t},this.name=this.config.name,t.defaultOptions&&Object.keys(t.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=k(h(this,"addOptions",{name:this.name}))),this.storage=k(h(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new pn(t)}configure(t={}){const e=this.extend({...this.config,addOptions:()=>D(this.options,t)});return e.name=this.name,e.parent=this.parent,e}extend(t={}){const e=new pn(t);return e.parent=this,this.child=e,e.name=t.name?t.name:e.parent.name,t.defaultOptions&&Object.keys(t.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${e.name}".`),e.options=k(h(e,"addOptions",{name:e.name})),e.storage=k(h(e,"addStorage",{name:e.name,options:e.options})),e}}function un(t){return new _({find:t.find,handler:({state:e,range:n,match:o,pasteEvent:r})=>{const s=k(t.getAttributes,void 0,o,r);if(!1===s||null===s)return null;const{tr:i}=e,a=o[o.length-1],c=o[0];let d=n.to;if(a){const o=c.search(/\S/),r=n.from+c.indexOf(a),l=r+a.length,p=ve(n.from,n.to,e.doc).filter(e=>{const n=e.mark.type.excluded;return n.find(n=>n===t.type&&n!==e.mark.type)}).filter(t=>t.to>r);if(p.length)return null;l<n.to&&i.delete(l,n.to),r>n.from&&i.delete(n.from+o,r),d=n.from+o+a.length,i.addMark(n.from+o,d,t.type.create(s||{})),i.removeStoredMark(t.type)}}})}function hn(t,e){const{selection:n}=t,{$from:r}=n;if(n instanceof o.nh){const t=r.index(),n=r.parent;return n.canReplaceWith(t,t+1,e)}let s=r.depth;while(s>=0){const t=r.index(s),n=r.node(s),o=n.contentMatchAt(t);if(o.matchType(e))return!0;s-=1}return!1}}};