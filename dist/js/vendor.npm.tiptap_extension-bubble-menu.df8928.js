export const __webpack_id__=881;export const __webpack_ids__=[881];export const __webpack_modules__={83080:(e,t,i)=>{i.d(t,{Ay:()=>r,V$:()=>l});var s=i(90277),o=i(42845),n=i(64504);class d{constructor({editor:e,element:t,view:i,tippyOptions:o={},updateDelay:n=250,shouldShow:d}){this.preventHide=!1,this.shouldShow=({view:e,state:t,from:i,to:o})=>{const{doc:n,selection:d}=t,{empty:l}=d,r=!n.textBetween(i,o).length&&(0,s.eE)(t.selection),p=this.element.contains(document.activeElement),h=e.hasFocus()||p;return!(!h||l||r||!this.editor.isEditable)},this.mousedownHandler=()=>{this.preventHide=!0},this.dragstartHandler=()=>{this.hide()},this.focusHandler=()=>{setTimeout(()=>this.update(this.editor.view))},this.blurHandler=({event:e})=>{var t;this.preventHide?this.preventHide=!1:(null===e||void 0===e?void 0:e.relatedTarget)&&(null===(t=this.element.parentNode)||void 0===t?void 0:t.contains(e.relatedTarget))||(null===e||void 0===e?void 0:e.relatedTarget)!==this.editor.view.dom&&this.hide()},this.tippyBlurHandler=e=>{this.blurHandler({event:e})},this.handleDebouncedUpdate=(e,t)=>{const i=!(null===t||void 0===t?void 0:t.selection.eq(e.state.selection)),s=!(null===t||void 0===t?void 0:t.doc.eq(e.state.doc));(i||s)&&(this.updateDebounceTimer&&clearTimeout(this.updateDebounceTimer),this.updateDebounceTimer=window.setTimeout(()=>{this.updateHandler(e,i,s,t)},this.updateDelay))},this.updateHandler=(e,t,i,o)=>{var n,d,l;const{state:r,composing:p}=e,{selection:h}=r,a=!t&&!i;if(p||a)return;this.createTooltip();const{ranges:u}=h,c=Math.min(...u.map(e=>e.$from.pos)),v=Math.max(...u.map(e=>e.$to.pos)),m=null===(n=this.shouldShow)||void 0===n?void 0:n.call(this,{editor:this.editor,element:this.element,view:e,state:r,oldState:o,from:c,to:v});m?(null===(d=this.tippy)||void 0===d||d.setProps({getReferenceClientRect:(null===(l=this.tippyOptions)||void 0===l?void 0:l.getReferenceClientRect)||(()=>{if((0,s.BQ)(r.selection)){let t=e.nodeDOM(c);if(t){const e=t.dataset.nodeViewWrapper?t:t.querySelector("[data-node-view-wrapper]");if(e&&(t=e.firstChild),t)return t.getBoundingClientRect()}}return(0,s.MG)(e,c,v)})}),this.show()):this.hide()},this.editor=e,this.element=t,this.view=i,this.updateDelay=n,d&&(this.shouldShow=d),this.element.addEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.view.dom.addEventListener("dragstart",this.dragstartHandler),this.editor.on("focus",this.focusHandler),this.editor.on("blur",this.blurHandler),this.tippyOptions=o,this.element.remove(),this.element.style.visibility="visible"}createTooltip(){const{element:e}=this.editor.options,t=!!e.parentElement;this.element.tabIndex=0,!this.tippy&&t&&(this.tippy=(0,n.Ay)(e,{duration:0,getReferenceClientRect:null,content:this.element,interactive:!0,trigger:"manual",placement:"top",hideOnClick:"toggle",...this.tippyOptions}),this.tippy.popper.firstChild&&this.tippy.popper.firstChild.addEventListener("blur",this.tippyBlurHandler))}update(e,t){const{state:i}=e,s=i.selection.from!==i.selection.to;if(this.updateDelay>0&&s)return void this.handleDebouncedUpdate(e,t);const o=!(null===t||void 0===t?void 0:t.selection.eq(e.state.selection)),n=!(null===t||void 0===t?void 0:t.doc.eq(e.state.doc));this.updateHandler(e,o,n,t)}show(){var e;null===(e=this.tippy)||void 0===e||e.show()}hide(){var e;null===(e=this.tippy)||void 0===e||e.hide()}destroy(){var e,t;(null===(e=this.tippy)||void 0===e?void 0:e.popper.firstChild)&&this.tippy.popper.firstChild.removeEventListener("blur",this.tippyBlurHandler),null===(t=this.tippy)||void 0===t||t.destroy(),this.element.removeEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.view.dom.removeEventListener("dragstart",this.dragstartHandler),this.editor.off("focus",this.focusHandler),this.editor.off("blur",this.blurHandler)}}const l=e=>new o.k_({key:"string"===typeof e.pluginKey?new o.hs(e.pluginKey):e.pluginKey,view:t=>new d({view:t,...e})}),r=s.YY.create({name:"bubbleMenu",addOptions(){return{element:null,tippyOptions:{},pluginKey:"bubbleMenu",updateDelay:void 0,shouldShow:null}},addProseMirrorPlugins(){return this.options.element?[l({pluginKey:this.options.pluginKey,editor:this.editor,element:this.options.element,tippyOptions:this.options.tippyOptions,updateDelay:this.options.updateDelay,shouldShow:this.options.shouldShow})]:[]}})}};