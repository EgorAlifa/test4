export const __webpack_id__=4618;export const __webpack_ids__=[4618];export const __webpack_modules__={38262:(t,e,r)=>{r.d(e,{$L:()=>Y,Ln:()=>b,N0:()=>P,Um:()=>V,Wg:()=>J,X9:()=>m,dL:()=>yt,jP:()=>T,n9:()=>U,oM:()=>O,zy:()=>L});var n=r(42225);const i=65535,s=Math.pow(2,16);function o(t,e){return t+e*s}function l(t){return t&i}function a(t){return(t-(t&i))/s}const p=1,h=2,c=4,f=8;class d{constructor(t,e,r){this.pos=t,this.delInfo=e,this.recover=r}get deleted(){return(this.delInfo&f)>0}get deletedBefore(){return(this.delInfo&(p|c))>0}get deletedAfter(){return(this.delInfo&(h|c))>0}get deletedAcross(){return(this.delInfo&c)>0}}class u{constructor(t,e=!1){if(this.ranges=t,this.inverted=e,!t.length&&u.empty)return u.empty}recover(t){let e=0,r=l(t);if(!this.inverted)for(let n=0;n<r;n++)e+=this.ranges[3*n+2]-this.ranges[3*n+1];return this.ranges[3*r]+e+a(t)}mapResult(t,e=1){return this._map(t,e,!1)}map(t,e=1){return this._map(t,e,!0)}_map(t,e,r){let n=0,i=this.inverted?2:1,s=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let a=this.ranges[l]-(this.inverted?n:0);if(a>t)break;let u=this.ranges[l+i],m=this.ranges[l+s],y=a+u;if(t<=y){let i=u?t==a?-1:t==y?1:e:e,s=a+n+(i<0?0:m);if(r)return s;let g=t==(e<0?a:y)?null:o(l/3,t-a),w=t==a?h:t==y?p:c;return(e<0?t!=a:t!=y)&&(w|=f),new d(s,w,g)}n+=m-u}return r?t+n:new d(t+n,0,null)}touches(t,e){let r=0,n=l(e),i=this.inverted?2:1,s=this.inverted?1:2;for(let o=0;o<this.ranges.length;o+=3){let e=this.ranges[o]-(this.inverted?r:0);if(e>t)break;let l=this.ranges[o+i],a=e+l;if(t<=a&&o==3*n)return!0;r+=this.ranges[o+s]-l}return!1}forEach(t){let e=this.inverted?2:1,r=this.inverted?1:2;for(let n=0,i=0;n<this.ranges.length;n+=3){let s=this.ranges[n],o=s-(this.inverted?i:0),l=s+(this.inverted?0:i),a=this.ranges[n+e],p=this.ranges[n+r];t(o,o+a,l,l+p),i+=p-a}}invert(){return new u(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(t){return 0==t?u.empty:new u(t<0?[0,-t,0]:[0,0,t])}}u.empty=new u([]);class m{constructor(t,e,r=0,n=(t?t.length:0)){this.mirror=e,this.from=r,this.to=n,this._maps=t||[],this.ownData=!(t||e)}get maps(){return this._maps}slice(t=0,e=this.maps.length){return new m(this._maps,this.mirror,t,e)}appendMap(t,e){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(t),null!=e&&this.setMirror(this._maps.length-1,e)}appendMapping(t){for(let e=0,r=this._maps.length;e<t._maps.length;e++){let n=t.getMirror(e);this.appendMap(t._maps[e],null!=n&&n<e?r+n:void 0)}}getMirror(t){if(this.mirror)for(let e=0;e<this.mirror.length;e++)if(this.mirror[e]==t)return this.mirror[e+(e%2?-1:1)]}setMirror(t,e){this.mirror||(this.mirror=[]),this.mirror.push(t,e)}appendMappingInverted(t){for(let e=t.maps.length-1,r=this._maps.length+t._maps.length;e>=0;e--){let n=t.getMirror(e);this.appendMap(t._maps[e].invert(),null!=n&&n>e?r-n-1:void 0)}}invert(){let t=new m;return t.appendMappingInverted(this),t}map(t,e=1){if(this.mirror)return this._map(t,e,!0);for(let r=this.from;r<this.to;r++)t=this._maps[r].map(t,e);return t}mapResult(t,e=1){return this._map(t,e,!1)}_map(t,e,r){let n=0;for(let i=this.from;i<this.to;i++){let r=this._maps[i],s=r.mapResult(t,e);if(null!=s.recover){let e=this.getMirror(i);if(null!=e&&e>i&&e<this.to){i=e,t=this._maps[e].recover(s.recover);continue}}n|=s.delInfo,t=s.pos}return r?t:new d(t,n,null)}}const y=Object.create(null);class g{getMap(){return u.empty}merge(t){return null}static fromJSON(t,e){if(!e||!e.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=y[e.stepType];if(!r)throw new RangeError(`No step type ${e.stepType} defined`);return r.fromJSON(t,e)}static jsonID(t,e){if(t in y)throw new RangeError("Duplicate use of step JSON ID "+t);return y[t]=e,e.prototype.jsonID=t,e}}class w{constructor(t,e){this.doc=t,this.failed=e}static ok(t){return new w(t,null)}static fail(t){return new w(null,t)}static fromReplace(t,e,r,i){try{return w.ok(t.replace(e,r,i))}catch(s){if(s instanceof n.vI)return w.fail(s.message);throw s}}}function k(t,e,r){let i=[];for(let n=0;n<t.childCount;n++){let s=t.child(n);s.content.size&&(s=s.copy(k(s.content,e,s))),s.isInline&&(s=e(s,r,n)),i.push(s)}return n.FK.fromArray(i)}class v extends g{constructor(t,e,r){super(),this.from=t,this.to=e,this.mark=r}apply(t){let e=t.slice(this.from,this.to),r=t.resolve(this.from),i=r.node(r.sharedDepth(this.to)),s=new n.Ji(k(e.content,(t,e)=>t.isAtom&&e.type.allowsMarkType(this.mark.type)?t.mark(this.mark.addToSet(t.marks)):t,i),e.openStart,e.openEnd);return w.fromReplace(t,this.from,this.to,s)}invert(){return new S(this.from,this.to,this.mark)}map(t){let e=t.mapResult(this.from,1),r=t.mapResult(this.to,-1);return e.deleted&&r.deleted||e.pos>=r.pos?null:new v(e.pos,r.pos,this.mark)}merge(t){return t instanceof v&&t.mark.eq(this.mark)&&this.from<=t.to&&this.to>=t.from?new v(Math.min(this.from,t.from),Math.max(this.to,t.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(t,e){if("number"!=typeof e.from||"number"!=typeof e.to)throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new v(e.from,e.to,t.markFromJSON(e.mark))}}g.jsonID("addMark",v);class S extends g{constructor(t,e,r){super(),this.from=t,this.to=e,this.mark=r}apply(t){let e=t.slice(this.from,this.to),r=new n.Ji(k(e.content,t=>t.mark(this.mark.removeFromSet(t.marks)),t),e.openStart,e.openEnd);return w.fromReplace(t,this.from,this.to,r)}invert(){return new v(this.from,this.to,this.mark)}map(t){let e=t.mapResult(this.from,1),r=t.mapResult(this.to,-1);return e.deleted&&r.deleted||e.pos>=r.pos?null:new S(e.pos,r.pos,this.mark)}merge(t){return t instanceof S&&t.mark.eq(this.mark)&&this.from<=t.to&&this.to>=t.from?new S(Math.min(this.from,t.from),Math.max(this.to,t.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(t,e){if("number"!=typeof e.from||"number"!=typeof e.to)throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new S(e.from,e.to,t.markFromJSON(e.mark))}}g.jsonID("removeMark",S);class M extends g{constructor(t,e){super(),this.pos=t,this.mark=e}apply(t){let e=t.nodeAt(this.pos);if(!e)return w.fail("No node at mark step's position");let r=e.type.create(e.attrs,null,this.mark.addToSet(e.marks));return w.fromReplace(t,this.pos,this.pos+1,new n.Ji(n.FK.from(r),0,e.isLeaf?0:1))}invert(t){let e=t.nodeAt(this.pos);if(e){let t=this.mark.addToSet(e.marks);if(t.length==e.marks.length){for(let r=0;r<e.marks.length;r++)if(!e.marks[r].isInSet(t))return new M(this.pos,e.marks[r]);return new M(this.pos,this.mark)}}return new x(this.pos,this.mark)}map(t){let e=t.mapResult(this.pos,1);return e.deletedAfter?null:new M(e.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(t,e){if("number"!=typeof e.pos)throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new M(e.pos,t.markFromJSON(e.mark))}}g.jsonID("addNodeMark",M);class x extends g{constructor(t,e){super(),this.pos=t,this.mark=e}apply(t){let e=t.nodeAt(this.pos);if(!e)return w.fail("No node at mark step's position");let r=e.type.create(e.attrs,null,this.mark.removeFromSet(e.marks));return w.fromReplace(t,this.pos,this.pos+1,new n.Ji(n.FK.from(r),0,e.isLeaf?0:1))}invert(t){let e=t.nodeAt(this.pos);return e&&this.mark.isInSet(e.marks)?new M(this.pos,this.mark):this}map(t){let e=t.mapResult(this.pos,1);return e.deletedAfter?null:new x(e.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(t,e){if("number"!=typeof e.pos)throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new x(e.pos,t.markFromJSON(e.mark))}}g.jsonID("removeNodeMark",x);class b extends g{constructor(t,e,r,n=!1){super(),this.from=t,this.to=e,this.slice=r,this.structure=n}apply(t){return this.structure&&C(t,this.from,this.to)?w.fail("Structure replace would overwrite content"):w.fromReplace(t,this.from,this.to,this.slice)}getMap(){return new u([this.from,this.to-this.from,this.slice.size])}invert(t){return new b(this.from,this.from+this.slice.size,t.slice(this.from,this.to))}map(t){let e=t.mapResult(this.from,1),r=t.mapResult(this.to,-1);return e.deletedAcross&&r.deletedAcross?null:new b(e.pos,Math.max(e.pos,r.pos),this.slice,this.structure)}merge(t){if(!(t instanceof b)||t.structure||this.structure)return null;if(this.from+this.slice.size!=t.from||this.slice.openEnd||t.slice.openStart){if(t.to!=this.from||this.slice.openStart||t.slice.openEnd)return null;{let e=this.slice.size+t.slice.size==0?n.Ji.empty:new n.Ji(t.slice.content.append(this.slice.content),t.slice.openStart,this.slice.openEnd);return new b(t.from,this.to,e,this.structure)}}{let e=this.slice.size+t.slice.size==0?n.Ji.empty:new n.Ji(this.slice.content.append(t.slice.content),this.slice.openStart,t.slice.openEnd);return new b(this.from,this.to+(t.to-t.from),e,this.structure)}}toJSON(){let t={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(t.slice=this.slice.toJSON()),this.structure&&(t.structure=!0),t}static fromJSON(t,e){if("number"!=typeof e.from||"number"!=typeof e.to)throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new b(e.from,e.to,n.Ji.fromJSON(t,e.slice),!!e.structure)}}g.jsonID("replace",b);class J extends g{constructor(t,e,r,n,i,s,o=!1){super(),this.from=t,this.to=e,this.gapFrom=r,this.gapTo=n,this.slice=i,this.insert=s,this.structure=o}apply(t){if(this.structure&&(C(t,this.from,this.gapFrom)||C(t,this.gapTo,this.to)))return w.fail("Structure gap-replace would overwrite content");let e=t.slice(this.gapFrom,this.gapTo);if(e.openStart||e.openEnd)return w.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,e.content);return r?w.fromReplace(t,this.from,this.to,r):w.fail("Content does not fit in gap")}getMap(){return new u([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(t){let e=this.gapTo-this.gapFrom;return new J(this.from,this.from+this.slice.size+e,this.from+this.insert,this.from+this.insert+e,t.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(t){let e=t.mapResult(this.from,1),r=t.mapResult(this.to,-1),n=this.from==this.gapFrom?e.pos:t.map(this.gapFrom,-1),i=this.to==this.gapTo?r.pos:t.map(this.gapTo,1);return e.deletedAcross&&r.deletedAcross||n<e.pos||i>r.pos?null:new J(e.pos,r.pos,n,i,this.slice,this.insert,this.structure)}toJSON(){let t={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(t.slice=this.slice.toJSON()),this.structure&&(t.structure=!0),t}static fromJSON(t,e){if("number"!=typeof e.from||"number"!=typeof e.to||"number"!=typeof e.gapFrom||"number"!=typeof e.gapTo||"number"!=typeof e.insert)throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new J(e.from,e.to,e.gapFrom,e.gapTo,n.Ji.fromJSON(t,e.slice),e.insert,!!e.structure)}}function C(t,e,r){let n=t.resolve(e),i=r-e,s=n.depth;while(i>0&&s>0&&n.indexAfter(s)==n.node(s).childCount)s--,i--;if(i>0){let t=n.node(s).maybeChild(n.indexAfter(s));while(i>0){if(!t||t.isLeaf)return!0;t=t.firstChild,i--}}return!1}function R(t,e,r,n){let i,s,o=[],l=[];t.doc.nodesBetween(e,r,(t,a,p)=>{if(!t.isInline)return;let h=t.marks;if(!n.isInSet(h)&&p.type.allowsMarkType(n.type)){let p=Math.max(a,e),c=Math.min(a+t.nodeSize,r),f=n.addToSet(h);for(let t=0;t<h.length;t++)h[t].isInSet(f)||(i&&i.to==p&&i.mark.eq(h[t])?i.to=c:o.push(i=new S(p,c,h[t])));s&&s.to==p?s.to=c:l.push(s=new v(p,c,n))}}),o.forEach(e=>t.step(e)),l.forEach(e=>t.step(e))}function N(t,e,r,i){let s=[],o=0;t.doc.nodesBetween(e,r,(t,l)=>{if(!t.isInline)return;o++;let a=null;if(i instanceof n.sX){let e,r=t.marks;while(e=i.isInSet(r))(a||(a=[])).push(e),r=e.removeFromSet(r)}else i?i.isInSet(t.marks)&&(a=[i]):a=t.marks;if(a&&a.length){let n=Math.min(l+t.nodeSize,r);for(let t=0;t<a.length;t++){let r,i=a[t];for(let t=0;t<s.length;t++){let e=s[t];e.step==o-1&&i.eq(s[t].style)&&(r=e)}r?(r.to=n,r.step=o):s.push({style:i,from:Math.max(l,e),to:n,step:o})}}}),s.forEach(e=>t.step(new S(e.from,e.to,e.style)))}function F(t,e,r,i=r.contentMatch,s=!0){let o=t.doc.nodeAt(e),l=[],a=e+1;for(let p=0;p<o.childCount;p++){let e=o.child(p),h=a+e.nodeSize,c=i.matchType(e.type);if(c){i=c;for(let n=0;n<e.marks.length;n++)r.allowsMarkType(e.marks[n].type)||t.step(new S(a,h,e.marks[n]));if(s&&e.isText&&"pre"!=r.whitespace){let t,i,s=/\r?\n|\r/g;while(t=s.exec(e.text))i||(i=new n.Ji(n.FK.from(r.schema.text(" ",r.allowedMarks(e.marks))),0,0)),l.push(new b(a+t.index,a+t.index+t[0].length,i))}}else l.push(new b(a,h,n.Ji.empty));a=h}if(!i.validEnd){let e=i.fillBefore(n.FK.empty,!0);t.replace(a,a,new n.Ji(e,0,0))}for(let n=l.length-1;n>=0;n--)t.step(l[n])}function I(t,e,r){return(0==e||t.canReplace(e,t.childCount))&&(r==t.childCount||t.canReplace(0,r))}function T(t){let e=t.parent,r=e.content.cutByIndex(t.startIndex,t.endIndex);for(let n=t.depth;;--n){let e=t.$from.node(n),i=t.$from.index(n),s=t.$to.indexAfter(n);if(n<t.depth&&e.canReplace(i,s,r))return n;if(0==n||e.type.spec.isolating||!I(e,i,s))break}return null}function A(t,e,r){let{$from:i,$to:s,depth:o}=e,l=i.before(o+1),a=s.after(o+1),p=l,h=a,c=n.FK.empty,f=0;for(let m=o,y=!1;m>r;m--)y||i.index(m)>0?(y=!0,c=n.FK.from(i.node(m).copy(c)),f++):p--;let d=n.FK.empty,u=0;for(let m=o,y=!1;m>r;m--)y||s.after(m+1)<s.end(m)?(y=!0,d=n.FK.from(s.node(m).copy(d)),u++):h++;t.step(new J(p,h,l,a,new n.Ji(c.append(d),f,u),c.size-f,!0))}function O(t,e,r=null,n=t){let i=_(t,e),s=i&&z(n,e);return s?i.map(E).concat({type:e,attrs:r}).concat(s.map(E)):null}function E(t){return{type:t,attrs:null}}function _(t,e){let{parent:r,startIndex:n,endIndex:i}=t,s=r.contentMatchAt(n).findWrapping(e);if(!s)return null;let o=s.length?s[0]:e;return r.canReplaceWith(n,i,o)?s:null}function z(t,e){let{parent:r,startIndex:n,endIndex:i}=t,s=r.child(n),o=e.contentMatch.findWrapping(s.type);if(!o)return null;let l=o.length?o[o.length-1]:e,a=l.contentMatch;for(let p=n;a&&p<i;p++)a=a.matchType(r.child(p).type);return a&&a.validEnd?o:null}function K(t,e,r){let i=n.FK.empty;for(let l=r.length-1;l>=0;l--){if(i.size){let t=r[l].type.contentMatch.matchFragment(i);if(!t||!t.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}i=n.FK.from(r[l].type.create(r[l].attrs,i))}let s=e.start,o=e.end;t.step(new J(s,o,s,o,new n.Ji(i,0,0),r.length,!0))}function D(t,e,r,i,s){if(!i.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let o=t.steps.length;t.doc.nodesBetween(e,r,(e,r)=>{let l="function"==typeof s?s(e):s;if(e.isTextblock&&!e.hasMarkup(i,l)&&W(t.doc,t.mapping.slice(o).map(r),i)){let s=null;if(i.schema.linebreakReplacement){let t="pre"==i.whitespace,e=!!i.contentMatch.matchType(i.schema.linebreakReplacement);t&&!e?s=!1:!t&&e&&(s=!0)}!1===s&&B(t,e,r,o),F(t,t.mapping.slice(o).map(r,1),i,void 0,null===s);let a=t.mapping.slice(o),p=a.map(r,1),h=a.map(r+e.nodeSize,1);return t.step(new J(p,h,p+1,h-1,new n.Ji(n.FK.from(i.create(l,null,e.marks)),0,0),1,!0)),!0===s&&$(t,e,r,o),!1}})}function $(t,e,r,n){e.forEach((i,s)=>{if(i.isText){let o,l=/\r?\n|\r/g;while(o=l.exec(i.text)){let i=t.mapping.slice(n).map(r+1+s+o.index);t.replaceWith(i,i+1,e.type.schema.linebreakReplacement.create())}}})}function B(t,e,r,n){e.forEach((i,s)=>{if(i.type==i.type.schema.linebreakReplacement){let i=t.mapping.slice(n).map(r+1+s);t.replaceWith(i,i+1,e.type.schema.text("\n"))}})}function W(t,e,r){let n=t.resolve(e),i=n.index();return n.parent.canReplaceWith(i,i+1,r)}function j(t,e,r,i,s){let o=t.doc.nodeAt(e);if(!o)throw new RangeError("No node at given position");r||(r=o.type);let l=r.create(i,null,s||o.marks);if(o.isLeaf)return t.replaceWith(e,e+o.nodeSize,l);if(!r.validContent(o.content))throw new RangeError("Invalid content for node type "+r.name);t.step(new J(e,e+o.nodeSize,e+1,e+o.nodeSize-1,new n.Ji(n.FK.from(l),0,0),1,!0))}function L(t,e,r=1,n){let i=t.resolve(e),s=i.depth-r,o=n&&n[n.length-1]||i.parent;if(s<0||i.parent.type.spec.isolating||!i.parent.canReplace(i.index(),i.parent.childCount)||!o.type.validContent(i.parent.content.cutByIndex(i.index(),i.parent.childCount)))return!1;for(let p=i.depth-1,h=r-2;p>s;p--,h--){let t=i.node(p),e=i.index(p);if(t.type.spec.isolating)return!1;let r=t.content.cutByIndex(e,t.childCount),s=n&&n[h+1];s&&(r=r.replaceChild(0,s.type.create(s.attrs)));let o=n&&n[h]||t;if(!t.canReplace(e+1,t.childCount)||!o.type.validContent(r))return!1}let l=i.indexAfter(s),a=n&&n[0];return i.node(s).canReplaceWith(l,l,a?a.type:i.node(s+1).type)}function q(t,e,r=1,i){let s=t.doc.resolve(e),o=n.FK.empty,l=n.FK.empty;for(let a=s.depth,p=s.depth-r,h=r-1;a>p;a--,h--){o=n.FK.from(s.node(a).copy(o));let t=i&&i[h];l=n.FK.from(t?t.type.create(t.attrs,l):s.node(a).copy(l))}t.step(new b(e,e,new n.Ji(o.append(l),r,r),!0))}function U(t,e){let r=t.resolve(e),n=r.index();return G(r.nodeBefore,r.nodeAfter)&&r.parent.canReplace(n,n+1)}function X(t,e){e.content.size||t.type.compatibleContent(e.type);let r=t.contentMatchAt(t.childCount),{linebreakReplacement:n}=t.type.schema;for(let i=0;i<e.childCount;i++){let s=e.child(i),o=s.type==n?t.type.schema.nodes.text:s.type;if(r=r.matchType(o),!r)return!1;if(!t.type.allowsMarks(s.marks))return!1}return r.validEnd}function G(t,e){return!(!t||!e||t.isLeaf||!X(t,e))}function P(t,e,r=-1){let n=t.resolve(e);for(let i=n.depth;;i--){let t,s,o=n.index(i);if(i==n.depth?(t=n.nodeBefore,s=n.nodeAfter):r>0?(t=n.node(i+1),o++,s=n.node(i).maybeChild(o)):(t=n.node(i).maybeChild(o-1),s=n.node(i+1)),t&&!t.isTextblock&&G(t,s)&&n.node(i).canReplace(o,o+1))return e;if(0==i)break;e=r<0?n.before(i):n.after(i)}}function H(t,e,r){let i=null,{linebreakReplacement:s}=t.doc.type.schema,o=t.doc.resolve(e-r),l=o.node().type;if(s&&l.inlineContent){let t="pre"==l.whitespace,e=!!l.contentMatch.matchType(s);t&&!e?i=!1:!t&&e&&(i=!0)}let a=t.steps.length;if(!1===i){let n=t.doc.resolve(e+r);B(t,n.node(),n.before(),a)}l.inlineContent&&F(t,e+r-1,l,o.node().contentMatchAt(o.index()),null==i);let p=t.mapping.slice(a),h=p.map(e-r);if(t.step(new b(h,p.map(e+r,-1),n.Ji.empty,!0)),!0===i){let e=t.doc.resolve(h);$(t,e.node(),e.before(),t.steps.length)}return t}function Q(t,e,r){let n=t.resolve(e);if(n.parent.canReplaceWith(n.index(),n.index(),r))return e;if(0==n.parentOffset)for(let i=n.depth-1;i>=0;i--){let t=n.index(i);if(n.node(i).canReplaceWith(t,t,r))return n.before(i+1);if(t>0)return null}if(n.parentOffset==n.parent.content.size)for(let i=n.depth-1;i>=0;i--){let t=n.indexAfter(i);if(n.node(i).canReplaceWith(t,t,r))return n.after(i+1);if(t<n.node(i).childCount)return null}return null}function V(t,e,r){let n=t.resolve(e);if(!r.content.size)return e;let i=r.content;for(let s=0;s<r.openStart;s++)i=i.firstChild.content;for(let s=1;s<=(0==r.openStart&&r.size?2:1);s++)for(let t=n.depth;t>=0;t--){let e=t==n.depth?0:n.pos<=(n.start(t+1)+n.end(t+1))/2?-1:1,r=n.index(t)+(e>0?1:0),o=n.node(t),l=!1;if(1==s)l=o.canReplace(r,r,i);else{let t=o.contentMatchAt(r).findWrapping(i.firstChild.type);l=t&&o.canReplaceWith(r,r,t[0])}if(l)return 0==e?n.pos:e<0?n.before(t+1):n.after(t+1)}return null}function Y(t,e,r=e,i=n.Ji.empty){if(e==r&&!i.size)return null;let s=t.resolve(e),o=t.resolve(r);return Z(s,o,i)?new b(e,r,i):new tt(s,o,i).fit()}function Z(t,e,r){return!r.openStart&&!r.openEnd&&t.start()==e.start()&&t.parent.canReplace(t.index(),e.index(),r.content)}g.jsonID("replaceAround",J);class tt{constructor(t,e,r){this.$from=t,this.$to=e,this.unplaced=r,this.frontier=[],this.placed=n.FK.empty;for(let n=0;n<=t.depth;n++){let e=t.node(n);this.frontier.push({type:e.type,match:e.contentMatchAt(t.indexAfter(n))})}for(let i=t.depth;i>0;i--)this.placed=n.FK.from(t.node(i).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){while(this.unplaced.size){let t=this.findFittable();t?this.placeNodes(t):this.openMore()||this.dropNode()}let t=this.mustMoveInline(),e=this.placed.size-this.depth-this.$from.depth,r=this.$from,i=this.close(t<0?this.$to:r.doc.resolve(t));if(!i)return null;let s=this.placed,o=r.depth,l=i.depth;while(o&&l&&1==s.childCount)s=s.firstChild.content,o--,l--;let a=new n.Ji(s,o,l);return t>-1?new J(r.pos,t,this.$to.pos,this.$to.end(),a,e):a.size||r.pos!=this.$to.pos?new b(r.pos,i.pos,a):null}findFittable(){let t=this.unplaced.openStart;for(let e=this.unplaced.content,r=0,n=this.unplaced.openEnd;r<t;r++){let i=e.firstChild;if(e.childCount>1&&(n=0),i.type.spec.isolating&&n<=r){t=r;break}e=i.content}for(let e=1;e<=2;e++)for(let r=1==e?t:this.unplaced.openStart;r>=0;r--){let t,i=null;r?(i=nt(this.unplaced.content,r-1).firstChild,t=i.content):t=this.unplaced.content;let s=t.firstChild;for(let o=this.depth;o>=0;o--){let t,{type:l,match:a}=this.frontier[o],p=null;if(1==e&&(s?a.matchType(s.type)||(p=a.fillBefore(n.FK.from(s),!1)):i&&l.compatibleContent(i.type)))return{sliceDepth:r,frontierDepth:o,parent:i,inject:p};if(2==e&&s&&(t=a.findWrapping(s.type)))return{sliceDepth:r,frontierDepth:o,parent:i,wrap:t};if(i&&a.matchType(i.type))break}}}openMore(){let{content:t,openStart:e,openEnd:r}=this.unplaced,i=nt(t,e);return!(!i.childCount||i.firstChild.isLeaf)&&(this.unplaced=new n.Ji(t,e+1,Math.max(r,i.size+e>=t.size-r?e+1:0)),!0)}dropNode(){let{content:t,openStart:e,openEnd:r}=this.unplaced,i=nt(t,e);if(i.childCount<=1&&e>0){let s=t.size-e<=e+i.size;this.unplaced=new n.Ji(et(t,e-1,1),e-1,s?e-1:r)}else this.unplaced=new n.Ji(et(t,e,1),e,r)}placeNodes({sliceDepth:t,frontierDepth:e,parent:r,inject:i,wrap:s}){while(this.depth>e)this.closeFrontierNode();if(s)for(let n=0;n<s.length;n++)this.openFrontierNode(s[n]);let o=this.unplaced,l=r?r.content:o.content,a=o.openStart-t,p=0,h=[],{match:c,type:f}=this.frontier[e];if(i){for(let t=0;t<i.childCount;t++)h.push(i.child(t));c=c.matchFragment(i)}let d=l.size+t-(o.content.size-o.openEnd);while(p<l.childCount){let t=l.child(p),e=c.matchType(t.type);if(!e)break;p++,(p>1||0==a||t.content.size)&&(c=e,h.push(it(t.mark(f.allowedMarks(t.marks)),1==p?a:0,p==l.childCount?d:-1)))}let u=p==l.childCount;u||(d=-1),this.placed=rt(this.placed,e,n.FK.from(h)),this.frontier[e].match=c,u&&d<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let n=0,m=l;n<d;n++){let t=m.lastChild;this.frontier.push({type:t.type,match:t.contentMatchAt(t.childCount)}),m=t.content}this.unplaced=u?0==t?n.Ji.empty:new n.Ji(et(o.content,t-1,1),t-1,d<0?o.openEnd:t-1):new n.Ji(et(o.content,t,p),o.openStart,o.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let t,e=this.frontier[this.depth];if(!e.type.isTextblock||!st(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(t=this.findCloseLevel(this.$to))&&t.depth==this.depth)return-1;let{depth:r}=this.$to,n=this.$to.after(r);while(r>1&&n==this.$to.end(--r))++n;return n}findCloseLevel(t){t:for(let e=Math.min(this.depth,t.depth);e>=0;e--){let{match:r,type:n}=this.frontier[e],i=e<t.depth&&t.end(e+1)==t.pos+(t.depth-(e+1)),s=st(t,e,n,r,i);if(s){for(let r=e-1;r>=0;r--){let{match:e,type:n}=this.frontier[r],i=st(t,r,n,e,!0);if(!i||i.childCount)continue t}return{depth:e,fit:s,move:i?t.doc.resolve(t.after(e+1)):t}}}}close(t){let e=this.findCloseLevel(t);if(!e)return null;while(this.depth>e.depth)this.closeFrontierNode();e.fit.childCount&&(this.placed=rt(this.placed,e.depth,e.fit)),t=e.move;for(let r=e.depth+1;r<=t.depth;r++){let e=t.node(r),n=e.type.contentMatch.fillBefore(e.content,!0,t.index(r));this.openFrontierNode(e.type,e.attrs,n)}return t}openFrontierNode(t,e=null,r){let i=this.frontier[this.depth];i.match=i.match.matchType(t),this.placed=rt(this.placed,this.depth,n.FK.from(t.create(e,r))),this.frontier.push({type:t,match:t.contentMatch})}closeFrontierNode(){let t=this.frontier.pop(),e=t.match.fillBefore(n.FK.empty,!0);e.childCount&&(this.placed=rt(this.placed,this.frontier.length,e))}}function et(t,e,r){return 0==e?t.cutByIndex(r,t.childCount):t.replaceChild(0,t.firstChild.copy(et(t.firstChild.content,e-1,r)))}function rt(t,e,r){return 0==e?t.append(r):t.replaceChild(t.childCount-1,t.lastChild.copy(rt(t.lastChild.content,e-1,r)))}function nt(t,e){for(let r=0;r<e;r++)t=t.firstChild.content;return t}function it(t,e,r){if(e<=0)return t;let i=t.content;return e>1&&(i=i.replaceChild(0,it(i.firstChild,e-1,1==i.childCount?r-1:0))),e>0&&(i=t.type.contentMatch.fillBefore(i).append(i),r<=0&&(i=i.append(t.type.contentMatch.matchFragment(i).fillBefore(n.FK.empty,!0)))),t.copy(i)}function st(t,e,r,n,i){let s=t.node(e),o=i?t.indexAfter(e):t.index(e);if(o==s.childCount&&!r.compatibleContent(s.type))return null;let l=n.fillBefore(s.content,!0,o);return l&&!ot(r,s.content,o)?l:null}function ot(t,e,r){for(let n=r;n<e.childCount;n++)if(!t.allowsMarks(e.child(n).marks))return!0;return!1}function lt(t){return t.spec.defining||t.spec.definingForContent}function at(t,e,r,i){if(!i.size)return t.deleteRange(e,r);let s=t.doc.resolve(e),o=t.doc.resolve(r);if(Z(s,o,i))return t.step(new b(e,r,i));let l=ft(s,t.doc.resolve(r));0==l[l.length-1]&&l.pop();let a=-(s.depth+1);l.unshift(a);for(let n=s.depth,d=s.pos-1;n>0;n--,d--){let t=s.node(n).type.spec;if(t.defining||t.definingAsContext||t.isolating)break;l.indexOf(n)>-1?a=n:s.before(n)==d&&l.splice(1,0,-n)}let p=l.indexOf(a),h=[],c=i.openStart;for(let n=i.content,d=0;;d++){let t=n.firstChild;if(h.push(t),d==i.openStart)break;n=t.content}for(let n=c-1;n>=0;n--){let t=h[n],e=lt(t.type);if(e&&!t.sameMarkup(s.node(Math.abs(a)-1)))c=n;else if(e||!t.type.isTextblock)break}for(let d=i.openStart;d>=0;d--){let e=(d+c+1)%(i.openStart+1),a=h[e];if(a)for(let h=0;h<l.length;h++){let c=l[(h+p)%l.length],f=!0;c<0&&(f=!1,c=-c);let d=s.node(c-1),u=s.index(c-1);if(d.canReplaceWith(u,u,a.type,a.marks))return t.replace(s.before(c),f?o.after(c):r,new n.Ji(pt(i.content,0,i.openStart,e),e,i.openEnd))}}let f=t.steps.length;for(let n=l.length-1;n>=0;n--){if(t.replace(e,r,i),t.steps.length>f)break;let a=l[n];a<0||(e=s.before(a),r=o.after(a))}}function pt(t,e,r,i,s){if(e<r){let n=t.firstChild;t=t.replaceChild(0,n.copy(pt(n.content,e+1,r,i,n)))}if(e>i){let e=s.contentMatchAt(0),r=e.fillBefore(t).append(t);t=r.append(e.matchFragment(r).fillBefore(n.FK.empty,!0))}return t}function ht(t,e,r,i){if(!i.isInline&&e==r&&t.doc.resolve(e).parent.content.size){let n=Q(t.doc,e,i.type);null!=n&&(e=r=n)}t.replaceRange(e,r,new n.Ji(n.FK.from(i),0,0))}function ct(t,e,r){let n=t.doc.resolve(e),i=t.doc.resolve(r),s=ft(n,i);for(let o=0;o<s.length;o++){let e=s[o],r=o==s.length-1;if(r&&0==e||n.node(e).type.contentMatch.validEnd)return t.delete(n.start(e),i.end(e));if(e>0&&(r||n.node(e-1).canReplace(n.index(e-1),i.indexAfter(e-1))))return t.delete(n.before(e),i.after(e))}for(let o=1;o<=n.depth&&o<=i.depth;o++)if(e-n.start(o)==n.depth-o&&r>n.end(o)&&i.end(o)-r!=i.depth-o&&n.start(o-1)==i.start(o-1)&&n.node(o-1).canReplace(n.index(o-1),i.index(o-1)))return t.delete(n.before(o),r);t.delete(e,r)}function ft(t,e){let r=[],n=Math.min(t.depth,e.depth);for(let i=n;i>=0;i--){let n=t.start(i);if(n<t.pos-(t.depth-i)||e.end(i)>e.pos+(e.depth-i)||t.node(i).type.spec.isolating||e.node(i).type.spec.isolating)break;(n==e.start(i)||i==t.depth&&i==e.depth&&t.parent.inlineContent&&e.parent.inlineContent&&i&&e.start(i-1)==n-1)&&r.push(i)}return r}class dt extends g{constructor(t,e,r){super(),this.pos=t,this.attr=e,this.value=r}apply(t){let e=t.nodeAt(this.pos);if(!e)return w.fail("No node at attribute step's position");let r=Object.create(null);for(let n in e.attrs)r[n]=e.attrs[n];r[this.attr]=this.value;let i=e.type.create(r,null,e.marks);return w.fromReplace(t,this.pos,this.pos+1,new n.Ji(n.FK.from(i),0,e.isLeaf?0:1))}getMap(){return u.empty}invert(t){return new dt(this.pos,this.attr,t.nodeAt(this.pos).attrs[this.attr])}map(t){let e=t.mapResult(this.pos,1);return e.deletedAfter?null:new dt(e.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(t,e){if("number"!=typeof e.pos||"string"!=typeof e.attr)throw new RangeError("Invalid input for AttrStep.fromJSON");return new dt(e.pos,e.attr,e.value)}}g.jsonID("attr",dt);class ut extends g{constructor(t,e){super(),this.attr=t,this.value=e}apply(t){let e=Object.create(null);for(let n in t.attrs)e[n]=t.attrs[n];e[this.attr]=this.value;let r=t.type.create(e,t.content,t.marks);return w.ok(r)}getMap(){return u.empty}invert(t){return new ut(this.attr,t.attrs[this.attr])}map(t){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(t,e){if("string"!=typeof e.attr)throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new ut(e.attr,e.value)}}g.jsonID("docAttr",ut);let mt=class extends Error{};mt=function t(e){let r=Error.call(this,e);return r.__proto__=t.prototype,r},mt.prototype=Object.create(Error.prototype),mt.prototype.constructor=mt,mt.prototype.name="TransformError";class yt{constructor(t){this.doc=t,this.steps=[],this.docs=[],this.mapping=new m}get before(){return this.docs.length?this.docs[0]:this.doc}step(t){let e=this.maybeStep(t);if(e.failed)throw new mt(e.failed);return this}maybeStep(t){let e=t.apply(this.doc);return e.failed||this.addStep(t,e.doc),e}get docChanged(){return this.steps.length>0}addStep(t,e){this.docs.push(this.doc),this.steps.push(t),this.mapping.appendMap(t.getMap()),this.doc=e}replace(t,e=t,r=n.Ji.empty){let i=Y(this.doc,t,e,r);return i&&this.step(i),this}replaceWith(t,e,r){return this.replace(t,e,new n.Ji(n.FK.from(r),0,0))}delete(t,e){return this.replace(t,e,n.Ji.empty)}insert(t,e){return this.replaceWith(t,t,e)}replaceRange(t,e,r){return at(this,t,e,r),this}replaceRangeWith(t,e,r){return ht(this,t,e,r),this}deleteRange(t,e){return ct(this,t,e),this}lift(t,e){return A(this,t,e),this}join(t,e=1){return H(this,t,e),this}wrap(t,e){return K(this,t,e),this}setBlockType(t,e=t,r,n=null){return D(this,t,e,r,n),this}setNodeMarkup(t,e,r=null,n){return j(this,t,e,r,n),this}setNodeAttribute(t,e,r){return this.step(new dt(t,e,r)),this}setDocAttribute(t,e){return this.step(new ut(t,e)),this}addNodeMark(t,e){return this.step(new M(t,e)),this}removeNodeMark(t,e){let r=this.doc.nodeAt(t);if(!r)throw new RangeError("No node at position "+t);if(e instanceof n.CU)e.isInSet(r.marks)&&this.step(new x(t,e));else{let n,i=r.marks,s=[];while(n=e.isInSet(i))s.push(new x(t,n)),i=n.removeFromSet(i);for(let t=s.length-1;t>=0;t--)this.step(s[t])}return this}split(t,e=1,r){return q(this,t,e,r),this}addMark(t,e,r){return R(this,t,e,r),this}removeMark(t,e,r){return N(this,t,e,r),this}clearIncompatible(t,e,r){return F(this,t,e,r),this}}}};